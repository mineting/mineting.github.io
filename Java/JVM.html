<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.67" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-docs-MineTing.netlify.app/Java/JVM.html"><meta property="og:site_name" content="Docs Demo"><meta property="og:title" content="JVM"><meta property="og:description" content="JVM ã€Referã€‘ å®‹çº¢åº· JVM JVMä¸Javaä½“ç³»ç»“æ„ Javaè™šæ‹Ÿæœºæ¦‚è¿° ä¸ºä»€ä¹ˆè¦å­¦ JVMï¼Ÿ 1. å¦‚ä½•è®©ç³»ç»Ÿæ›´å¿«ï¼Œ å¦‚ä½•é¿å…ç³»ç»Ÿå‡ºç°æ€§èƒ½ç“¶é¢ˆã€‚å•çº¯çš„ä¾é ç‰©ç†æœºä¸è¶³ä»¥è§£å†³é—®é¢˜ï¼Œåˆ†æç³»ç»Ÿæ€§èƒ½ã€è°ƒä¼˜ç³»ç»Ÿç“¶é¢ˆç¦»ä¸äº†å¯¹ JVM ä¸­å†…å­˜ã€åƒåœ¾å›æ”¶ã€å­—èŠ‚ç æŒ‡ä»¤ã€æ€§èƒ½ç›‘æ§å·¥å…·ã€è°ƒä¼˜å‚æ•°çš„ç†Ÿç»ƒæŒæ¡ã€‚ 2. JVM æ˜¯ Java ç”Ÿæ€çš„æ ¸å¿ƒä»·å€¼çš„ä½“ç°ï¼Œ..."><meta property="og:type" content="article"><meta property="og:image" content="https://vuepress-theme-hope-docs-MineTing.netlify.app/"><meta property="og:locale" content="en-US"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="JVM"><meta property="article:author" content="MineTing"><meta property="article:published_time" content="2023-03-01T00:00:00.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"JVM","image":["https://vuepress-theme-hope-docs-MineTing.netlify.app/"],"datePublished":"2023-03-01T00:00:00.000Z","dateModified":null,"author":[{"@type":"Person","name":"MineTing"}]}</script><title>JVM | Docs Demo</title><meta name="description" content="JVM ã€Referã€‘ å®‹çº¢åº· JVM JVMä¸Javaä½“ç³»ç»“æ„ Javaè™šæ‹Ÿæœºæ¦‚è¿° ä¸ºä»€ä¹ˆè¦å­¦ JVMï¼Ÿ 1. å¦‚ä½•è®©ç³»ç»Ÿæ›´å¿«ï¼Œ å¦‚ä½•é¿å…ç³»ç»Ÿå‡ºç°æ€§èƒ½ç“¶é¢ˆã€‚å•çº¯çš„ä¾é ç‰©ç†æœºä¸è¶³ä»¥è§£å†³é—®é¢˜ï¼Œåˆ†æç³»ç»Ÿæ€§èƒ½ã€è°ƒä¼˜ç³»ç»Ÿç“¶é¢ˆç¦»ä¸äº†å¯¹ JVM ä¸­å†…å­˜ã€åƒåœ¾å›æ”¶ã€å­—èŠ‚ç æŒ‡ä»¤ã€æ€§èƒ½ç›‘æ§å·¥å…·ã€è°ƒä¼˜å‚æ•°çš„ç†Ÿç»ƒæŒæ¡ã€‚ 2. JVM æ˜¯ Java ç”Ÿæ€çš„æ ¸å¿ƒä»·å€¼çš„ä½“ç°ï¼Œ...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-d97197b4.css" as="style"><link rel="stylesheet" href="/assets/style-d97197b4.css">
    <link rel="modulepreload" href="/assets/app-ae2ce5af.js"><link rel="modulepreload" href="/assets/JVM.html-dbd72723.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-c27b6911.js"><link rel="modulepreload" href="/assets/JVM.html-f072d845.js"><link rel="prefetch" href="/assets/slides.html-d4b68ae3.js" as="script"><link rel="prefetch" href="/assets/MySQL.html-2c3189d9.js" as="script"><link rel="prefetch" href="/assets/Oracle.html-1ddfb32a.js" as="script"><link rel="prefetch" href="/assets/PostgreSQL.html-8d7c3b11.js" as="script"><link rel="prefetch" href="/assets/Redis.html-1871171c.js" as="script"><link rel="prefetch" href="/assets/ActiveMQ.html-7e36c817.js" as="script"><link rel="prefetch" href="/assets/Dubbo.html-a8cd7449.js" as="script"><link rel="prefetch" href="/assets/Effective Java.html-dfcd6599.js" as="script"><link rel="prefetch" href="/assets/Elasticsearch.html-e5846d2c.js" as="script"><link rel="prefetch" href="/assets/Gis.html-ddd37e0c.js" as="script"><link rel="prefetch" href="/assets/Git-Svn.html-af5d4a81.js" as="script"><link rel="prefetch" href="/assets/Http.html-8daf18da.js" as="script"><link rel="prefetch" href="/assets/Interview.html-1b10aa33.js" as="script"><link rel="prefetch" href="/assets/JavaSE.html-9f047d15.js" as="script"><link rel="prefetch" href="/assets/JavaWeb.html-cb212caf.js" as="script"><link rel="prefetch" href="/assets/Kafka.html-25bd84a0.js" as="script"><link rel="prefetch" href="/assets/Maven-Gradle.html-d83ac95f.js" as="script"><link rel="prefetch" href="/assets/Mybatis.html-885e6e8d.js" as="script"><link rel="prefetch" href="/assets/MybatisPlus.html-598dfbea.js" as="script"><link rel="prefetch" href="/assets/Netty.html-8c02d0e8.js" as="script"><link rel="prefetch" href="/assets/Nginx.html-5aa9d1fb.js" as="script"><link rel="prefetch" href="/assets/RabbitMQ.html-0d6d977e.js" as="script"><link rel="prefetch" href="/assets/RocketMQ.html-49e403fa.js" as="script"><link rel="prefetch" href="/assets/ServerLess.html-e22cee80.js" as="script"><link rel="prefetch" href="/assets/Shiro.html-5d17df5c.js" as="script"><link rel="prefetch" href="/assets/Spring.html-97965d72.js" as="script"><link rel="prefetch" href="/assets/SpringBoot2.html-c86a37b5.js" as="script"><link rel="prefetch" href="/assets/SpringCloud.html-9a245adc.js" as="script"><link rel="prefetch" href="/assets/SpringMVC.html-0cc84083.js" as="script"><link rel="prefetch" href="/assets/SpringSecurity.html-f1ecb2f4.js" as="script"><link rel="prefetch" href="/assets/Zookeeper.html-796b6238.js" as="script"><link rel="prefetch" href="/assets/å¤šçº¿ç¨‹ä¸å¹¶å‘ç¼–ç¨‹.html-db7a7ee6.js" as="script"><link rel="prefetch" href="/assets/å¸¸è§åœºæ™¯å®ç°.html-45d3f82e.js" as="script"><link rel="prefetch" href="/assets/æ“ä½œç³»ç»Ÿ.html-4f78fb7f.js" as="script"><link rel="prefetch" href="/assets/æ•°æ®ç»“æ„ä¸ç®—æ³•.html-08698f6d.js" as="script"><link rel="prefetch" href="/assets/è®¡ç®—æœºç½‘ç»œ.html-b52dc063.js" as="script"><link rel="prefetch" href="/assets/è®¾è®¡æ¨¡å¼.html-21d367ac.js" as="script"><link rel="prefetch" href="/assets/Basic.html-2e318635.js" as="script"><link rel="prefetch" href="/assets/Docker.html-25a77026.js" as="script"><link rel="prefetch" href="/assets/KubeSphere.html-9567c249.js" as="script"><link rel="prefetch" href="/assets/Python.html-1e966dd9.js" as="script"><link rel="prefetch" href="/assets/HtmlCSS.html-7dd20864.js" as="script"><link rel="prefetch" href="/assets/JavaScript.html-7c696a30.js" as="script"><link rel="prefetch" href="/assets/jQuery.html-2a1066fa.js" as="script"><link rel="prefetch" href="/assets/React.html-5412a153.js" as="script"><link rel="prefetch" href="/assets/Vue.html-85fe9f9e.js" as="script"><link rel="prefetch" href="/assets/index.html-67b15fdc.js" as="script"><link rel="prefetch" href="/assets/slides.html-8c03d836.js" as="script"><link rel="prefetch" href="/assets/Notifition.html-ac544339.js" as="script"><link rel="prefetch" href="/assets/disable.html-2dea8664.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-abf55e88.js" as="script"><link rel="prefetch" href="/assets/markdown.html-175f2004.js" as="script"><link rel="prefetch" href="/assets/page.html-0e44d074.js" as="script"><link rel="prefetch" href="/assets/index.html-a29f879c.js" as="script"><link rel="prefetch" href="/assets/index.html-b73e550e.js" as="script"><link rel="prefetch" href="/assets/baz.html-2cb41f02.js" as="script"><link rel="prefetch" href="/assets/index.html-969443a6.js" as="script"><link rel="prefetch" href="/assets/ray.html-62ce5fc6.js" as="script"><link rel="prefetch" href="/assets/index.html-9b626ed8.js" as="script"><link rel="prefetch" href="/assets/404.html-9df708ff.js" as="script"><link rel="prefetch" href="/assets/index.html-f1ef565e.js" as="script"><link rel="prefetch" href="/assets/index.html-7dc05b06.js" as="script"><link rel="prefetch" href="/assets/index.html-94fd5f7d.js" as="script"><link rel="prefetch" href="/assets/index.html-c580c463.js" as="script"><link rel="prefetch" href="/assets/index.html-2e8ee3a7.js" as="script"><link rel="prefetch" href="/assets/index.html-bc51f108.js" as="script"><link rel="prefetch" href="/assets/index.html-de8bd102.js" as="script"><link rel="prefetch" href="/assets/slides.html-35427f3a.js" as="script"><link rel="prefetch" href="/assets/MySQL.html-b4c05c5f.js" as="script"><link rel="prefetch" href="/assets/Oracle.html-31a22ec5.js" as="script"><link rel="prefetch" href="/assets/PostgreSQL.html-4b3a9fee.js" as="script"><link rel="prefetch" href="/assets/Redis.html-5593bcac.js" as="script"><link rel="prefetch" href="/assets/ActiveMQ.html-17e2f150.js" as="script"><link rel="prefetch" href="/assets/Dubbo.html-f1ccf506.js" as="script"><link rel="prefetch" href="/assets/Effective Java.html-611a5b80.js" as="script"><link rel="prefetch" href="/assets/Elasticsearch.html-6a52bfc3.js" as="script"><link rel="prefetch" href="/assets/Gis.html-8abfec19.js" as="script"><link rel="prefetch" href="/assets/Git-Svn.html-52d9c4f5.js" as="script"><link rel="prefetch" href="/assets/Http.html-be7a915b.js" as="script"><link rel="prefetch" href="/assets/Interview.html-e7be77bf.js" as="script"><link rel="prefetch" href="/assets/JavaSE.html-0e3b628d.js" as="script"><link rel="prefetch" href="/assets/JavaWeb.html-41d4b249.js" as="script"><link rel="prefetch" href="/assets/Kafka.html-944c972c.js" as="script"><link rel="prefetch" href="/assets/Maven-Gradle.html-d8008567.js" as="script"><link rel="prefetch" href="/assets/Mybatis.html-ce0c0db3.js" as="script"><link rel="prefetch" href="/assets/MybatisPlus.html-2c5b8712.js" as="script"><link rel="prefetch" href="/assets/Netty.html-d9e9600f.js" as="script"><link rel="prefetch" href="/assets/Nginx.html-98042356.js" as="script"><link rel="prefetch" href="/assets/RabbitMQ.html-789fcfb2.js" as="script"><link rel="prefetch" href="/assets/RocketMQ.html-076b5dec.js" as="script"><link rel="prefetch" href="/assets/ServerLess.html-0737dc3b.js" as="script"><link rel="prefetch" href="/assets/Shiro.html-e3093d4f.js" as="script"><link rel="prefetch" href="/assets/Spring.html-2ac4675c.js" as="script"><link rel="prefetch" href="/assets/SpringBoot2.html-7ab29a5b.js" as="script"><link rel="prefetch" href="/assets/SpringCloud.html-05fe7030.js" as="script"><link rel="prefetch" href="/assets/SpringMVC.html-748abb3f.js" as="script"><link rel="prefetch" href="/assets/SpringSecurity.html-e9f6acd6.js" as="script"><link rel="prefetch" href="/assets/Zookeeper.html-5d8329d4.js" as="script"><link rel="prefetch" href="/assets/å¤šçº¿ç¨‹ä¸å¹¶å‘ç¼–ç¨‹.html-f6dbec75.js" as="script"><link rel="prefetch" href="/assets/å¸¸è§åœºæ™¯å®ç°.html-8f6b3fa9.js" as="script"><link rel="prefetch" href="/assets/æ“ä½œç³»ç»Ÿ.html-5bc15ff2.js" as="script"><link rel="prefetch" href="/assets/æ•°æ®ç»“æ„ä¸ç®—æ³•.html-3c552842.js" as="script"><link rel="prefetch" href="/assets/è®¡ç®—æœºç½‘ç»œ.html-1a1a87f0.js" as="script"><link rel="prefetch" href="/assets/è®¾è®¡æ¨¡å¼.html-5c7c95ef.js" as="script"><link rel="prefetch" href="/assets/Basic.html-a2d2fe60.js" as="script"><link rel="prefetch" href="/assets/Docker.html-6d4eaef8.js" as="script"><link rel="prefetch" href="/assets/KubeSphere.html-3728deb9.js" as="script"><link rel="prefetch" href="/assets/Python.html-347ee1e7.js" as="script"><link rel="prefetch" href="/assets/HtmlCSS.html-fc50e4d3.js" as="script"><link rel="prefetch" href="/assets/JavaScript.html-b05d397f.js" as="script"><link rel="prefetch" href="/assets/jQuery.html-1c4e954d.js" as="script"><link rel="prefetch" href="/assets/React.html-d9b1e002.js" as="script"><link rel="prefetch" href="/assets/Vue.html-0b3d4dd9.js" as="script"><link rel="prefetch" href="/assets/index.html-acb676ad.js" as="script"><link rel="prefetch" href="/assets/slides.html-40da5346.js" as="script"><link rel="prefetch" href="/assets/Notifition.html-42cb38d5.js" as="script"><link rel="prefetch" href="/assets/disable.html-3b8c1244.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-57f5861e.js" as="script"><link rel="prefetch" href="/assets/markdown.html-a2e16149.js" as="script"><link rel="prefetch" href="/assets/page.html-fee4dd0d.js" as="script"><link rel="prefetch" href="/assets/index.html-a5e39405.js" as="script"><link rel="prefetch" href="/assets/index.html-a7c9ad07.js" as="script"><link rel="prefetch" href="/assets/baz.html-e3cf3d89.js" as="script"><link rel="prefetch" href="/assets/index.html-b7cc2189.js" as="script"><link rel="prefetch" href="/assets/ray.html-295aa4c2.js" as="script"><link rel="prefetch" href="/assets/index.html-cc65b46d.js" as="script"><link rel="prefetch" href="/assets/404.html-3ea6dd0d.js" as="script"><link rel="prefetch" href="/assets/index.html-df589b5a.js" as="script"><link rel="prefetch" href="/assets/index.html-fe03f011.js" as="script"><link rel="prefetch" href="/assets/index.html-0a3b162f.js" as="script"><link rel="prefetch" href="/assets/index.html-f0a5ac48.js" as="script"><link rel="prefetch" href="/assets/index.html-37711430.js" as="script"><link rel="prefetch" href="/assets/index.html-68e0b571.js" as="script"><link rel="prefetch" href="/assets/index.html-2c257328.js" as="script"><link rel="prefetch" href="/assets/auto-fe80bb03.js" as="script"><link rel="prefetch" href="/assets/index-2bf332f6.js" as="script"><link rel="prefetch" href="/assets/flowchart-c441f34d.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-e67e6523.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-75b11b9d.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-abe06b83.js" as="script"><link rel="prefetch" href="/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/assets/notes.esm-a106bb2c.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-ec5549c1.js" as="script"><link rel="prefetch" href="/assets/search.esm-7e6792e2.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/assets/VuePlayground-0382da01.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-5794cde2.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt="Docs Demo"><!----><span class="vp-site-name hide-in-pad">MineTing</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><div class="nav-item"><div class="dropdown-wrapper i18n-dropdown"><button type="button" class="dropdown-title" aria-label="Select language"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="vp-link nav-link active" href="/Java/JVM.html"><!---->English<!----></a></li><li class="dropdown-item"><a class="vp-link nav-link" href="/zh/"><!---->ç®€ä½“ä¸­æ–‡<!----></a></li></ul></button></div></div><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" class="outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/slides.html"><span class="font-icon icon fa-fw fa-sm fas fa-person-chalkboard" style=""></span>Slide page<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable active" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">Java</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/Kafka.html"><!---->Kafka<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/JavaSE.html"><!---->JavaSE<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95.html"><!---->å¤æ‚åº¦åˆ†æ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/Algorithms.html"><!---->/Java/Algorithms.md<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/DesignPattern.html"><!---->/Java/DesignPattern.md<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/ConcurrentProgramming.html"><!---->/Java/ConcurrentProgramming.md<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/Netty.html"><!---->Netty<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link active vp-sidebar-link vp-sidebar-page active" href="/Java/JVM.html"><!---->JVM<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#jvmä¸javaä½“ç³»ç»“æ„"><!---->JVMä¸Javaä½“ç³»ç»“æ„<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#javaè™šæ‹Ÿæœºæ¦‚è¿°"><!---->Javaè™šæ‹Ÿæœºæ¦‚è¿°<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#java-åŠ-jvmç®€ä»‹"><!---->Java åŠ JVMç®€ä»‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#javaè™šæ‹Ÿæœºçš„ä½œç”¨"><!---->Javaè™šæ‹Ÿæœºçš„ä½œç”¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#javaè™šæ‹Ÿæœºçš„ç‰¹ç‚¹"><!---->Javaè™šæ‹Ÿæœºçš„ç‰¹ç‚¹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#jdk-çš„ç»“æ„"><!---->JDK çš„ç»“æ„<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#jvmæ•´ä½“ç»“æ„-hotspot"><!---->JVMæ•´ä½“ç»“æ„ï¼ˆHotSpotï¼‰<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#ç±»åŠ è½½å­ç³»ç»Ÿ"><!---->ç±»åŠ è½½å­ç³»ç»Ÿ<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#å†…å­˜ç»“æ„æ¦‚è¿°"><!---->å†…å­˜ç»“æ„æ¦‚è¿°<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#ç±»åŠ è½½å™¨ä»¥åŠç±»çš„åŠ è½½è¿‡ç¨‹"><!---->ç±»åŠ è½½å™¨ä»¥åŠç±»çš„åŠ è½½è¿‡ç¨‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#classloader-ç±»åŠ è½½å™¨"><!---->ClassLoaderï¼šç±»åŠ è½½å™¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#ç±»çš„åŠ è½½è¿‡ç¨‹-loading"><!---->ç±»çš„åŠ è½½è¿‡ç¨‹ï¼šLoading<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#ç±»çš„é“¾æ¥è¿‡ç¨‹-linking"><!---->ç±»çš„é“¾æ¥è¿‡ç¨‹ï¼šLinking<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#ç±»çš„åˆå§‹åŒ–è¿‡ç¨‹-initialization"><!---->ç±»çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼šInitialization<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#å‡ ç§ç±»åŠ è½½å™¨çš„è¯´æ˜"><!---->å‡ ç§ç±»åŠ è½½å™¨çš„è¯´æ˜<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#ç±»åŠ è½½å™¨çš„åˆ†ç±»"><!---->ç±»åŠ è½½å™¨çš„åˆ†ç±»<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#åŒäº²å§”æ´¾æœºåˆ¶"><!---->åŒäº²å§”æ´¾æœºåˆ¶<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#è¿è¡Œæ—¶æ•°æ®åŒºåŠæ¦‚è¿°åŠçº¿ç¨‹"><!---->è¿è¡Œæ—¶æ•°æ®åŒºåŠæ¦‚è¿°åŠçº¿ç¨‹<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#è¿è¡Œæ—¶æ•°æ®åŒºç»“æ„æ¦‚è¿°"><!---->è¿è¡Œæ—¶æ•°æ®åŒºç»“æ„æ¦‚è¿°<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#jvmä¸­çš„çº¿ç¨‹è¯´æ˜"><!---->JVMä¸­çš„çº¿ç¨‹è¯´æ˜<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#ç¨‹åºè®¡æ•°å™¨"><!---->ç¨‹åºè®¡æ•°å™¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#è™šæ‹Ÿæœºæ ˆ"><!---->è™šæ‹Ÿæœºæ ˆ<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#è™šæ‹Ÿæœºæ ˆçš„æ¦‚è¿°"><!---->è™šæ‹Ÿæœºæ ˆçš„æ¦‚è¿°<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#æ ˆçš„å­˜å‚¨ç»“æ„å’Œè¿è¡ŒåŸç†"><!---->æ ˆçš„å­˜å‚¨ç»“æ„å’Œè¿è¡ŒåŸç†<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#å±€éƒ¨å˜é‡è¡¨"><!---->å±€éƒ¨å˜é‡è¡¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#æ“ä½œæ•°æ ˆ"><!---->æ“ä½œæ•°æ ˆ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#æ ˆé¡¶ç¼“å­˜æŠ€æœ¯"><!---->æ ˆé¡¶ç¼“å­˜æŠ€æœ¯<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#åŠ¨æ€é“¾æ¥"><!---->åŠ¨æ€é“¾æ¥<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#æ–¹æ³•çš„è°ƒç”¨"><!---->æ–¹æ³•çš„è°ƒç”¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#æ–¹æ³•è¿”å›åœ°å€"><!---->æ–¹æ³•è¿”å›åœ°å€<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#ä¸€äº›é™„åŠ ä¿¡æ¯"><!---->ä¸€äº›é™„åŠ ä¿¡æ¯<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#ç›¸å…³5ä¸ªé—®é¢˜"><!---->ç›¸å…³5ä¸ªé—®é¢˜<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#æœ¬åœ°æ–¹æ³•æ¥å£-java-method-interface"><!---->æœ¬åœ°æ–¹æ³•æ¥å£ï¼ˆJava Method Interfaceï¼‰<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#æœ¬åœ°æ–¹æ³•æ ˆ-native-method-stack"><!---->æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#å †"><!---->å †<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#å †çš„æ ¸å¿ƒæè¿°"><!---->å †çš„æ ¸å¿ƒæè¿°<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#å †çš„æ ¸å¿ƒæè¿°-å†…å­˜ç»†åˆ†"><!---->å †çš„æ ¸å¿ƒæè¿°ï¼šå†…å­˜ç»†åˆ†<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#è®¾ç½®å †å†…å­˜çš„å¤§å°ä¸oom"><!---->è®¾ç½®å †å†…å­˜çš„å¤§å°ä¸OOM<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#å¹´è½»ä»£ä¸è€å¹´ä»£"><!---->å¹´è½»ä»£ä¸è€å¹´ä»£<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#å›¾åƒå¯¹è±¡çš„åˆ†é…è¿‡ç¨‹"><!---->å›¾åƒå¯¹è±¡çš„åˆ†é…è¿‡ç¨‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#minor-gcã€major-gcã€full-gc"><!---->Minor GCã€Major GCã€Full GC<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#å¯¹è±¡åˆ†é…è¿‡ç¨‹-tlab"><!---->å¯¹è±¡åˆ†é…è¿‡ç¨‹ï¼šTLAB<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#åƒåœ¾å›æ”¶æ¦‚è¿°"><!---->åƒåœ¾å›æ”¶æ¦‚è¿°<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#ä»€ä¹ˆæ˜¯åƒåœ¾"><!---->ä»€ä¹ˆæ˜¯åƒåœ¾<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#ä¸ºä»€ä¹ˆéœ€è¦gc"><!---->ä¸ºä»€ä¹ˆéœ€è¦GC<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#æ—©æœŸåƒåœ¾å›æ”¶"><!---->æ—©æœŸåƒåœ¾å›æ”¶<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#java-è‡ªåŠ¨å†…å­˜ç®¡ç†ä»‹ç»"><!---->Java è‡ªåŠ¨å†…å­˜ç®¡ç†ä»‹ç»<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#åƒåœ¾å›æ”¶ç®—æ³•"><!---->åƒåœ¾å›æ”¶ç®—æ³•<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#æ ‡è®°é˜¶æ®µ-å¼•ç”¨è®¡æ•°ç®—æ³•"><!---->æ ‡è®°é˜¶æ®µï¼šå¼•ç”¨è®¡æ•°ç®—æ³•<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#æ ‡è®°é˜¶æ®µ-å¯è¾¾æ€§åˆ†æç®—æ³•"><!---->æ ‡è®°é˜¶æ®µï¼šå¯è¾¾æ€§åˆ†æç®—æ³•<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#å¯¹è±¡çš„-finalization-æœºåˆ¶"><!---->å¯¹è±¡çš„ finalization æœºåˆ¶<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#mat-ä¸-jprofiler-çš„-gc-rosts-æº¯æº"><!---->MAT ä¸ jprofiler çš„ GC ROSTS æº¯æº<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#æ¸…é™¤é˜¶æ®µ-æ ‡è®°-æ¸…é™¤ç®—æ³•"><!---->æ¸…é™¤é˜¶æ®µï¼šæ ‡è®°-æ¸…é™¤ç®—æ³•<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#æ¸…é™¤é˜¶æ®µ-å¤åˆ¶ç®—æ³•"><!---->æ¸…é™¤é˜¶æ®µï¼šå¤åˆ¶ç®—æ³•<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#æ¸…é™¤é˜¶æ®µ-æ ‡è®°-å‹ç¼©ç®—æ³•"><!---->æ¸…é™¤é˜¶æ®µï¼šæ ‡è®°-å‹ç¼©ç®—æ³•<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#å°ç»“"><!---->å°ç»“<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#åˆ†ä»£æ”¶é›†ç®—æ³•"><!---->åˆ†ä»£æ”¶é›†ç®—æ³•<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#å¢é‡æ”¶é›†ç®—æ³•ã€åˆ†åŒºç®—æ³•"><!---->å¢é‡æ”¶é›†ç®—æ³•ã€åˆ†åŒºç®—æ³•<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#åƒåœ¾å›æ”¶æ¦‚å¿µ"><!---->åƒåœ¾å›æ”¶æ¦‚å¿µ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="vp-link nav-link vp-sidebar-link vp-heading" href="/Java/JVM.html#åƒåœ¾å›æ”¶å™¨"><!---->åƒåœ¾å›æ”¶å™¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/JavaWeb.html"><!---->JavaWeb<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/Spring.html"><!---->Spring<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/SpringMVC.html"><!---->SpringMVC<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/Mybatis.html"><!---->Mybatis<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/MybatisPlus.html"><!---->MybatisPlus<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/Shiro.html"><!---->Shiro<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/SpringSecurity.html"><!---->SpringSecurity<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/SpringBoot.html"><!---->/Java/SpringBoot.md<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/Redis.html"><!---->/Java/Redis.md<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/Zookeeper.html"><!---->Zookeeper<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/Nginx.html"><!---->Nginx<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/RabbitMQ.html"><!---->RabbitMQ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/RocketMQ.html"><!---->RocketMQ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/ActiveMQ.html"><!---->ActiveMQ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/Java/Elasticsearch.html"><!---->Elasticsearch<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Spring Cloud</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Specified</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Tools</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">DevOps</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">BigData</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">Python</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">MachineLearning</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">GIS</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">Web</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">Go</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">C/C++</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->JVM</h1><div class="page-info"><span class="page-author-info" aria-label="AuthorğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">MineTing</span></span><span property="author" content="MineTing"></span></span><!----><span class="page-date-info" aria-label="Writing DateğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-03-01T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 75 min</span><meta property="timeRequired" content="PT75M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">On This Page<!----></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#jvmä¸javaä½“ç³»ç»“æ„">JVMä¸Javaä½“ç³»ç»“æ„</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#javaè™šæ‹Ÿæœºæ¦‚è¿°">Javaè™šæ‹Ÿæœºæ¦‚è¿°</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#java-åŠ-jvmç®€ä»‹">Java åŠ JVMç®€ä»‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#javaè™šæ‹Ÿæœºçš„ä½œç”¨">Javaè™šæ‹Ÿæœºçš„ä½œç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#javaè™šæ‹Ÿæœºçš„ç‰¹ç‚¹">Javaè™šæ‹Ÿæœºçš„ç‰¹ç‚¹</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#jdk-çš„ç»“æ„">JDK çš„ç»“æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#jvmæ•´ä½“ç»“æ„-hotspot">JVMæ•´ä½“ç»“æ„ï¼ˆHotSpotï¼‰</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#ç±»åŠ è½½å­ç³»ç»Ÿ">ç±»åŠ è½½å­ç³»ç»Ÿ</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#å†…å­˜ç»“æ„æ¦‚è¿°">å†…å­˜ç»“æ„æ¦‚è¿°</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#ç±»åŠ è½½å™¨ä»¥åŠç±»çš„åŠ è½½è¿‡ç¨‹">ç±»åŠ è½½å™¨ä»¥åŠç±»çš„åŠ è½½è¿‡ç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#classloader-ç±»åŠ è½½å™¨">ClassLoaderï¼šç±»åŠ è½½å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#ç±»çš„åŠ è½½è¿‡ç¨‹-loading">ç±»çš„åŠ è½½è¿‡ç¨‹ï¼šLoading</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#ç±»çš„é“¾æ¥è¿‡ç¨‹-linking">ç±»çš„é“¾æ¥è¿‡ç¨‹ï¼šLinking</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#ç±»çš„åˆå§‹åŒ–è¿‡ç¨‹-initialization">ç±»çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼šInitialization</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#å‡ ç§ç±»åŠ è½½å™¨çš„è¯´æ˜">å‡ ç§ç±»åŠ è½½å™¨çš„è¯´æ˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#ç±»åŠ è½½å™¨çš„åˆ†ç±»">ç±»åŠ è½½å™¨çš„åˆ†ç±»</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#åŒäº²å§”æ´¾æœºåˆ¶">åŒäº²å§”æ´¾æœºåˆ¶</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#è¿è¡Œæ—¶æ•°æ®åŒºåŠæ¦‚è¿°åŠçº¿ç¨‹">è¿è¡Œæ—¶æ•°æ®åŒºåŠæ¦‚è¿°åŠçº¿ç¨‹</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#è¿è¡Œæ—¶æ•°æ®åŒºç»“æ„æ¦‚è¿°">è¿è¡Œæ—¶æ•°æ®åŒºç»“æ„æ¦‚è¿°</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#jvmä¸­çš„çº¿ç¨‹è¯´æ˜">JVMä¸­çš„çº¿ç¨‹è¯´æ˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#ç¨‹åºè®¡æ•°å™¨">ç¨‹åºè®¡æ•°å™¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#è™šæ‹Ÿæœºæ ˆ">è™šæ‹Ÿæœºæ ˆ</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#è™šæ‹Ÿæœºæ ˆçš„æ¦‚è¿°">è™šæ‹Ÿæœºæ ˆçš„æ¦‚è¿°</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#æ ˆçš„å­˜å‚¨ç»“æ„å’Œè¿è¡ŒåŸç†">æ ˆçš„å­˜å‚¨ç»“æ„å’Œè¿è¡ŒåŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#å±€éƒ¨å˜é‡è¡¨">å±€éƒ¨å˜é‡è¡¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#æ“ä½œæ•°æ ˆ">æ“ä½œæ•°æ ˆ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#æ ˆé¡¶ç¼“å­˜æŠ€æœ¯">æ ˆé¡¶ç¼“å­˜æŠ€æœ¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#åŠ¨æ€é“¾æ¥">åŠ¨æ€é“¾æ¥</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#æ–¹æ³•çš„è°ƒç”¨">æ–¹æ³•çš„è°ƒç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#æ–¹æ³•è¿”å›åœ°å€">æ–¹æ³•è¿”å›åœ°å€</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#ä¸€äº›é™„åŠ ä¿¡æ¯">ä¸€äº›é™„åŠ ä¿¡æ¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#ç›¸å…³5ä¸ªé—®é¢˜">ç›¸å…³5ä¸ªé—®é¢˜</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#æœ¬åœ°æ–¹æ³•æ¥å£-java-method-interface">æœ¬åœ°æ–¹æ³•æ¥å£ï¼ˆJava Method Interfaceï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#æœ¬åœ°æ–¹æ³•æ ˆ-native-method-stack">æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#å †">å †</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#å †çš„æ ¸å¿ƒæè¿°">å †çš„æ ¸å¿ƒæè¿°</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#å †çš„æ ¸å¿ƒæè¿°-å†…å­˜ç»†åˆ†">å †çš„æ ¸å¿ƒæè¿°ï¼šå†…å­˜ç»†åˆ†</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#è®¾ç½®å †å†…å­˜çš„å¤§å°ä¸oom">è®¾ç½®å †å†…å­˜çš„å¤§å°ä¸OOM</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#å¹´è½»ä»£ä¸è€å¹´ä»£">å¹´è½»ä»£ä¸è€å¹´ä»£</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#å›¾åƒå¯¹è±¡çš„åˆ†é…è¿‡ç¨‹">å›¾åƒå¯¹è±¡çš„åˆ†é…è¿‡ç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#minor-gcã€major-gcã€full-gc">Minor GCã€Major GCã€Full GC</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#å¯¹è±¡åˆ†é…è¿‡ç¨‹-tlab">å¯¹è±¡åˆ†é…è¿‡ç¨‹ï¼šTLAB</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#åƒåœ¾å›æ”¶æ¦‚è¿°">åƒåœ¾å›æ”¶æ¦‚è¿°</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#ä»€ä¹ˆæ˜¯åƒåœ¾">ä»€ä¹ˆæ˜¯åƒåœ¾</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#ä¸ºä»€ä¹ˆéœ€è¦gc">ä¸ºä»€ä¹ˆéœ€è¦GC</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#æ—©æœŸåƒåœ¾å›æ”¶">æ—©æœŸåƒåœ¾å›æ”¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#java-è‡ªåŠ¨å†…å­˜ç®¡ç†ä»‹ç»">Java è‡ªåŠ¨å†…å­˜ç®¡ç†ä»‹ç»</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#åƒåœ¾å›æ”¶ç®—æ³•">åƒåœ¾å›æ”¶ç®—æ³•</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#æ ‡è®°é˜¶æ®µ-å¼•ç”¨è®¡æ•°ç®—æ³•">æ ‡è®°é˜¶æ®µï¼šå¼•ç”¨è®¡æ•°ç®—æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#æ ‡è®°é˜¶æ®µ-å¯è¾¾æ€§åˆ†æç®—æ³•">æ ‡è®°é˜¶æ®µï¼šå¯è¾¾æ€§åˆ†æç®—æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#å¯¹è±¡çš„-finalization-æœºåˆ¶">å¯¹è±¡çš„ finalization æœºåˆ¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#mat-ä¸-jprofiler-çš„-gc-rosts-æº¯æº">MAT ä¸ jprofiler çš„ GC ROSTS æº¯æº</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#æ¸…é™¤é˜¶æ®µ-æ ‡è®°-æ¸…é™¤ç®—æ³•">æ¸…é™¤é˜¶æ®µï¼šæ ‡è®°-æ¸…é™¤ç®—æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#æ¸…é™¤é˜¶æ®µ-å¤åˆ¶ç®—æ³•">æ¸…é™¤é˜¶æ®µï¼šå¤åˆ¶ç®—æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#æ¸…é™¤é˜¶æ®µ-æ ‡è®°-å‹ç¼©ç®—æ³•">æ¸…é™¤é˜¶æ®µï¼šæ ‡è®°-å‹ç¼©ç®—æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#å°ç»“">å°ç»“</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#åˆ†ä»£æ”¶é›†ç®—æ³•">åˆ†ä»£æ”¶é›†ç®—æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#å¢é‡æ”¶é›†ç®—æ³•ã€åˆ†åŒºç®—æ³•">å¢é‡æ”¶é›†ç®—æ³•ã€åˆ†åŒºç®—æ³•</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#åƒåœ¾å›æ”¶æ¦‚å¿µ">åƒåœ¾å›æ”¶æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#åƒåœ¾å›æ”¶å™¨">åƒåœ¾å›æ”¶å™¨</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><div align="center"><!----></div><blockquote><p>ã€Referã€‘</p><p>å®‹çº¢åº· JVM</p></blockquote><h1 id="ä¸Šç¯‡-javaå†…å­˜ä¸åƒåœ¾å›æ”¶" tabindex="-1"><a class="header-anchor" href="#ä¸Šç¯‡-javaå†…å­˜ä¸åƒåœ¾å›æ”¶" aria-hidden="true">#</a> ä¸Šç¯‡ï¼šJavaå†…å­˜ä¸åƒåœ¾å›æ”¶</h1><h2 id="jvmä¸javaä½“ç³»ç»“æ„" tabindex="-1"><a class="header-anchor" href="#jvmä¸javaä½“ç³»ç»“æ„" aria-hidden="true">#</a> JVMä¸Javaä½“ç³»ç»“æ„</h2><h3 id="javaè™šæ‹Ÿæœºæ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#javaè™šæ‹Ÿæœºæ¦‚è¿°" aria-hidden="true">#</a> Javaè™šæ‹Ÿæœºæ¦‚è¿°</h3><h4 id="ä¸ºä»€ä¹ˆè¦å­¦-jvm" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆè¦å­¦-jvm" aria-hidden="true">#</a> ä¸ºä»€ä¹ˆè¦å­¦ JVMï¼Ÿ</h4><ol><li><p>å¦‚ä½•è®©ç³»ç»Ÿæ›´å¿«ï¼Œ å¦‚ä½•é¿å…ç³»ç»Ÿå‡ºç°æ€§èƒ½ç“¶é¢ˆã€‚å•çº¯çš„ä¾é ç‰©ç†æœºä¸è¶³ä»¥è§£å†³é—®é¢˜ï¼Œåˆ†æç³»ç»Ÿæ€§èƒ½ã€è°ƒä¼˜ç³»ç»Ÿç“¶é¢ˆç¦»ä¸äº†å¯¹ JVM ä¸­å†…å­˜ã€åƒåœ¾å›æ”¶ã€å­—èŠ‚ç æŒ‡ä»¤ã€æ€§èƒ½ç›‘æ§å·¥å…·ã€è°ƒä¼˜å‚æ•°çš„ç†Ÿç»ƒæŒæ¡ã€‚</p></li><li><p>JVM æ˜¯ Java ç”Ÿæ€çš„æ ¸å¿ƒä»·å€¼çš„ä½“ç°ï¼Œåƒåœ¾å›æ”¶ç®—æ³•ã€JITã€åº•å±‚åŸç†å€¼å¾—æ¯ä¸ªç¨‹åºå‘˜å»æ¢ç´¢ã€‚åŒæ—¶ï¼ŒJVM ä½œä¸ºè·¨è¯­è¨€çš„å¹³å°ï¼Œå¯¹äºæ·±å…¥ç†è§£ Scalaã€Kotlinã€JavaScriptã€Jythonã€Groovy ä¹Ÿå¾ˆæœ‰å¸®åŠ©ã€‚</p></li><li><p>Javaé»˜è®¤ä½¿ç”¨HotSpotä½œä¸ºè™šæ‹Ÿæœº</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span><span class="token number">1696</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>java <span class="token parameter variable">-version</span>
<span class="token function">java</span> version <span class="token string">&quot;1.8.0_181&quot;</span>
Java<span class="token punctuation">(</span>TM<span class="token punctuation">)</span> SE Runtime Environment <span class="token punctuation">(</span>build <span class="token number">1.8</span>.0_181-b13<span class="token punctuation">)</span>
Java HotSpot<span class="token punctuation">(</span>TM<span class="token punctuation">)</span> <span class="token number">64</span>-Bit Server VM <span class="token punctuation">(</span>build <span class="token number">25.181</span>-b13, mixed mode<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h4 id="java-è·¨å¹³å°è¯­è¨€çš„ä½“ç°" tabindex="-1"><a class="header-anchor" href="#java-è·¨å¹³å°è¯­è¨€çš„ä½“ç°" aria-hidden="true">#</a> Java è·¨å¹³å°è¯­è¨€çš„ä½“ç°</h4><ol><li>å­—èŠ‚ç æ–‡ä»¶å¯ä»¥ç”±ä¸åŒçš„ç¼–ç¨‹è¯­è¨€æä¾›ï¼ˆç›¸åº”çš„ç¼–è¯‘å™¨ï¼‰</li><li>Java è™šæ‹Ÿæœºå¯ä»¥è¿è¡Œé Java è¯­è¨€ç¼–å†™çš„ç¨‹åºï¼Œåªå…³å¿ƒå­—èŠ‚ç æ–‡ä»¶ã€‚</li><li>JVM æœ€å¼ºå¤§çš„è™šæ‹Ÿæœºï¼Œè§£é‡Šè¿è¡Œå­—èŠ‚ç æ–‡ä»¶ã€‚</li><li>å¤šè¯­è¨€æ··åˆç¼–ç¨‹è¿è¡Œçš„è¶‹åŠ¿ã€‚</li></ol><figure><img src="/assets/Javaè·¨å¹³å°è¯­è¨€çš„ä½“ç°-2b11845b.jpg" alt="Javaè·¨å¹³å°è¯­è¨€çš„ä½“ç°" tabindex="0" loading="lazy"><figcaption>Javaè·¨å¹³å°è¯­è¨€çš„ä½“ç°</figcaption></figure><h3 id="java-åŠ-jvmç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#java-åŠ-jvmç®€ä»‹" aria-hidden="true">#</a> Java åŠ JVMç®€ä»‹</h3><h4 id="javaå‘å±•çš„é‡å¤§äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#javaå‘å±•çš„é‡å¤§äº‹ä»¶" aria-hidden="true">#</a> Javaå‘å±•çš„é‡å¤§äº‹ä»¶</h4><ul><li>1990å¹´ï¼Œåœ¨Sunè®¡ç®—æœºå…¬å¸ä¸­ï¼Œç”±Patrick Naughtonã€MikeSheridanåŠJames Gosling é¢†å¯¼çš„å°ç»„Green Teamï¼Œå¼€å‘å‡ºçš„æ–°çš„ç¨‹åºè¯­è¨€ï¼Œå‘½åä¸º0akï¼ŒåæœŸå‘½åä¸ºJavaã€‚</li><li>1995å¹´ï¼Œ Sunæ­£å¼å‘å¸ƒJavaå’ŒHotJavaäº§å“ï¼ŒJavaé¦–æ¬¡å…¬å¼€äº®ç›¸ã€‚</li><li>1996å¹´1æœˆ23æ—¥Sun Microsystemså‘å¸ƒäº†JDK 1.0ã€‚</li><li>1998å¹´ï¼ŒJDK 1.2ç‰ˆæœ¬å‘å¸ƒã€‚åŒæ—¶ï¼ŒSunå‘å¸ƒäº†JSP/Servletã€EJBè§„èŒƒï¼Œä»¥åŠå°†Javaåˆ†æˆäº†J2EEã€J2SEå’ŒJ2MEã€‚è¿™è¡¨æ˜äº†Javaå¼€å§‹å‘ä¼ä¸šã€æ¡Œé¢åº”ç”¨å’Œç§»åŠ¨è®¾å¤‡åº”ç”¨3å¤§é¢†åŸŸæŒºè¿›ã€‚</li><li>2000å¹´ï¼ŒJDK 1.3å‘å¸ƒï¼ŒJava HotSpot Virtual Machineæ­£å¼å‘å¸ƒï¼Œæˆä¸ºJavaçš„é»˜è®¤è™›æ‹Ÿæœºã€‚</li><li>2002å¹´ï¼ŒJDK 1.4å‘å¸ƒï¼Œå¤è€çš„Classicè™šæ‹Ÿæœºé€€å‡ºå†å²èˆå°ã€‚</li><li>2003å¹´å¹´åº•ï¼ŒJavaå¹³å°çš„Scalaæ­£å¼å‘å¸ƒï¼ŒåŒå¹´Groovyä¹ŸåŠ å…¥äº†Javaé˜µè¥ã€‚</li><li>2004å¹´ï¼ŒJDK 1.5å‘å¸ƒã€‚åŒæ—¶JDK 1.5æ”¹åä¸ºJavaSE 5.0ã€‚</li><li>2006å¹´ï¼ŒJDK 6å‘å¸ƒã€‚åŒå¹´ï¼ŒJavaå¼€æºå¹¶å»ºç«‹äº†OpenJDKã€‚é¡ºç†æˆç« ï¼ŒHotspotè™šæ‹Ÿæœºä¹Ÿæˆä¸ºäº†OpenJDKä¸­çš„é»˜è®¤è™›æ‹Ÿæœºã€‚</li><li>2007å¹´ï¼ŒJavaå¹³å°è¿æ¥äº†æ–°ä¼™ä¼´Clojureã€‚</li><li>2008å¹´ï¼ŒOracle æ”¶è´­äº†BEAï¼Œ å¾—åˆ°äº†JRockit è™šæ‹Ÿæœºã€‚</li><li>2009å¹´ï¼ŒTwitterå®£å¸ƒæŠŠåå°å¤§éƒ¨åˆ†ç¨‹åºä»Rubyè¿ç§»åˆ°scalaï¼Œè¿™æ˜¯Javaå¹³å°çš„åˆä¸€æ¬¡å¤§è§„æ¨¡åº”ç”¨ã€‚</li><li>2010å¹´ï¼ŒOracleæ”¶è´­äº†Sunï¼Œè·å¾—Javaå•†æ ‡å’Œæœ€å…·ä»·å€¼çš„HotSpotè™šæ‹Ÿæœºã€‚æ­¤æ—¶ï¼ŒOracleæ‹¥æœ‰å¸‚åœºå ç”¨ç‡æœ€é«˜çš„ä¸¤æ¬¾è™šæ‹ŸæœºHotSpotå’ŒJRockitï¼Œå¹¶è®¡åˆ’åœ¨æœªæ¥å¯¹å®ƒä»¬è¿›è¡Œæ•´åˆï¼š HotRockit. JCPç»„ç»‡ç®¡ç†ï¼š Javaè¯­è¨€</li><li>2011å¹´ï¼ŒJDK7å‘å¸ƒã€‚åœ¨JDK 1. 7u4ä¸­ï¼Œæ­£å¼å¯ç”¨äº†æ–°çš„åƒåœ¾å›æ”¶å™¨G1ã€‚</li><li>2017å¹´ï¼ŒJDK9å‘å¸ƒã€‚å°†G1è®¾ç½®ä¸ºé»˜è®¤GCï¼Œæ›¿ä»£CMSï¼ŒåŒå¹´ï¼ŒIBMçš„J9å¼€æºï¼Œå½¢æˆäº†ç°åœ¨çš„Open J9ç¤¾åŒºã€‚</li><li>2018å¹´ï¼ŒAndroidçš„Javaä¾µæƒæ¡ˆåˆ¤å†³ï¼ŒGoogleèµ” å¿Oracleè®¡88äº¿ç¾å…ƒï¼ŒåŒå¹´ï¼ŒOracleå®£å‘ŠJavaEEæˆä¸ºå†å²åè¯ï¼ŒJDBCã€ JMSã€Servletèµ äºˆEclipseåŸºé‡‘ä¼šï¼ŒåŒå¹´ï¼ŒJDK11å‘å¸ƒï¼ŒLTSç‰ˆæœ¬çš„JDKï¼Œå‘å¸ƒé©å‘½æ€§çš„ZGCï¼Œè°ƒæ•´JDKæˆæƒè®¸å¯ã€‚</li><li>2019å¹´ï¼ŒJDK12å‘å¸ƒï¼ŒåŠ å…¥RedHaté¢†å¯¼å¼€å‘çš„Shenandoah GCã€‚</li></ul><p>ä¸‰å¤§ä¸»æµè™šæ‹Ÿæœºï¼šHotspotã€Jrockitã€J9</p><h4 id="è™šæ‹Ÿæœº" tabindex="-1"><a class="header-anchor" href="#è™šæ‹Ÿæœº" aria-hidden="true">#</a> è™šæ‹Ÿæœº</h4><ol><li><p>Virtual Machineï¼Œæ˜¯ä¸€å°è™šæ‹Ÿçš„è®¡ç®—æœºï¼Œæ˜¯ä¸€æ¬¾è½¯ä»¶ï¼Œç”¨æ¥æ‰§è¡Œä¸€ç³»åˆ—è™šæ‹Ÿçš„è®¡ç®—æœºæŒ‡ä»¤ï¼Œå¤§ä½“å¯ä»¥åˆ†ä¸ºï¼šç³»ç»Ÿè™šæ‹Ÿæœºå’Œç¨‹åºè™šæ‹Ÿæœºã€‚</p></li><li><p>Virtual Box å’Œ VMware æ˜¯ç³»ç»Ÿè™šæ‹Ÿæœºï¼Œæ˜¯å¯¹ç‰©ç†è®¡ç®—æœºçš„ä»¿çœŸï¼Œæä¾›äº†ä¸€ä¸ªå¯è¿è¡Œæ“ä½œç³»ç»Ÿçš„è½¯ä»¶å¹³å°ã€‚</p></li><li><p>ç¨‹åºè™šæ‹Ÿæœºçš„å…¸å‹ä»£è¡¨æ˜¯ Java è™šæ‹Ÿæœºï¼Œå®ƒä¸“é—¨æ‰§è¡Œå•ä¸ªè®¡ç®—æœºç¨‹åºè€Œè®¾è®¡ï¼Œåœ¨ Java è™šæ‹Ÿæœºä¸­æ‰§è¡Œçš„æŒ‡ä»¤æˆ‘ä»¬ç§°ä¸º Javaå­—èŠ‚ç æŒ‡ä»¤ã€‚</p></li><li><p>æ— è®ºæ˜¯ç³»ç»Ÿè™šæ‹Ÿæœºè¿˜æ˜¯ç¨‹åºè™šæ‹Ÿæœºï¼Œåœ¨ä¸Šé¢è¿è¡Œçš„è½¯ä»¶éƒ½è¢«é™åˆ¶åœ¨è™šæ‹Ÿæœºæä¾›çš„èµ„æºä¸­ã€‚</p></li></ol><h4 id="javaè™šæ‹Ÿæœº" tabindex="-1"><a class="header-anchor" href="#javaè™šæ‹Ÿæœº" aria-hidden="true">#</a> Javaè™šæ‹Ÿæœº</h4><ol><li><p>Java è™šæ‹Ÿæœºæ˜¯ä¸€å°æ‰§è¡Œ Java å­—èŠ‚ç çš„è™šæ‹Ÿè®¡ç®—æœºï¼Œå®ƒæ‹¥æœ‰ç‹¬ç«‹çš„è¿è¡Œæœºåˆ¶ï¼Œæœºå™¨è¿è¡Œçš„å­—èŠ‚ç æœªå¿…æ˜¯ç”± Javaç¼–å†™çš„ã€‚</p></li><li><p>JVM å¹³å°çš„å„ç§è¯­è¨€å¯ä»¥å…±äº« Java è™šæ‹Ÿæœºå¸¦æ¥çš„è·¨å¹³å°æ€§ã€ä¼˜ç§€çš„åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œä»¥åŠå¯é çš„å³æ—¶ç¼–è¯‘å™¨ã€‚</p></li><li><p>JavaæŠ€æœ¯çš„æ ¸å¿ƒå°±æ˜¯ Javaè™šæ‹Ÿæœºï¼ˆJava Virtual VMwareï¼‰ï¼Œå› ä¸ºæ‰€æœ‰çš„ Java ç¨‹åºéƒ½è¿è¡Œåœ¨ Java è™šæ‹Ÿæœºå†…éƒ¨ã€‚</p></li></ol><h3 id="javaè™šæ‹Ÿæœºçš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#javaè™šæ‹Ÿæœºçš„ä½œç”¨" aria-hidden="true">#</a> Javaè™šæ‹Ÿæœºçš„ä½œç”¨</h3><ol><li>Java è™šæ‹Ÿæœºå°±æ˜¯äºŒè¿›åˆ¶å­—èŠ‚ç çš„è¿è¡Œç¯å¢ƒï¼Œè´Ÿè´£è£…è½½å­—èŠ‚ç åˆ°å…¶å†…éƒ¨ï¼Œè§£é‡Š/ç¼–è¯‘ä¸ºå¯¹åº”å¹³å°ä¸Šçš„æœºå™¨æŒ‡ä»¤æ‰§è¡Œã€‚</li><li>æ¯ä¸€æ¡ Java æŒ‡ä»¤ï¼ŒJava è™šæ‹Ÿæœºè§„èŒƒä¸­éƒ½æœ‰è¯¦ç»†å®šä¹‰ï¼Œå¦‚å–æ“ä½œæ•°ï¼Œå¤„ç†æ“ä½œæ•°ï¼Œå¤„ç†ç»“æœæ”¾åœ¨å“ªé‡Œã€‚</li></ol><h3 id="javaè™šæ‹Ÿæœºçš„ç‰¹ç‚¹" tabindex="-1"><a class="header-anchor" href="#javaè™šæ‹Ÿæœºçš„ç‰¹ç‚¹" aria-hidden="true">#</a> Javaè™šæ‹Ÿæœºçš„ç‰¹ç‚¹</h3><ol><li><mark>è·¨å¹³å°ï¼Œä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œ</mark></li><li><mark>è‡ªåŠ¨å†…å­˜ç®¡ç†</mark></li><li><mark>è‡ªåŠ¨åƒåœ¾å›æ”¶æœºåˆ¶</mark></li><li><mark>å³æ—¶ç¼–è¯‘</mark></li></ol><h3 id="jdk-çš„ç»“æ„" tabindex="-1"><a class="header-anchor" href="#jdk-çš„ç»“æ„" aria-hidden="true">#</a> JDK çš„ç»“æ„</h3><p>æ–‡æ¡£ï¼š<a href="https://docs.oracle.com/javase/8/docs/index.html" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/javase/8/docs/index.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><img src="/assets/JDKç»“æ„-d22a4cf1.jpg" style="zoom:80%;"><h3 id="jvmæ•´ä½“ç»“æ„-hotspot" tabindex="-1"><a class="header-anchor" href="#jvmæ•´ä½“ç»“æ„-hotspot" aria-hidden="true">#</a> JVMæ•´ä½“ç»“æ„ï¼ˆHotSpotï¼‰</h3><p>â€‹ HotSpot VMæ˜¯ç›®å‰ä¸Šæ€§èƒ½æœ€é«˜çš„è™šæ‹Ÿæœºä»£è¡¨ä¹‹ä¸€ï¼Œ<strong>å®ƒé‡‡ç”¨çš„æ˜¯è§£é‡Šå™¨ä¸å³æ—¶ç¼–è¯‘å™¨å¹¶å­˜çš„æ¶æ„ã€‚</strong></p><h2 id="ç±»åŠ è½½å­ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#ç±»åŠ è½½å­ç³»ç»Ÿ" aria-hidden="true">#</a> ç±»åŠ è½½å­ç³»ç»Ÿ</h2><h3 id="å†…å­˜ç»“æ„æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#å†…å­˜ç»“æ„æ¦‚è¿°" aria-hidden="true">#</a> å†…å­˜ç»“æ„æ¦‚è¿°</h3><p>â€‹ è™šæ‹Ÿæœºæœ€é‡è¦çš„æ˜¯ä¸¤ä¸ªéƒ¨åˆ†ï¼šç±»åŠ è½½å™¨å’Œæ‰§è¡Œå¼•æ“</p><p><strong>ç®€å•ç‰ˆï¼š</strong></p><figure><img src="/assets/å†…å­˜ç»“æ„æ¦‚è¿°ç®€å•ç‰ˆ-e24decdf.png" alt="å†…å­˜ç»“æ„æ¦‚è¿°ç®€å•ç‰ˆ.png" tabindex="0" loading="lazy"><figcaption>å†…å­˜ç»“æ„æ¦‚è¿°ç®€å•ç‰ˆ.png</figcaption></figure><p><strong>è¯¦ç»†ç‰ˆï¼š</strong></p><figure><img src="/assets/å†…å­˜ç»“æ„æ¦‚è¿°è¯¦ç»†ç‰ˆ-18c97e06.png" alt="å†…å­˜ç»“æ„æ¦‚è¿°è¯¦ç»†ç‰ˆ.png" tabindex="0" loading="lazy"><figcaption>å†…å­˜ç»“æ„æ¦‚è¿°è¯¦ç»†ç‰ˆ.png</figcaption></figure><p>è¯´æ˜ï¼š</p><ul><li><p>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä»½PCå¯„å­˜å™¨</p></li><li><p>å¯¹äºè™šæ‹Ÿæœºæ ˆï¼šåŒ…å«å¾ˆå¤šçš„æ ˆå¸§ï¼Œæ ˆå¸§çš„ç»“æ„å¦‚ä¸‹ï¼š</p><ul><li>LVï¼šå±€éƒ¨å˜é‡è¡¨</li><li>OSï¼šæ“ä½œæ•°æ ˆ</li><li>DLï¼šåŠ¨æ€é“¾æ¥åº“</li><li>RAï¼šæ–¹æ³•è¿”å›åœ°å€</li></ul></li><li><p>æœ¬åœ°æ–¹æ³•æ ˆï¼šç”±æœ¬åœ°æ–¹æ³•è°ƒç”¨é‡‡ç”¨æœ¬åœ°æ–¹æ³•æ ˆ</p></li><li><p>å †åŒºï¼šå…±äº«åŒºåŸŸï¼Œå­˜å‚¨å¯¹è±¡</p></li><li><p>æ–¹æ³•åŒºï¼šå­˜å‚¨ç±»çš„ä¿¡æ¯ï¼Œå¸¸é‡æ± ï¼Œæ–¹æ³•ä¿¡æ¯ç­‰ï¼Œæ–¹æ³•åŒºæ˜¯ HotSpot ç‰¹æœ‰çš„ï¼ŒJdk1.7ä¹‹å‰æ–¹æ³•åŒºä¹Ÿç§°ä½œæ°¸ä¹…ä»£ï¼ŒJDK1.8ä¹‹åç§°ä¸ºå…ƒç©ºé—´ã€‚</p></li></ul><figure><img src="/assets/å†…å­˜ç»“æ„æ¦‚è¿°ä¸­æ–‡è¯¦ç»†ç‰ˆ-7b485edb.png" alt="å†…å­˜ç»“æ„æ¦‚è¿°ä¸­æ–‡è¯¦ç»†ç‰ˆ.png" tabindex="0" loading="lazy"><figcaption>å†…å­˜ç»“æ„æ¦‚è¿°ä¸­æ–‡è¯¦ç»†ç‰ˆ.png</figcaption></figure><h3 id="ç±»åŠ è½½å™¨ä»¥åŠç±»çš„åŠ è½½è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#ç±»åŠ è½½å™¨ä»¥åŠç±»çš„åŠ è½½è¿‡ç¨‹" aria-hidden="true">#</a> ç±»åŠ è½½å™¨ä»¥åŠç±»çš„åŠ è½½è¿‡ç¨‹</h3><figure><img src="/assets/ç±»çš„åŠ è½½è¿‡ç¨‹-ed594319.png" alt="ç±»çš„åŠ è½½è¿‡ç¨‹.png" tabindex="0" loading="lazy"><figcaption>ç±»çš„åŠ è½½è¿‡ç¨‹.png</figcaption></figure><ul><li><p>ç±»åŠ è½½å™¨å­ç³»ç»Ÿè´Ÿè´£ä»æ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œä¸­åŠ è½½Classæ–‡ä»¶ï¼ŒClassæ–‡ä»¶åœ¨æ–‡ä»¶å¼€å¤´ç”±ç‰¹å®šçš„æ–‡ä»¶æ ‡è¯†ã€‚</p></li><li><p>ClassLoaderåªè´Ÿè´£classæ–‡ä»¶çš„åŠ è½½ï¼Œè‡³äºæ˜¯å¦å¯ä»¥è¿è¡Œï¼Œåˆ™ç”± Execution Engine å†³å®šã€‚</p></li><li><p>åŠ è½½çš„ç±»çš„ä¿¡æ¯å­˜æ”¾äºæ–¹æ³•åŒºçš„å†…å­˜ç©ºé—´ï¼Œé™¤äº†ç±»çš„ä¿¡æ¯ï¼Œæ–¹æ³•åŒºè¿˜ä¼šå­˜æ”¾è¿è¡Œæ—¶å¸¸é‡æ± çš„ä¿¡æ¯ï¼Œå¯èƒ½è¿˜åŒ…æ‹¬å­—ç¬¦ä¸²å­—é¢é‡å’Œæ•°å­—å¸¸é‡ï¼Œï¼ˆè¿™éƒ¨åˆ†å¸¸é‡ä¿¡æ¯æ˜¯Classæ–‡ä»¶ä¸­å¸¸é‡æ± éƒ¨åˆ†çš„å†…å­˜æ˜ å°„ï¼‰ã€‚</p></li></ul><h3 id="classloader-ç±»åŠ è½½å™¨" tabindex="-1"><a class="header-anchor" href="#classloader-ç±»åŠ è½½å™¨" aria-hidden="true">#</a> ClassLoaderï¼šç±»åŠ è½½å™¨</h3><p>â€‹ Class file å­˜åœ¨äºç£ç›˜ä¸­ï¼Œé€šè¿‡ç±»åŠ è½½å™¨åŠ è½½åˆ° JVM ä¸­ï¼Œæ ¹æ®è¿™ä¸ªæ–‡ä»¶å®ä¾‹åŒ–å‡º n ä¸ªä¸€æ¨¡ä¸€æ ·çš„å®ä¾‹ï¼ŒClass fileåŠ è½½åˆ° JVMä¸­ï¼Œè¢«ç§°ä¸ºDNAå…ƒæ•°æ®æ¨¡æ¿ï¼Œæ”¾åœ¨æ–¹æ³•åŒºï¼Œè¯¥è¿‡ç¨‹éœ€è¦ ClassLoader æ¥å®Œæˆã€‚</p><p>class æ–‡ä»¶å¯ä»¥é€šè¿‡ getClassLoader() è·å¾—ç±»åŠ è½½å™¨ã€‚</p><h3 id="ç±»çš„åŠ è½½è¿‡ç¨‹-loading" tabindex="-1"><a class="header-anchor" href="#ç±»çš„åŠ è½½è¿‡ç¨‹-loading" aria-hidden="true">#</a> ç±»çš„åŠ è½½è¿‡ç¨‹ï¼šLoading</h3><figure><img src="/assets/ç±»çš„åŠ è½½è¿‡ç¨‹ç®€å•ç‰ˆ-4731e9be.png" alt="ç±»çš„åŠ è½½è¿‡ç¨‹ç®€å•ç‰ˆ.png" tabindex="0" loading="lazy"><figcaption>ç±»çš„åŠ è½½è¿‡ç¨‹ç®€å•ç‰ˆ.png</figcaption></figure><p>è¿‡ç¨‹ï¼š</p><ul><li><p>é€šè¿‡ç±»çš„å…¨é™å®šåä»ç£ç›˜ä¸Šè·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶æµ</p></li><li><p>å°†è¿™ä¸ªå­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶çš„æ•°æ®ç»“æ„</p></li><li><p><strong>åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.Classå¯¹è±¡</strong>ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®è®¿é—®å…¥å£</p></li></ul><p>åŠ è½½ .class çš„æ–¹å¼ï¼š</p><ul><li>ä»æœ¬åœ°ç³»ç»Ÿä¸­åŠ è½½</li><li>é€šè¿‡ç½‘ç»œç³»ç»Ÿè·å–ï¼Œå…¸å‹çš„åœºæ™¯ï¼šWeb Applet</li><li>ä»Zipå‹ç¼©åŒ…ä¸­è¯»å–ï¼Œç§°ä¸ºjarã€waræ ¼å¼çš„åŸºç¡€</li><li>è¿è¡Œæ—¶è®¡ç®—ç”Ÿæˆï¼Œä½¿ç”¨æœ€å¤šçš„æ˜¯åŠ¨æ€ä»£ç†</li><li>æœ‰å…¶ä»–æ–‡ä»¶ç”Ÿæˆï¼Œå…¸å‹ï¼šJsp</li><li>ä»ä¸“æœ‰çš„æ•°æ®åº“ä¸­æå–ï¼Œå°‘è§</li><li>ä»åŠ å¯†æ–‡ä»¶ä¸­è·å–ï¼Œå…¸å‹çš„é˜²Classæ–‡ä»¶è¢«åç¼–è¯‘çš„ä¿æŠ¤æªæ–½</li></ul><h3 id="ç±»çš„é“¾æ¥è¿‡ç¨‹-linking" tabindex="-1"><a class="header-anchor" href="#ç±»çš„é“¾æ¥è¿‡ç¨‹-linking" aria-hidden="true">#</a> ç±»çš„é“¾æ¥è¿‡ç¨‹ï¼šLinking</h3><h4 id="éªŒè¯-verify" tabindex="-1"><a class="header-anchor" href="#éªŒè¯-verify" aria-hidden="true">#</a> éªŒè¯ï¼šVerify</h4><p>â€‹ ç›®çš„åœ¨äºç¡®ä¿classæ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«ä¿¡æ¯ç¬¦åˆå½“å‰è™šæ‹Ÿæœºè¦æ±‚ï¼Œä¿è¯è¢«åŠ è½½ç±»çš„æ­£ç¡®æ€§ï¼Œä¸ä¼šå±å®³è™šæ‹Ÿæœºè‡ªèº«å®‰å…¨ã€‚ä¸»è¦åŒ…æ‹¬å››ç§éªŒè¯ï¼Œ<strong>æ–‡ä»¶æ ¼å¼éªŒè¯ï¼Œå…ƒæ•°æ®éªŒè¯ï¼Œå­—èŠ‚ç éªŒè¯ï¼Œç¬¦å·å¼•ç”¨éªŒè¯</strong>ã€‚</p><p>classæ–‡ä»¶ä»¥ &quot;CAFE&quot; å¼€å§‹ï¼š</p><h4 id="å‡†å¤‡-prepare" tabindex="-1"><a class="header-anchor" href="#å‡†å¤‡-prepare" aria-hidden="true">#</a> å‡†å¤‡ï¼šPrepare</h4><p><strong>1.</strong> <strong>ä¸ºç±»å˜é‡åˆ†é…å†…å­˜å¹¶ä¸”è®¾ç½®è¯¥ç±»å˜é‡çš„é»˜è®¤åˆå§‹å€¼ï¼Œå³é›¶å€¼</strong></p><p><strong>2.</strong> <strong>è¿™é‡Œä¸åŒ…å«ç”¨ final ä¿®é¥°çš„ staticï¼Œå› ä¸º final åœ¨ç¼–è¯‘çš„æ—¶å€™å°±ä¼šåˆ†é…äº†ï¼Œå‡†å¤‡é˜¶æ®µä¼šæ˜¾å¼åˆå§‹åŒ–</strong></p><p><strong>3.</strong> <strong>è¿™é‡Œä¸ä¼šä¸ºå®ä¾‹å˜é‡åˆ†é…åˆå§‹åŒ–ï¼Œç±»å˜é‡ä¼šåˆ†é…åœ¨æ–¹æ³•åŒºä¸­ï¼Œè€Œå®ä¾‹å˜é‡æ˜¯ä¼šéšç€å¯¹è±¡ä¸€èµ·åˆ†é…åˆ°Javaå †ä¸­</strong></p><h4 id="è§£æ-resolve" tabindex="-1"><a class="header-anchor" href="#è§£æ-resolve" aria-hidden="true">#</a> è§£æï¼šResolve</h4><ol><li><p>å°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚</p></li><li><p>äº‹å®ä¸Šï¼Œè§£ææ“ä½œå¾€å¾€ä¼šä¼´éšç€ JVM åœ¨æ‰§è¡Œå®Œåˆå§‹åŒ–ä¹‹åå†æ‰§è¡Œã€‚</p></li><li><p>ç¬¦å·å¼•ç”¨å°±æ˜¯ä¸€ç»„ç¬¦å·æ¥æè¿°æ‰€å¼•ç”¨çš„ç›®æ ‡ã€‚<strong>ç¬¦å·å¼•ç”¨</strong>çš„å­—é¢é‡å½¢å¼æ˜ç¡®å®šä¹‰åœ¨ã€Šjavaè™šæ‹Ÿæœºè§„èŒƒã€‹çš„classæ–‡ä»¶æ ¼å¼ä¸­ã€‚<strong>ç›´æ¥å¼•ç”¨</strong>å°±æ˜¯ç›´æ¥æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆã€ç›¸å¯¹åç§»é‡æˆ–ä¸€ä¸ªé—´æ¥å®šä½åˆ°ç›®æ ‡çš„å¥æŸ„ã€‚</p></li><li><p>è§£æåŠ¨ä½œä¸»è¦é’ˆå¯¹ç±»æˆ–æ¥å£ã€å­—æ®µã€ç±»æ–¹æ³•ã€æ¥å£æ–¹æ³•ã€æ–¹æ³•ç±»å‹ç­‰ã€‚å¯¹åº”å¸¸é‡æ± ä¸­çš„ CONSTANT_Class_infoã€CONSTANT_Fieldref_infoã€CONSTANT_Methodref_infoç­‰ã€‚</p></li></ol><h3 id="ç±»çš„åˆå§‹åŒ–è¿‡ç¨‹-initialization" tabindex="-1"><a class="header-anchor" href="#ç±»çš„åˆå§‹åŒ–è¿‡ç¨‹-initialization" aria-hidden="true">#</a> ç±»çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼šInitialization</h3><ol><li><p>åˆå§‹åŒ–é˜¶æ®µå°±æ˜¯<strong>æ‰§è¡Œç±»æ„é€ å™¨æ–¹æ³•&lt;clinit&gt;()çš„è¿‡ç¨‹</strong>ã€‚</p></li><li><p>æ­¤æ–¹æ³•ä¸éœ€å®šä¹‰ï¼Œæ˜¯javacç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„<strong>æ‰€æœ‰ç±»å˜é‡çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€ä»£ç å—</strong>ä¸­çš„è¯­å¥åˆå¹¶è€Œæ¥ã€‚</p></li><li><p>æ„é€ å™¨æ–¹æ³•ä¸­æŒ‡ä»¤æŒ‰è¯­å¥åœ¨æºæ–‡ä»¶ä¸­å‡ºç°çš„é¡ºåºæ‰§è¡Œã€‚</p></li><li><p>&lt;clinit&gt;() ä¸åŒäºç±»çš„æ„é€ å™¨ã€‚(å…³è”ï¼šæ„é€ å™¨æ˜¯è™šæ‹Ÿæœºè§†è§’ä¸‹çš„&lt;init&gt;() )è‹¥è¯¥ç±»å…·æœ‰çˆ¶ç±»ï¼ŒJVMä¼šä¿è¯å­ç±»çš„&lt;clinit&gt;() æ‰§è¡Œå‰ï¼Œçˆ¶ç±»çš„&lt;clinit&gt; () å·²ç»æ‰§è¡Œå®Œæ¯•ã€‚</p></li><li><p>è™šæ‹Ÿæœºå¿…é¡»ä¿è¯ä¸€ä¸ªç±»çš„&lt;clinit&gt; () æ–¹æ³•åœ¨å¤šçº¿ç¨‹ä¸‹è¢«åŒæ­¥åŠ é”ã€‚</p></li><li><p>å¦‚æœæ²¡æœ‰ç±»å˜é‡ï¼Œä¸ä¼šç”Ÿæˆ&lt;clinit&gt;æ–¹æ³•ï¼Œæ„é€ å™¨å¯¹åº”&lt;init&gt;æ–¹æ³•ã€‚</p></li><li><p>JDK8çš„å…ƒç©ºé—´ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼Œç±»çš„åŠ è½½è¢«ç›´æ¥å†…å­˜ç¼“å­˜ï¼ŒåªåŠ è½½ä¸€æ¬¡ï¼Œè°ƒç”¨ä¸€æ¬¡&lt;clinit&gt;æ–¹æ³•ã€‚</p></li></ol><h3 id="å‡ ç§ç±»åŠ è½½å™¨çš„è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#å‡ ç§ç±»åŠ è½½å™¨çš„è¯´æ˜" aria-hidden="true">#</a> å‡ ç§ç±»åŠ è½½å™¨çš„è¯´æ˜</h3><p>â€‹ JVM æ”¯æŒä¸¤ç§ç±»å‹çš„ç±»åŠ è½½å™¨ï¼Œåˆ†åˆ«ä¸ºå¼•å¯¼ç±»åŠ è½½å™¨ï¼ˆBootstrapClassLoaderï¼‰å’Œè‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼ˆUser-Defined ClassLoader)ã€‚ä»æ¦‚å¿µä¸Šæ¥è®²ï¼Œè‡ªå®šä¹‰ç±»åŠ è½½å™¨ä¸€èˆ¬æŒ‡çš„æ˜¯ç¨‹åºä¸­ç”±å¼€å‘äººå‘˜è‡ªå®šä¹‰çš„ä¸€ç±»ç±»åŠ è½½å™¨ï¼Œä½†æ˜¯Javaè™šæ‹Ÿæœºè§„èŒƒå´æ²¡æœ‰è¿™ä¹ˆå®šä¹‰ï¼Œè€Œæ˜¯å°†æ‰€æœ‰æ´¾ç”ŸäºæŠ½è±¡ç±»ClassLoaderçš„ç±»åŠ è½½å™¨éƒ½åˆ’åˆ†ä¸ºè‡ªå®šä¹‰ç±»åŠ è½½å™¨ã€‚æ— è®ºç±»åŠ è½½å™¨çš„ç±»å‹å¦‚ä½•åˆ’åˆ†ï¼Œåœ¨ç¨‹åºä¸­æˆ‘ä»¬æœ€å¸¸è§çš„ç±»åŠ è½½å™¨å§‹ç»ˆåªæœ‰3ä¸ªï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li>BootStrap ClassLoader</li><li>Extension ClassLoader</li><li>System ClassLoader</li><li>UserDefine ClassLoader</li></ul><p>è¿™å››è€…çš„å…³ç³»æ˜¯åŒ…å«å…³ç³»ï¼Œè€Œéç»§æ‰¿æˆ–ä¸Šä¸‹å±‚ç­‰ï¼Œä»å¦ä¸€è§’åº¦è¯´ï¼šå¼•å¯¼ç±»åŠ è½½å™¨ä¸æ˜¯Javaå†™çš„ï¼Œæ— æ³•è·å–å¯¹è±¡ã€‚</p><h3 id="ç±»åŠ è½½å™¨çš„åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#ç±»åŠ è½½å™¨çš„åˆ†ç±»" aria-hidden="true">#</a> ç±»åŠ è½½å™¨çš„åˆ†ç±»</h3><h4 id="å¯åŠ¨-å¼•å¯¼ç±»åŠ è½½å™¨-bootstrap-classloader" tabindex="-1"><a class="header-anchor" href="#å¯åŠ¨-å¼•å¯¼ç±»åŠ è½½å™¨-bootstrap-classloader" aria-hidden="true">#</a> å¯åŠ¨/å¼•å¯¼ç±»åŠ è½½å™¨ (Bootstrap ClassLoader)</h4><ol><li><p>è¿™ä¸ªç±»åŠ è½½ä½¿ç”¨C/C++è¯­è¨€å®ç°çš„ï¼ŒåµŒå¥—åœ¨ JVM å†…éƒ¨ã€‚</p></li><li><p>å®ƒç”¨æ¥åŠ è½½ Java çš„æ ¸å¿ƒåº“ï¼ˆJAVA_HOME/jre/lib/rt. jarã€resources.jar æˆ– sun.boot.class.path è·¯å¾„ä¸‹çš„å†…å®¹ï¼‰ï¼Œç”¨äºæä¾› JVM è‡ªèº«éœ€è¦çš„ç±»ã€‚</p></li><li><p>å¹¶ä¸ç»§æ‰¿è‡ª java.lang.ClassLoaderï¼Œæ²¡æœ‰çˆ¶åŠ è½½å™¨ã€‚</p></li><li><p>å¼•å¯¼ç±»åŠ è½½å™¨åŠ è½½æ‰©å±•ç±»å’Œåº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼Œå¹¶æŒ‡å®šä¸ºä»–ä»¬çš„çˆ¶ç±»åŠ è½½å™¨ã€‚</p></li><li><p>å‡ºäºå®‰å…¨è€ƒè™‘ï¼ŒBootstrapå¯åŠ¨ç±»åŠ è½½å™¨åªåŠ è½½åŒ…åä¸ºjavaã€ javaxã€sunç­‰å¼€å¤´çš„ç±»ã€‚</p></li></ol><h4 id="æ‰©å±•ç±»åŠ è½½å™¨-extension-classloader" tabindex="-1"><a class="header-anchor" href="#æ‰©å±•ç±»åŠ è½½å™¨-extension-classloader" aria-hidden="true">#</a> æ‰©å±•ç±»åŠ è½½å™¨(Extension ClassLoader)</h4><ol><li><p>Javaè¯­è¨€ç¼–å†™ï¼Œç”±sun.misc.Launcher$ExtClassLoaderå®ç°ã€‚</p></li><li><p>æ´¾ç”ŸäºclassLoaderç±»ï¼Œçˆ¶ç±»åŠ è½½å™¨ä¸ºå¯åŠ¨ç±»åŠ è½½å™¨</p></li><li><p>ä»java.ext.dirsç³»ç»Ÿå±æ€§æ‰€æŒ‡å®šçš„ç›®å½•ä¸­åŠ è½½ç±»åº“ï¼Œæˆ–ä»JDKçš„å®‰è£…ç›®å½•çš„jre/lib/extå­ç›®å½•ï¼ˆæ‰©å±•ç›®å½•ï¼‰ä¸‹åŠ è½½ç±»åº“ã€‚</p></li><li><p>å¦‚æœç”¨æˆ·åˆ›å»ºçš„JARæ”¾åœ¨æ­¤ç›®å½•ä¸‹ï¼Œä¹Ÿä¼šè‡ªåŠ¨ç”±æ‰©å±•ç±»åŠ è½½å™¨åŠ è½½ã€‚</p></li></ol><h4 id="ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨" tabindex="-1"><a class="header-anchor" href="#ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨" aria-hidden="true">#</a> ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨</h4><p>â€‹ åœ¨ Java çš„æ—¥å¸¸åº”ç”¨ç¨‹åºå¼€å‘ä¸­ï¼Œç±»çš„åŠ è½½å‡ ä¹æ˜¯ç”±ä¸Šè¿°3ç§ç±»åŠ è½½å™¨ç›¸äº’é…åˆæ‰§è¡Œçš„ï¼Œåœ¨å¿…è¦æ—¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Œæ¥å®šåˆ¶ç±»çš„åŠ è½½æ–¹å¼ã€‚</p><p>ä¸ºä»€ä¹ˆè¦è‡ªå®šä¹‰ç±»åŠ è½½å™¨?</p><ol><li><p>éš”ç¦»åŠ è½½ç±»ï¼ˆé¿å…å¤šä¸ªæ¡†æ¶å®šä¹‰ç›¸åŒçš„ç±»ï¼‰</p></li><li><p>ä¿®æ”¹ç±»åŠ è½½çš„æ–¹å¼</p></li><li><p>æ‰©å±•åŠ è½½æº</p></li><li><p>é˜²æ­¢æºç æ³„æ¼ï¼ˆå¯¹å­—èŠ‚ç è¿›è¡ŒåŠ å¯†å’Œè§£å¯†æ“ä½œï¼‰</p></li></ol><h4 id="ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨å®ç°æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨å®ç°æ­¥éª¤" aria-hidden="true">#</a> ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨å®ç°æ­¥éª¤</h4><ol><li><p>å¼€å‘äººå‘˜å¯ä»¥é€šè¿‡ç»§æ‰¿æŠ½è±¡ç±» java.lang.classLoader ç±»çš„æ–¹å¼ï¼Œå®ç°è‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œä»¥æ»¡è¶³ä¸€äº›ç‰¹æ®Šçš„éœ€æ±‚ã€‚</p></li><li><p>åœ¨ JDK1.2ä¹‹å‰ï¼Œåœ¨è‡ªå®šä¹‰ç±»åŠ è½½å™¨æ—¶ï¼Œæ€»ä¼šå»ç»§æ‰¿ classLoader ç±»å¹¶é‡å†™ loadclass() æ–¹æ³•ï¼Œä»è€Œå®ç°è‡ªå®šä¹‰çš„ç±»åŠ è½½ç±»ï¼Œä½†æ˜¯åœ¨ JDK1.2 ä¹‹åå·²ä¸å†å»ºè®®ç”¨æˆ·å»è¦†ç›– loadclass() æ–¹æ³•ï¼Œè€Œæ˜¯å»ºè®®æŠŠè‡ªå®šä¹‰çš„ç±»åŠ è½½é€»è¾‘å†™åœ¨ findclass() æ–¹æ³•ä¸­ã€‚</p></li><li><p>åœ¨ç¼–å†™è‡ªå®šä¹‰ç±»åŠ è½½å™¨æ—¶ï¼Œå¦‚æœæ²¡æœ‰å¤ªè¿‡äºå¤æ‚çš„éœ€æ±‚ï¼Œå¯ä»¥ç›´æ¥ç»§æ‰¿ URLClassLoader ç±»ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…è‡ªå·±å»ç¼–å†™ findclass() æ–¹æ³•åŠå…¶è·å–å­—èŠ‚ç æµçš„æ–¹å¼ï¼Œä½¿è‡ªå®šä¹‰ç±»åŠ è½½å™¨ç¼–å†™æ›´åŠ ç®€æ´ã€‚</p></li></ol><h4 id="classloaderç±»" tabindex="-1"><a class="header-anchor" href="#classloaderç±»" aria-hidden="true">#</a> ClassLoaderç±»</h4><p>ClassLoader ç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå…¶åæ‰€æœ‰çš„ç±»åŠ è½½å™¨éƒ½ç»§æ‰¿è‡ªClassLoaderï¼ˆä¸åŒ…æ‹¬å¯åŠ¨ç±»åŠ è½½å™¨ï¼‰ã€‚</p><table><thead><tr><th>æ–¹æ³•åç§°</th><th>æè¿°</th></tr></thead><tbody><tr><td>getParent()</td><td>è¿”å›è¯¥åŠ è½½å™¨çš„è¶…ç±»åŠ è½½å™¨</td></tr><tr><td>loadClass(String name)</td><td>åŠ è½½åä¸º name çš„ç±»ï¼Œè¿”å›ç»“æœä¸º Java.lang.Class ç±»çš„å®ä¾‹</td></tr><tr><td>findClass(String name)</td><td>åŠ è½½åä¸º name çš„ç±»ï¼Œè¿”å›ç»“æœä¸º Java.lang.Class ç±»çš„å®ä¾‹</td></tr><tr><td>findLoadClass(String name)</td><td>æŸ¥æ‰¾åç§°ä¸º name çš„å·²ç»è¢«åŠ è½½è¿‡çš„ç±»ï¼Œè¿”å›ç»“æœä¸ºjava.lang.Classçš„å®ä¾‹</td></tr><tr><td>defineClass(String nameï¼Œbyte[] bï¼Œint offï¼Œint len)</td><td>å°†å­—èŠ‚æ•°ç»„ b çš„å†…å®¹è½¬ä¸ºä¸€ä¸ª Java ç±»ï¼Œè¿”å›ç»“æœä¸º java.lang.classçš„å®ä¾‹</td></tr><tr><td>resolveClass(Class&lt;?&gt; c)</td><td>è¿æ¥æŒ‡å®šçš„ä¸€ä¸ªjavaç±»</td></tr></tbody></table><h4 id="è·å–classloaderçš„é€”å¾„" tabindex="-1"><a class="header-anchor" href="#è·å–classloaderçš„é€”å¾„" aria-hidden="true">#</a> è·å–ClassLoaderçš„é€”å¾„</h4><ul><li><p>æ–¹å¼ä¸€ï¼šè·å–å½“å‰ç±»çš„ClassLoader</p><p>clazz.getClassLoader()</p></li><li><p>æ–¹å¼äºŒï¼šè·å–å½“å‰ä¸Šä¸‹æ–‡çš„ClassLoader</p><p>Thread.currentThread().getContextClassLoader()</p></li><li><p>æ–¹å¼ä¸‰ï¼šè·å–ç³»ç»Ÿçš„ClassLoader</p><p>ClassLoader.getSystemClassLoader()</p></li><li><p>æ–¹å¼å››ï¼šè·å–è°ƒç”¨è€…çš„ClassLoader</p><p>DriverManager.getCallerClassLoader()</p></li></ul><h3 id="åŒäº²å§”æ´¾æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#åŒäº²å§”æ´¾æœºåˆ¶" aria-hidden="true">#</a> åŒäº²å§”æ´¾æœºåˆ¶</h3><p>â€‹ Java è™šæ‹Ÿæœºå¯¹ class æ–‡ä»¶é‡‡ç”¨çš„æ˜¯æŒ‰éœ€åŠ è½½çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è¯´å½“éœ€è¦ä½¿ç”¨è¯¥ç±»æ—¶æ‰ä¼šå°†å®ƒçš„ class æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ç”Ÿæˆ class å¯¹è±¡ã€‚è€Œä¸”åŠ è½½æŸä¸ªç±»çš„ class æ–‡ä»¶æ—¶ï¼ŒJava è™šæ‹Ÿæœºé‡‡ç”¨çš„æ˜¯åŒäº²å§”æ´¾æ¨¡å¼ï¼Œå³æŠŠè¯·æ±‚äº¤ç”±çˆ¶ç±»å¤„ç†ï¼Œå®ƒæ˜¯ä¸€ç§ä»»åŠ¡å§”æ´¾æ¨¡å¼ã€‚</p><h4 id="å·¥ä½œåŸç†" tabindex="-1"><a class="header-anchor" href="#å·¥ä½œåŸç†" aria-hidden="true">#</a> å·¥ä½œåŸç†</h4><ol><li><p>å¦‚æœä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°äº†ç±»åŠ è½½è¯·æ±‚ï¼Œå®ƒå¹¶ä¸ä¼šè‡ªå·±å…ˆå»åŠ è½½ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™çˆ¶ç±»çš„åŠ è½½å™¨å»æ‰§è¡Œã€‚</p></li><li><p>å¦‚æœçˆ¶ç±»åŠ è½½å™¨è¿˜å­˜åœ¨å…¶çˆ¶ç±»åŠ è½½å™¨ï¼Œåˆ™è¿›ä¸€æ­¥å‘ä¸Šå§”æ‰˜ï¼Œä¾æ¬¡é€’å½’ï¼Œè¯·æ±‚æœ€ç»ˆå°†åˆ°è¾¾é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ã€‚</p></li><li><p>å¦‚æœçˆ¶ç±»åŠ è½½å™¨å¯ä»¥å®Œæˆç±»åŠ è½½ä»»åŠ¡ï¼Œå°±æˆåŠŸè¿”å›ï¼Œå€˜è‹¥çˆ¶ç±»åŠ è½½å™¨æ— æ³•å®Œæˆæ­¤åŠ è½½ä»»åŠ¡ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½ï¼Œè¿™å°±æ˜¯åŒäº²å§”æ´¾æ¨¡å¼ã€‚</p></li></ol><p>åŒäº²å§”æ´¾çš„ä¼˜åŠ¿</p><ul><li><p>é¿å…ç±»çš„é‡å¤åŠ è½½ï¼ˆå‘ä¸Šå¯ä»¥è¢«åŠ è½½å°±ä¸ä¼šç»§ç»­å§”æ´¾ï¼ŒåªåŠ è½½ä¸€æ¬¡ï¼‰</p></li><li><p>ä¿æŠ¤ç¨‹åºå®‰å…¨ï¼Œé˜²æ­¢éšæ„ç¯¡æ”¹æ ¸å¿ƒAPIï¼Œå¦‚ Java.lang.Stringå’Œjava.lang.SamStartã€‚å¦‚æœå¼•å¯¼ç±»åŠ è½½è¯¥ç±»ï¼Œå¯èƒ½å‡ºç°é—®é¢˜é€ æˆç ´åã€‚</p></li></ul><figure><img src="/assets/åŒäº²å§”æ´¾-c52ed12f.png" alt="åŒäº²å§”æ´¾.png" tabindex="0" loading="lazy"><figcaption>åŒäº²å§”æ´¾.png</figcaption></figure><p>ç¨‹åºè¯´æ˜ï¼š</p><p>â€‹ è‡ªå®šä¹‰çš„ java.lang.String å…ˆç”±åº”ç”¨ç±»åŠ è½½å™¨å§”æ‰˜æ‰©å±•ç±»åŠ è½½å™¨ï¼Œå†ç”±æ‰©å±•ç±»åŠ è½½å™¨å§”æ‰˜ç»™å¼•å¯¼ç±»åŠ è½½å™¨ï¼Œå¼•å¯¼ç±»åŠ è½½å™¨åªåŠ è½½åŒ…åä¸º javaã€ javaxã€sun ç­‰å¼€å¤´çš„ç±»ã€‚å› æ­¤çœŸæ­£åŠ è½½çš„æ˜¯Stringç±»ï¼Œè€Œä¸æ˜¯è‡ªå®šä¹‰çš„Stringã€‚</p><h4 id="æ²™ç®±å®‰å…¨æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#æ²™ç®±å®‰å…¨æœºåˆ¶" aria-hidden="true">#</a> æ²™ç®±å®‰å…¨æœºåˆ¶</h4><p>â€‹ è‡ªå®šä¹‰ String ç±»ï¼Œä½†æ˜¯åœ¨åŠ è½½è‡ªå®šä¹‰ String ç±»çš„æ—¶å€™ä¼šç‡å…ˆä½¿ç”¨å¼•å¯¼ç±»åŠ è½½å™¨åŠ è½½ï¼Œè€Œå¼•å¯¼ç±»åŠ è½½å™¨åœ¨åŠ è½½çš„è¿‡ç¨‹ä¸­ä¼šå…ˆåŠ è½½ jdk è‡ªå¸¦çš„æ–‡ä»¶( rt.jaråŒ…ä¸­ java\lang\string.class )ï¼ŒæŠ¥é”™ä¿¡æ¯è¯´æ²¡æœ‰mainæ–¹æ³•ï¼Œå°±æ˜¯å› ä¸ºåŠ è½½çš„æ˜¯ rt.jar åŒ…ä¸­çš„String ç±»ã€‚è¿™æ ·å¯ä»¥ä¿è¯å¯¹ java æ ¸å¿ƒæºä»£ç çš„ä¿æŠ¤ï¼Œè¿™å°±æ˜¯æ²™ç®±å®‰å…¨æœºåˆ¶ã€‚</p><h4 id="åˆ¤æ–­ä¸¤ä¸ªclasså¯¹è±¡æ˜¯å¦ä¸ºåŒä¸€ç±»" tabindex="-1"><a class="header-anchor" href="#åˆ¤æ–­ä¸¤ä¸ªclasså¯¹è±¡æ˜¯å¦ä¸ºåŒä¸€ç±»" aria-hidden="true">#</a> åˆ¤æ–­ä¸¤ä¸ªClasså¯¹è±¡æ˜¯å¦ä¸ºåŒä¸€ç±»</h4><ul><li><p>ç±»çš„å®Œæ•´ç±»åå¿…é¡»ä¸€è‡´ï¼ŒåŒ…æ‹¬åŒ…åã€‚</p></li><li><p>åŠ è½½è¿™ä¸ªç±»çš„classLoader(æŒ‡classLoaderå®ä¾‹å¯¹è±¡)å¿…é¡»ç›¸åŒã€‚</p><p>æ¢å¥è¯è¯´ï¼Œåœ¨JVMä¸­ï¼Œå³ä½¿è¿™ä¸¤ä¸ªç±»å¯¹è±¡(classå¯¹è±¡)æ¥æºåŒä¸€ä¸ªclassæ–‡ä»¶ï¼Œè¢«åŒä¸€ä¸ªè™šæ‹Ÿæœºæ‰€åŠ è½½ï¼Œä½†åªè¦åŠ è½½å®ƒä»¬çš„classLoaderå®ä¾‹å¯¹è±¡ä¸åŒï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªç±»å¯¹è±¡ä¹Ÿæ˜¯ä¸ç›¸ç­‰çš„ã€‚</p></li></ul><h4 id="å¯¹ç±»åŠ è½½å™¨çš„å¼•ç”¨" tabindex="-1"><a class="header-anchor" href="#å¯¹ç±»åŠ è½½å™¨çš„å¼•ç”¨" aria-hidden="true">#</a> å¯¹ç±»åŠ è½½å™¨çš„å¼•ç”¨</h4><p>JVM å¿…é¡»çŸ¥é“ä¸€ä¸ªç±»å‹æ˜¯ç”±å¯åŠ¨åŠ è½½å™¨åŠ è½½çš„è¿˜æ˜¯ç”±ç”¨æˆ·ç±»åŠ è½½å™¨åŠ è½½çš„ã€‚å¦‚æœä¸€ä¸ªç±»å‹æ˜¯ç”±ç”¨æˆ·ç±»åŠ è½½å™¨åŠ è½½çš„ï¼Œé‚£ä¹ˆJVMä¼šå°†è¿™ä¸ªç±»åŠ è½½å™¨çš„ä¸€ä¸ªå¼•ç”¨ä½œä¸ºç±»å‹ä¿¡æ¯çš„ä¸€éƒ¨åˆ†ä¿å­˜åœ¨æ–¹æ³•åŒºä¸­ã€‚å½“è§£æä¸€ä¸ªç±»å‹åˆ°å¦ä¸€ä¸ªç±»å‹çš„å¼•ç”¨çš„æ—¶å€™ï¼ŒJVMéœ€è¦ä¿è¯è¿™ä¸¤ä¸ªç±»å‹çš„ç±»åŠ è½½å™¨æ˜¯ç›¸åŒçš„ã€‚</p><h4 id="ç±»çš„ä¸»åŠ¨ä½¿ç”¨å’Œè¢«åŠ¨ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ç±»çš„ä¸»åŠ¨ä½¿ç”¨å’Œè¢«åŠ¨ä½¿ç”¨" aria-hidden="true">#</a> ç±»çš„ä¸»åŠ¨ä½¿ç”¨å’Œè¢«åŠ¨ä½¿ç”¨</h4><p>Javaç¨‹åºå¯¹ç±»çš„ä½¿ç”¨æ–¹å¼åˆ†ä¸ºï¼šä¸»åŠ¨ä½¿ç”¨å’Œè¢«åŠ¨ä½¿ç”¨ã€‚</p><p>ä¸»åŠ¨ä½¿ç”¨ï¼Œåˆåˆ†ä¸ºä¸ƒç§æƒ…å†µï¼š</p><ol><li><p>åˆ›å»ºç±»çš„å®ä¾‹</p></li><li><p>è®¿é—®æŸä¸ªç±»æˆ–æ¥å£çš„é™æ€å˜é‡ï¼Œæˆ–è€…å¯¹è¯¥é™æ€å˜é‡èµ‹å€¼</p></li><li><p>è°ƒç”¨ç±»çš„é™æ€æ–¹æ³•</p></li><li><p>åå°„ï¼ˆæ¯”å¦‚ï¼šClass.forName(&quot;com.example. Test&quot;) )</p></li><li><p>åˆå§‹åŒ–ä¸€ä¸ªç±»çš„å­ç±»</p></li><li><p>Javaè™šæ‹Ÿæœºå¯åŠ¨æ—¶è¢«æ ‡æ˜ä¸ºå¯åŠ¨ç±»çš„ç±»</p></li><li><p>JDK 7 å¼€å§‹æä¾›çš„åŠ¨æ€è¯­è¨€æ”¯æŒï¼š</p><ol><li><p>java.lang.invoke.MethodHandleå®ä¾‹çš„è§£æç»“æœ</p></li><li><p>REFgetStaticã€REF putstaticã€REF invokeStaticå¥æŸ„å¯¹åº”çš„ç±»æ²¡æœ‰åˆå§‹åŒ–ï¼Œåˆ™åˆå§‹åŒ–</p></li></ol></li></ol><p>é™¤äº†ä»¥ä¸Šä¸ƒç§æƒ…å†µï¼Œå…¶ä»–ä½¿ç”¨ Java ç±»çš„æ–¹å¼éƒ½è¢«çœ‹ä½œæ˜¯å¯¹ç±»çš„è¢«åŠ¨ä½¿ç”¨ï¼Œéƒ½<strong>ä¸ä¼šå¯¼è‡´ç±»çš„åˆå§‹åŒ–ã€‚</strong></p><h2 id="è¿è¡Œæ—¶æ•°æ®åŒºåŠæ¦‚è¿°åŠçº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#è¿è¡Œæ—¶æ•°æ®åŒºåŠæ¦‚è¿°åŠçº¿ç¨‹" aria-hidden="true">#</a> è¿è¡Œæ—¶æ•°æ®åŒºåŠæ¦‚è¿°åŠçº¿ç¨‹</h2><h3 id="è¿è¡Œæ—¶æ•°æ®åŒºç»“æ„æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#è¿è¡Œæ—¶æ•°æ®åŒºç»“æ„æ¦‚è¿°" aria-hidden="true">#</a> è¿è¡Œæ—¶æ•°æ®åŒºç»“æ„æ¦‚è¿°</h3><p>â€‹ å†…å­˜æ˜¯éå¸¸é‡è¦çš„ç³»ç»Ÿèµ„æºï¼Œæ˜¯ç¡¬ç›˜å’ŒCPUçš„ä¸­é—´ä»“åº“åŠæ¡¥æ¢ï¼Œæ‰¿è½½ç€æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºçš„å®æ—¶è¿è¡Œã€‚ JVMå†…å­˜å¸ƒå±€è§„å®šäº†Javaåœ¨è¿è¡Œè¿‡ç¨‹ä¸­å†…å­˜ç”³è¯·ã€åˆ†é…ã€ç®¡ç†çš„ç­–ç•¥ï¼Œä¿è¯äº†JVMçš„é«˜æ•ˆç¨³å®šè¿è¡Œã€‚ä¸åŒçš„JVMå¯¹äºå†…å­˜çš„åˆ’åˆ†æ–¹å¼å’Œç®¡ç†æœºåˆ¶å­˜åœ¨ç€éƒ¨åˆ†å·®å¼‚ã€‚</p><figure><img src="/assets/è¿è¡Œæ—¶æ•°æ®åŒºç»“æ„æ¦‚è¿°-b867f225.png" alt="è¿è¡Œæ—¶æ•°æ®åŒºç»“æ„æ¦‚è¿°.png" tabindex="0" loading="lazy"><figcaption>è¿è¡Œæ—¶æ•°æ®åŒºç»“æ„æ¦‚è¿°.png</figcaption></figure><p>è¯´æ˜ï¼š</p><ul><li><p>Javaè™šæ‹Ÿæœºå®šä¹‰äº†è‹¥å¹²ç§ç¨‹åºè¿è¡ŒæœŸé—´ä¼šä½¿ç”¨åˆ°çš„è¿è¡Œæ—¶æ•°æ®åŒºï¼Œå…¶ä¸­æœ‰ä¸€äº›ä¼šéšç€è™šæ‹Ÿæœºå¯åŠ¨è€Œåˆ›å»ºï¼Œéšç€è™šæ‹Ÿæœºé€€å‡ºè€Œé”€æ¯ã€‚</p></li><li><p>å¦å¤–ä¸€äº›åˆ™æ˜¯ä¸çº¿ç¨‹ä¸€ä¸€å¯¹åº”çš„ï¼Œè¿™äº›ä¸çº¿ç¨‹å¯¹åº”çš„æ•°æ®åŒºåŸŸä¼šéšç€çº¿ç¨‹å¼€å§‹å’Œç»“æŸè€Œåˆ›å»ºå’Œé”€æ¯ã€‚å³ï¼š</p><p>â€‹ <strong>æ¯ä¸ªçº¿ç¨‹ï¼šç‹¬ç«‹åŒ…æ‹¬ç¨‹åºè®¡æ•°å™¨ã€æ ˆã€æœ¬åœ°æ ˆã€‚</strong></p><p>â€‹ <strong>çº¿ç¨‹é—´å…±äº«ï¼šå †ã€å †å¤–å†…å­˜ï¼ˆæ°¸ä¹…ä»£æˆ–å…ƒç©ºé—´ã€ä»£ç ç¼“å­˜)</strong></p></li><li><p>å¦‚ä¸€ä¸ªè¿›ç¨‹åŒ…å« n ä¸ªçº¿ç¨‹ï¼Œåˆ™ä¼šæœ‰ n ä¸ªè™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆã€ç¨‹åºè®¡æ•°å™¨ï¼Œå®ƒä»¬å…±ç”¨ 1 ä¸ªæ–¹æ³•åŒºå’Œå †åŒºã€‚</p><p>ã€å¤§æ¦‚ï¼šå †ï¼ˆå ç”¨95%ç©ºé—´ï¼‰ï¼Œæ–¹æ³•åŒºï¼ˆ5%ç©ºé—´ï¼‰ã€‘</p></li><li><p>JDK8 æ–¹æ³•åŒºä¸ºå…ƒç©ºé—´ï¼Œä½¿ç”¨æœ¬åœ°å†…å­˜ã€‚ï¼ˆæœ¬åœ°å†…å­˜å¾ˆå¤§ï¼Œæ–¹æ³•åŒºåŸºæœ¬ä¸å‡ºç°æº¢å‡ºï¼‰</p></li><li><p>æ¯ä¸€ä¸ªJVMåªæœ‰ä¸€ä¸ªRuntimeå®ä¾‹ï¼Œä¸ºè¿è¡Œæ—¶ç¯å¢ƒã€‚</p></li></ul><h3 id="jvmä¸­çš„çº¿ç¨‹è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#jvmä¸­çš„çº¿ç¨‹è¯´æ˜" aria-hidden="true">#</a> JVMä¸­çš„çº¿ç¨‹è¯´æ˜</h3><h4 id="è¯´æ˜ä¸€" tabindex="-1"><a class="header-anchor" href="#è¯´æ˜ä¸€" aria-hidden="true">#</a> è¯´æ˜ä¸€ï¼š</h4><ol><li><p>çº¿ç¨‹æ˜¯ä¸€ä¸ªç¨‹åºé‡Œçš„è¿è¡Œå•å…ƒã€‚JVMå…è®¸ä¸€ä¸ªåº”ç”¨æœ‰å¤šä¸ªçº¿ç¨‹å¹¶è¡Œçš„æ‰§è¡Œã€‚</p></li><li><p><mark>åœ¨Hotspot JVMé‡Œï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¸æ“ä½œç³»ç»Ÿçš„æœ¬åœ°çº¿ç¨‹ç›´æ¥æ˜ å°„ã€‚</mark></p></li><li><p>å½“ä¸€ä¸ª Java çº¿ç¨‹å‡†å¤‡å¥½æ‰§è¡Œä»¥åï¼Œæ­¤æ—¶ä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„æœ¬åœ°çº¿ç¨‹ä¹ŸåŒæ—¶åˆ›å»ºã€‚Javaçº¿ç¨‹æ‰§è¡Œç»ˆæ­¢åï¼Œæœ¬åœ°çº¿ç¨‹ä¹Ÿä¼šå›æ”¶ã€‚</p></li><li><p><mark>æ“ä½œç³»ç»Ÿè´Ÿè´£æ‰€æœ‰çº¿ç¨‹çš„å®‰æ’è°ƒåº¦åˆ°ä»»ä½•ä¸€ä¸ªå¯ç”¨çš„CPUä¸Šã€‚ä¸€æ—¦æœ¬åœ°çº¿ç¨‹åˆå§‹åŒ–æˆåŠŸï¼Œå®ƒå°±ä¼šè°ƒç”¨Javaçº¿ç¨‹ä¸­çš„run()æ–¹æ³•ã€‚</mark></p></li><li><p>Javaçº¿ç¨‹çš„å‡†å¤‡ï¼šPCå¯„å­˜å™¨ã€æœ¬åœ°æ–¹æ³•æ ˆã€è™šæ‹Ÿæœºæ ˆ</p></li><li><p>å¦‚æœ run æ–¹æ³•æ­£å¸¸æ‰§è¡Œç»“æŸï¼Œé‚£ä¹ˆ Java çº¿ç¨‹æ‰§è¡Œç»ˆæ­¢åï¼Œæœ¬åœ°çº¿ç¨‹ä¹Ÿä¼šå›æ”¶ï¼Œä½†å¦‚æœå‡ºç°äº†å¼‚å¸¸ï¼Œæœ¬åœ°çº¿ç¨‹ä¼šè€ƒè™‘JVMæ˜¯å¦ç»ˆæ­¢ï¼ˆæ˜¯å¦å…¨ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼‰ã€‚</p></li></ol><h4 id="è¯´æ˜äºŒ" tabindex="-1"><a class="header-anchor" href="#è¯´æ˜äºŒ" aria-hidden="true">#</a> è¯´æ˜äºŒï¼š</h4><p>å¦‚æœä½ ä½¿ç”¨ jconsole æˆ–è€…æ˜¯ä»»ä½•ä¸€ä¸ªè°ƒè¯•å·¥å…·ï¼Œéƒ½èƒ½çœ‹åˆ°åœ¨åå°æœ‰è®¸å¤šçº¿ç¨‹åœ¨è¿è¡Œã€‚è¿™äº›åå°çº¿ç¨‹ä¸åŒ…æ‹¬è°ƒç”¨ public static void main(String [ ])çš„ main çº¿ç¨‹ä»¥åŠæ‰€æœ‰è¿™ä¸ª main çº¿ç¨‹è‡ªå·±åˆ›å»ºçš„çº¿ç¨‹ã€‚è¿™äº›ä¸»è¦çš„åå°ç³»ç»Ÿçº¿ç¨‹åœ¨Hotspot JVMé‡Œä¸»è¦æ˜¯ä»¥ä¸‹å‡ ç±»ï¼š</p><ol><li><p><strong>è™šæ‹Ÿæœºçº¿ç¨‹</strong>ï¸°è¿™ç§çº¿ç¨‹çš„æ“ä½œæ˜¯éœ€è¦ JVM è¾¾åˆ°<mark>å®‰å…¨ç‚¹</mark>æ‰ä¼šå‡ºç°ã€‚è¿™äº›æ“ä½œå¿…é¡»åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­å‘ç”Ÿçš„åŸå› æ˜¯å®ƒä»¬éƒ½éœ€è¦JVMè¾¾åˆ°å®‰å…¨ç‚¹ï¼Œè¿™æ ·å †æ‰ä¸ä¼šå˜åŒ–ã€‚</p><p>è¿™ç§çº¿ç¨‹çš„æ‰§è¡Œç±»å‹åŒ…æ‹¬ &quot;stop-the-world&quot; çš„åƒåœ¾æ”¶é›†ï¼Œçº¿ç¨‹æ ˆæ”¶é›†ï¼Œçº¿ç¨‹æŒ‚èµ·ä»¥åŠåå‘é”æ’¤é”€ã€‚</p></li><li><p><strong>å‘¨æœŸä»»åŠ¡çº¿ç¨‹</strong>ï¼šè¿™ç§çº¿ç¨‹æ˜¯æ—¶é—´å‘¨æœŸäº‹ä»¶çš„ä½“ç°(æ¯”å¦‚ä¸­æ–­)ï¼Œä»–ä»¬ä¸€èˆ¬ç”¨äºå‘¨æœŸæ€§æ“ä½œçš„è°ƒåº¦æ‰§è¡Œã€‚</p></li><li><p><strong>GCçº¿ç¨‹</strong>ï¼šè¿™ç§çº¿ç¨‹å¯¹åœ¨JVMé‡Œä¸åŒç§ç±»çš„åƒåœ¾æ”¶é›†è¡Œä¸ºæä¾›äº†æ”¯æŒã€‚</p></li><li><p><strong>ç¼–è¯‘çº¿ç¨‹</strong>ï¼šè¿™ç§çº¿ç¨‹åœ¨è¿è¡Œæ—¶ä¼šå°†å­—èŠ‚ç ç¼–è¯‘æˆåˆ°æœ¬åœ°ä»£ç ã€‚</p></li><li><p><strong>ä¿¡å·è°ƒåº¦çº¿ç¨‹</strong>ï¼šè¿™ç§çº¿ç¨‹æ¥æ”¶ä¿¡å·å¹¶å‘é€ç»™JVMï¼Œåœ¨å®ƒå†…éƒ¨é€šè¿‡è°ƒç”¨é€‚å½“çš„æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚</p></li></ol><h3 id="ç¨‹åºè®¡æ•°å™¨" tabindex="-1"><a class="header-anchor" href="#ç¨‹åºè®¡æ•°å™¨" aria-hidden="true">#</a> ç¨‹åºè®¡æ•°å™¨</h3><p>Oracleçš„ä»‹ç»ï¼š<a href="https://docs.oracle.com/en/java/javase/19/" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/en/java/javase/19/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h4 id="pc-register-ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#pc-register-ä»‹ç»" aria-hidden="true">#</a> PC Register ä»‹ç»</h4><p>JVMä¸­çš„ç¨‹åºè®¡æ•°å¯„å­˜å™¨(Program counter Register)ä¸­ï¼ŒRegister çš„å‘½åæºäºCPUçš„å¯„å­˜å™¨ï¼Œå¯„å­˜å™¨å­˜å‚¨æŒ‡ä»¤ç›¸å…³çš„ç°åœºä¿¡æ¯ã€‚CPUåªæœ‰æŠŠæ•°æ®è£…è½½åˆ°å¯„å­˜å™¨æ‰èƒ½å¤Ÿè¿è¡Œã€‚</p><p>è¿™é‡Œï¼Œå¹¶éæ˜¯å¹¿ä¹‰ä¸Šæ‰€æŒ‡çš„ç‰©ç†å¯„å­˜å™¨ï¼Œæˆ–è®¸å°†å…¶ç¿»è¯‘ä¸ºPCè®¡æ•°å™¨ï¼ˆæˆ–æŒ‡ä»¤è®¡æ•°å™¨ï¼‰ä¼šæ›´åŠ è´´åˆ‡(ä¹Ÿç§°ä¸ºç¨‹åºé’©å­)ï¼Œå¹¶ä¸”ä¹Ÿä¸å®¹æ˜“å¼•èµ·ä¸€äº›ä¸å¿…è¦çš„è¯¯ä¼šã€‚</p><p><mark>JVMä¸­çš„PCå¯„å­˜å™¨æ˜¯å¯¹ç‰©ç†PCå¯„å­˜å™¨çš„ä¸€ç§æŠ½è±¡æ¨¡æ‹Ÿã€‚ï¼ˆè½¯ä»¶å±‚é¢ï¼‰</mark></p><h4 id="pc-register-ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#pc-register-ä½œç”¨" aria-hidden="true">#</a> PC Register ä½œç”¨</h4><p><strong>PCå¯„å­˜å™¨ç”¨æ¥å­˜å‚¨æŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œä¹Ÿå³å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤ä»£ç ã€‚ç”±æ‰§è¡Œå¼•æ“è¯»å–ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚</strong></p><figure><img src="/assets/PCå¯„å­˜å™¨-bb11979c.png" alt="PCå¯„å­˜å™¨.png" tabindex="0" loading="lazy"><figcaption>PCå¯„å­˜å™¨.png</figcaption></figure><h4 id="pcå¯„å­˜å™¨çš„æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#pcå¯„å­˜å™¨çš„æ¦‚è¿°" aria-hidden="true">#</a> PCå¯„å­˜å™¨çš„æ¦‚è¿°</h4><ol><li><p><strong>å®ƒæ˜¯ä¸€å—å¾ˆå°çš„å†…å­˜ç©ºé—´ï¼Œå‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®°ã€‚ä¹Ÿæ˜¯è¿è¡Œé€Ÿåº¦æœ€å¿«çš„å­˜å‚¨åŒºåŸŸã€‚åœ¨JVMè§„èŒƒä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰å®ƒè‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼Œæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸä¿æŒä¸€è‡´ã€‚</strong></p></li><li><p><strong>ä»»ä½•æ—¶é—´ä¸€ä¸ªçº¿ç¨‹éƒ½åªæœ‰ä¸€ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„å½“å‰æ–¹æ³•ã€‚ç¨‹åºè®¡æ•°å™¨ä¼šå­˜å‚¨å½“å‰çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„Javaæ–¹æ³•çš„JVMæŒ‡ä»¤åœ°å€ï¼›æˆ–è€…ï¼Œå¦‚æœæ˜¯åœ¨æ‰§è¡Œnativeæ–¹æ³•(C/C++)ï¼Œåˆ™æ˜¯æœªæŒ‡å®šå€¼ï¼ˆundefned) ã€‚</strong></p></li><li><p><strong>å®ƒæ˜¯ç¨‹åºæ§åˆ¶æµçš„æŒ‡ç¤ºå™¨ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰åŸºç¡€åŠŸèƒ½éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªè®¡æ•°å™¨æ¥å®Œæˆã€‚</strong></p></li><li><p><strong>å­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶å°±æ˜¯é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ã€‚</strong></p></li><li><p><strong>å®ƒæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨Javaè™šæ‹Ÿæœºè§„èŒƒä¸­æ²¡æœ‰è§„å®šä»»ä½• outOtMemoryError æƒ…å†µçš„åŒºåŸŸã€‚</strong></p></li></ol><ul><li><p><strong>å¯¹äºå †å’Œæ–¹æ³•åŒºï¼Œæœ‰GCå›æ”¶</strong></p></li><li><p><strong>å¯¹äºå †ã€æ–¹æ³•åŒºã€æ ˆï¼ˆè™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆæ²¡æœ‰GCï¼‰ï¼Œä¼šæœ‰OOM</strong></p></li><li><p><strong>ä½†PCå¯„å­˜å™¨ä¸ä¼šæœ‰GCå’ŒOOM</strong></p></li></ul><h4 id="pcå¯„å­˜å™¨çš„ä¸¤ä¸ªé—®é¢˜" tabindex="-1"><a class="header-anchor" href="#pcå¯„å­˜å™¨çš„ä¸¤ä¸ªé—®é¢˜" aria-hidden="true">#</a> PCå¯„å­˜å™¨çš„ä¸¤ä¸ªé—®é¢˜</h4><ol><li><p>ä½¿ç”¨PCå¯„å­˜å™¨å­˜å‚¨å­—èŠ‚ç æŒ‡ä»¤åœ°å€çš„ä½œç”¨</p><p>ä¸ºä»€ä¹ˆä½¿ç”¨PCå¯„å­˜å™¨è®°å½•å½“å‰çº¿ç¨‹çš„æ‰§è¡Œåœ°å€å‘¢ï¼Ÿ</p><p>å› ä¸ºCPUéœ€è¦ä¸åœçš„åˆ‡æ¢å„ä¸ªçº¿ç¨‹ï¼Œè¿™æ—¶å€™åˆ‡æ¢å›æ¥ä»¥åï¼Œå°±å¾—çŸ¥é“æ¥ç€ä»å“ªå¼€å§‹ç»§ç»­æ‰§è¡Œã€‚JVMçš„å­—èŠ‚ç è§£é‡Šå™¨å°±éœ€è¦é€šè¿‡æ”¹å˜PCå¯„å­˜å™¨çš„å€¼æ¥æ˜ç¡®ä¸‹ä¸€æ¡åº”è¯¥æ‰§è¡Œä»€ä¹ˆæ ·çš„å­—èŠ‚ç æŒ‡ä»¤ã€‚</p></li><li><p>PCå¯„å­˜å™¨ä¸ºä»€ä¹ˆä¼šè¢«è®¾å®šä¸ºçº¿ç¨‹ç§æœ‰?</p><p>ï¼ˆè‚¯å®šä¸èƒ½å…±äº«ï¼‰æ‰€è°“çš„å¤šçº¿ç¨‹åœ¨ä¸€ä¸ªç‰¹å®šçš„æ—¶é—´æ®µå†…åªä¼šæ‰§è¡Œå…¶ä¸­æŸä¸€ä¸ªçº¿ç¨‹çš„æ–¹æ³•ï¼ŒCPUä¼šä¸åœåœ°åšä»»åŠ¡åˆ‡æ¢ï¼Œè¿™æ ·å¿…ç„¶å¯¼è‡´ç»å¸¸ä¸­æ–­æˆ–æ¢å¤ï¼Œå¦‚ä½•ä¿è¯åˆ†æ¯«æ— å·®å‘¢ï¹–</p><ul><li><p>ä¸ºäº†èƒ½å¤šå‡†ç¡®åœ°è®°å½•å„ä¸ªçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„å½“å‰å­—èŠ‚ç æŒ‡ä»¤åœ°å€ï¼Œæœ€å¥½çš„åŠæ³•è‡ªç„¶æ˜¯ä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½åˆ†é…ä¸€ä¸ªPCå¯„å­˜å™¨ï¼Œè¿™æ ·ä¸€æ¥å„ä¸ªçº¿ç¨‹ä¹‹é—´ä¾¿å¯ä»¥è¿›è¡Œç‹¬ç«‹è®¡ç®—ï¼Œä»è€Œä¸ä¼šå‡ºç°ç›¸äº’å¹²æ‰°çš„æƒ…å†µã€‚</p></li><li><p>ç”±äºCPUæ—¶é—´ç‰‡è½®é™åˆ¶ï¼Œä¼—å¤šçº¿ç¨‹åœ¨å¹¶å‘æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä»»ä½•ä¸€ä¸ªç¡®å®šçš„æ—¶åˆ»ï¼Œä¸€ä¸ªå¤„ç†å™¨æˆ–è€…å¤šæ ¸å¤„ç†å™¨ä¸­çš„ä¸€ä¸ªå†…æ ¸ï¼Œåªä¼šæ‰§è¡ŒæŸä¸ªçº¿ç¨‹ä¸­çš„ä¸€æ¡æŒ‡ä»¤ã€‚</p></li><li><p>æ¯ä¸ªçº¿ç¨‹åœ¨åˆ›å»ºåï¼Œéƒ½ä¼šäº§ç”Ÿè‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨å’Œæ ˆå¸§ï¼Œç¨‹åºè®¡æ•°å™¨åœ¨å„ä¸ªçº¿ç¨‹ä¹‹é—´äº’ä¸å½±å“ã€‚</p><p>CPUæ—¶é—´ç‰‡ï¼šå³CPUåˆ†é…ç»™å„ä¸ªç¨‹åºçš„æ—¶é—´ï¼Œæ¯ä¸ªçº¿ç¨‹è¢«åˆ†é…ä¸€ä¸ªæ—¶é—´æ®µï¼Œç§°ä½œå®ƒçš„æ—¶é—´ç‰‡ã€‚</p></li></ul></li></ol><h2 id="è™šæ‹Ÿæœºæ ˆ" tabindex="-1"><a class="header-anchor" href="#è™šæ‹Ÿæœºæ ˆ" aria-hidden="true">#</a> è™šæ‹Ÿæœºæ ˆ</h2><h3 id="è™šæ‹Ÿæœºæ ˆçš„æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#è™šæ‹Ÿæœºæ ˆçš„æ¦‚è¿°" aria-hidden="true">#</a> è™šæ‹Ÿæœºæ ˆçš„æ¦‚è¿°</h3><h4 id="è™šæ‹Ÿæœºæ ˆå‡ºç°çš„èƒŒæ™¯" tabindex="-1"><a class="header-anchor" href="#è™šæ‹Ÿæœºæ ˆå‡ºç°çš„èƒŒæ™¯" aria-hidden="true">#</a> è™šæ‹Ÿæœºæ ˆå‡ºç°çš„èƒŒæ™¯</h4><p><mark>ç”±äºè·¨å¹³å°æ€§çš„è®¾è®¡ï¼ŒJavaçš„æŒ‡ä»¤éƒ½æ˜¯æ ¹æ®æ ˆæ¥è®¾è®¡çš„ã€‚ä¸åŒå¹³å°CPUæ¶æ„ä¸åŒï¼Œæ‰€ä»¥ä¸èƒ½è®¾è®¡ä¸ºåŸºäºå¯„å­˜å™¨çš„ã€‚</mark></p><p><mark>ä¼˜ç‚¹æ˜¯è·¨å¹³å°ï¼ŒæŒ‡ä»¤é›†å°ï¼Œç¼–è¯‘å™¨å®¹æ˜“å®ç°ï¼Œç¼ºç‚¹æ˜¯æ€§èƒ½ä¸‹é™ï¼Œå®ç°åŒæ ·çš„åŠŸèƒ½éœ€è¦æ›´å¤šçš„æŒ‡ä»¤ã€‚</mark></p><p><strong>æ ˆæ˜¯è¿è¡Œæ—¶çš„å•ä½ï¼Œè€Œå †æ˜¯å­˜å‚¨çš„å•ä½ã€‚</strong></p><p>å³ï¼šæ ˆè§£å†³ç¨‹åºçš„è¿è¡Œé—®é¢˜ï¼Œå³ç¨‹åºå¦‚ä½•æ‰§è¡Œï¼Œæˆ–è€…è¯´å¦‚ä½•å¤„ç†æ•°æ®ã€‚å †è§£å†³çš„æ˜¯æ•°æ®å­˜å‚¨çš„é—®é¢˜ï¼Œå³æ•°æ®æ€ä¹ˆæ”¾ã€æ”¾åœ¨å“ªå„¿ã€‚</p><h4 id="javaè™šæ‹Ÿæœºæ ˆä»‹ç»" tabindex="-1"><a class="header-anchor" href="#javaè™šæ‹Ÿæœºæ ˆä»‹ç»" aria-hidden="true">#</a> Javaè™šæ‹Ÿæœºæ ˆä»‹ç»</h4><ol><li><p>Javaè™šæ‹Ÿæœºæ ˆæ˜¯ä»€ä¹ˆ</p><ul><li><p>Javaè™šæ‹Ÿæœºæ ˆï¼ˆJava virtual Machine stack)ï¼Œæ—©æœŸä¹Ÿå« Java æ ˆã€‚æ¯ä¸ªçº¿ç¨‹åœ¨åˆ›å»ºæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºæ ˆï¼Œå…¶å†…éƒ¨ä¿å­˜æ¯ä¸€ä¸ªæ ˆå¸§ï¼ˆStack Frameï¼‰ï¼Œå¯¹åº”ç€æ¯ä¸€æ¬¡çš„ Javaæ–¹æ³•è°ƒç”¨ã€‚</p></li><li><p>æ˜¯çº¿ç¨‹ç§æœ‰çš„</p></li></ul></li><li><p>ç”Ÿå‘½å‘¨æœŸ</p><p>ç”Ÿå‘½å‘¨æœŸå’Œçº¿ç¨‹ä¸€è‡´ã€‚</p></li><li><p>ä½œç”¨</p><p>ä¸»è¦è´Ÿè´£ Java ç¨‹åºçš„è¿è¡Œï¼Œå®ƒä¿å­˜æ–¹æ³•çš„å±€éƒ¨å˜é‡ï¼ˆ8ç§åŸºæœ¬çš„æ•°æ®ç±»å‹å’Œå¯¹è±¡å¼•ç”¨åœ°å€ï¼‰ã€éƒ¨åˆ†ç»“æœï¼Œå¹¶å‚ä¸æ–¹æ³•çš„è°ƒç”¨å’Œè¿”å›ã€‚</p></li></ol><h4 id="æ ˆçš„ä¼˜ç‚¹" tabindex="-1"><a class="header-anchor" href="#æ ˆçš„ä¼˜ç‚¹" aria-hidden="true">#</a> æ ˆçš„ä¼˜ç‚¹</h4><ol><li><p><strong>æ ˆæ˜¯ä¸€ç§å¿«é€Ÿæœ‰æ•ˆçš„åˆ†é…å­˜å‚¨æ–¹å¼ï¼Œè®¿é—®é€Ÿåº¦ä»…æ¬¡äºç¨‹åºè®¡æ•°å™¨ã€‚</strong></p></li><li><p>JVMç›´æ¥å¯¹ Java æ ˆçš„æ“ä½œåªæœ‰ä¸¤ä¸ªï¼š</p><p>æ¯ä¸ªæ–¹æ³•æ‰§è¡Œï¼Œä¼´éšç€è¿›æ ˆï¼ˆå…¥æ ˆã€å‹æ ˆï¼‰ã€æ‰§è¡Œç»“æŸåçš„å‡ºæ ˆå·¥ä½œ</p></li><li><p>å¯¹äºæ ˆæ¥è¯´ä¸å­˜åœ¨åƒåœ¾å›æ”¶é—®é¢˜</p></li></ol><h4 id="æ ˆä¸­å¯èƒ½å‡ºç°çš„å¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#æ ˆä¸­å¯èƒ½å‡ºç°çš„å¼‚å¸¸" aria-hidden="true">#</a> æ ˆä¸­å¯èƒ½å‡ºç°çš„å¼‚å¸¸</h4><ul><li><p>Java è™šæ‹Ÿæœºè§„èŒƒå…è®¸ Java æ ˆçš„å¤§å°æ˜¯åŠ¨æ€çš„æˆ–è€…æ˜¯å›ºå®šä¸å˜çš„ã€‚</p></li><li><p>å¦‚æœé‡‡ç”¨å›ºå®šå¤§å°çš„ Java è™šæ‹Ÿæœºæ ˆï¼Œé‚£æ¯ä¸€ä¸ªçº¿ç¨‹çš„ Java è™šæ‹Ÿæœºæ ˆå®¹é‡å¯ä»¥åœ¨çº¿ç¨‹åˆ›å»ºçš„æ—¶å€™ç‹¬ç«‹é€‰å®šã€‚å¦‚æœçº¿ç¨‹è¯·æ±‚åˆ†é…çš„æ ˆå®¹é‡è¶…è¿‡ Java è™šæ‹Ÿæœºæ ˆå…è®¸çš„æœ€å¤§å®¹é‡ï¼ŒJava è™šæ‹Ÿæœºå°†ä¼šæŠ›å‡ºä¸€ä¸ª StackOverflowError å¼‚å¸¸ã€‚</p></li><li><p>å¦‚æœ Java è™šæ‹Ÿæœºæ ˆå¯ä»¥åŠ¨æ€æ‰©å±•ï¼Œå¹¶ä¸”åœ¨å°è¯•æ‰©å±•çš„æ—¶å€™æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜ï¼Œæˆ–è€…åœ¨åˆ›å»ºæ–°çš„çº¿ç¨‹æ—¶æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜å»åˆ›å»ºå¯¹åº”çš„è™šæ‹Ÿæœºæ ˆï¼Œé‚£ Java è™šæ‹Ÿæœºå°†ä¼šæŠ›å‡ºä¸€ä¸ª OutofMemoryError å¼‚å¸¸ã€‚</p></li></ul><h4 id="è®¾ç½®æ ˆå†…å­˜å¤§å°" tabindex="-1"><a class="header-anchor" href="#è®¾ç½®æ ˆå†…å­˜å¤§å°" aria-hidden="true">#</a> è®¾ç½®æ ˆå†…å­˜å¤§å°</h4><p>å¯ä»¥ä½¿ç”¨å‚æ•° -Xss é€‰é¡¹æ¥è®¾ç½®çº¿ç¨‹çš„æœ€å¤§æ ˆç©ºé—´ï¼Œæ ˆçš„å¤§å°ç›´æ¥å†³å®šäº†å‡½æ•°è°ƒç”¨çš„æœ€å¤§å¯è¾¾æ·±åº¦ã€‚</p><p><a href="https://docs.oracle.com/en/java/javase/11/tools/java.html#GUID-3B1CE181-CD30-4178-9602-230B800D4FAE" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/en/java/javase/11/tools/java.html#GUID-3B1CE181-CD30-4178-9602-230B800D4FAE<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><blockquote><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>-Xss size
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Sets the thread stack size (in bytes). Append the letter <code>k</code> or <code>K</code> to indicate KB, <code>m</code> or <code>M</code> to indicate MB, and <code>g</code> or <code>G</code> to indicate GB. The default value depends on the platform:</p><ul><li>Linux/x64 (64-bit): 1024 KB</li><li>macOS (64-bit): 1024 KB</li><li>Oracle Solaris/x64 (64-bit): 1024 KB</li><li>Windows: The default value depends on virtual memory</li></ul><p>The following examples set the thread stack size to 1024 KB in different units:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Copy-Xss1m
-Xss1024k
-Xss1048576
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="æ ˆçš„å­˜å‚¨ç»“æ„å’Œè¿è¡ŒåŸç†" tabindex="-1"><a class="header-anchor" href="#æ ˆçš„å­˜å‚¨ç»“æ„å’Œè¿è¡ŒåŸç†" aria-hidden="true">#</a> æ ˆçš„å­˜å‚¨ç»“æ„å’Œè¿è¡ŒåŸç†</h3><h4 id="æ ˆä¸­å­˜å‚¨ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#æ ˆä¸­å­˜å‚¨ä»€ä¹ˆ" aria-hidden="true">#</a> æ ˆä¸­å­˜å‚¨ä»€ä¹ˆï¼Ÿ</h4><ol><li><p>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„æ ˆï¼Œæ ˆä¸­çš„æ•°æ®éƒ½æ˜¯ä»¥æ ˆå¸§(stack Frameï¼‰çš„æ ¼å¼å­˜åœ¨ã€‚</p></li><li><p>åœ¨è¿™ä¸ªçº¿ç¨‹ä¸Šæ­£åœ¨æ‰§è¡Œçš„æ¯ä¸ªæ–¹æ³•éƒ½å„è‡ªå¯¹åº”ä¸€ä¸ªæ ˆå¸§(stack Frameï¼‰ã€‚</p></li><li><p>æ ˆå¸§æ˜¯ä¸€ä¸ªå†…å­˜åŒºå—ï¼Œæ˜¯ä¸€ä¸ªæ•°æ®é›†ï¼Œç»´ç³»ç€æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å„ç§æ•°æ®ä¿¡æ¯ã€‚</p></li></ol><h4 id="æ ˆçš„è¿è¡ŒåŸç†" tabindex="-1"><a class="header-anchor" href="#æ ˆçš„è¿è¡ŒåŸç†" aria-hidden="true">#</a> æ ˆçš„è¿è¡ŒåŸç†</h4><ol><li><p>JVMç›´æ¥å¯¹Javaæ ˆçš„æ“ä½œåªæœ‰ä¸¤ä¸ªï¼Œå°±æ˜¯å¯¹æ ˆå¸§çš„å‹æ ˆå’Œå‡ºæ ˆï¼Œéµå¾ª&quot;å…ˆè¿›åå‡º&quot;æˆ–&quot;åè¿›å…ˆå‡º&quot;åŸåˆ™ã€‚</p></li><li><p>åœ¨ä¸€æ¡æ´»åŠ¨çº¿ç¨‹ä¸­ï¼Œä¸€ä¸ªæ—¶é—´ç‚¹ä¸Šï¼Œåªä¼šæœ‰ä¸€ä¸ªæ´»åŠ¨çš„æ ˆå¸§ã€‚å³åªæœ‰å½“å‰æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•çš„æ ˆå¸§ï¼ˆæ ˆé¡¶æ ˆå¸§ï¼‰æ˜¯æœ‰æ•ˆçš„ï¼Œè¿™ä¸ªæ ˆå¸§è¢«ç§°ä¸ºå½“å‰æ ˆå¸§(Current Frame)ï¼Œä¸å½“å‰æ ˆå¸§ç›¸å¯¹åº”çš„æ–¹æ³•å°±æ˜¯å½“å‰æ–¹æ³•(currentMethod)ï¼Œå®šä¹‰è¿™ä¸ªæ–¹æ³•çš„ç±»å°±æ˜¯å½“å‰ç±»(current class)ã€‚</p></li><li><p>æ‰§è¡Œå¼•æ“è¿è¡Œçš„æ‰€æœ‰å­—èŠ‚ç æŒ‡ä»¤åªé’ˆå¯¹å½“å‰æ ˆå¸§è¿›è¡Œæ“ä½œã€‚</p></li><li><p>å¦‚æœåœ¨è¯¥æ–¹æ³•ä¸­è°ƒç”¨äº†å…¶ä»–æ–¹æ³•ï¼Œå¯¹åº”çš„æ–°çš„æ ˆå¸§ä¼šè¢«åˆ›å»ºå‡ºæ¥ï¼Œæ”¾åœ¨æ ˆçš„é¡¶ç«¯ï¼Œæˆä¸ºæ–°çš„å½“å‰å¸§ã€‚</p></li><li><p>ä¸åŒçº¿ç¨‹ä¸­æ‰€åŒ…å«çš„æ ˆå¸§æ˜¯ä¸å…è®¸å­˜åœ¨ç›¸äº’å¼•ç”¨çš„ï¼Œå³ä¸å¯èƒ½åœ¨ä¸€ä¸ªæ ˆå¸§ä¹‹ä¸­å¼•ç”²å¦å¤–ä¸€ä¸ªçº¿ç¨‹çš„æ ˆå¸§ã€‚</p></li><li><p>å¦‚æœå½“å‰æ–¹æ³•è°ƒç”¨äº†å…¶ä»–æ–¹æ³•ï¼Œæ–¹æ³•è¿”å›ä¹‹é™…ï¼Œå½“å‰æ ˆå¸§ä¼šä¼ å›æ­¤æ–¹æ³•çš„æ‰§è¡Œç»“æœç»™å‰ä¸€ä¸ªæ ˆå¸§ï¼Œæ¥ç€ï¼Œè™šæ‹Ÿæœºä¼šä¸¢å¼ƒå½“å‰æ ˆå¸§ï¼Œä½¿å¾—å‰ä¸€ä¸ªæ ˆå¸§é‡æ–°æˆä¸ºå½“å‰æ ˆå¸§ã€‚</p></li><li><p>Javaæ–¹æ³•æœ‰ä¸¤ç§è¿”å›å‡½æ•°çš„æ–¹å¼ï¼Œä¸€ç§æ˜¯æ­£å¸¸çš„å‡½æ•°è¿”å›ï¼Œä½¿ç”¨returnæŒ‡ä»¤ï¼›å¦å¤–ä¸€ç§æ˜¯æŠ›å‡ºå¼‚å¸¸ï¼ˆç”±ä¸Šä¸€ä¸ªæ ˆå¸§å¯¹åº”çš„æ–¹æ³•è¿›è¡Œå¤„ç†ï¼Œå¦åˆ™ç»§ç»­æŠ›å‡ºï¼‰ã€‚ä¸ç®¡ä½¿ç”¨å“ªç§æ–¹å¼ï¼Œéƒ½ä¼šå¯¼è‡´æ ˆå¸§è¢«å¼¹å‡ºã€‚</p></li></ol><h4 id="æ ˆå¸§çš„å†…éƒ¨ç»“æ„" tabindex="-1"><a class="header-anchor" href="#æ ˆå¸§çš„å†…éƒ¨ç»“æ„" aria-hidden="true">#</a> æ ˆå¸§çš„å†…éƒ¨ç»“æ„</h4><p>æ¯ä¸ªæ ˆå¸§ä¸­å­˜å‚¨ç€ï¼šï¼ˆå±€éƒ¨å˜é‡è¡¨å’Œæ“ä½œæ•°æ ˆä¸»è¦å½±å“æ ˆå¸§çš„å¤§å°ï¼‰</p><ol><li><p>å±€éƒ¨å˜é‡è¡¨ï¼ˆLocal variables)</p></li><li><p>æ“ä½œæ•°æ ˆï¼ˆoperand stack)(æˆ–è¡¨è¾¾å¼æ ˆ)</p></li><li><p>åŠ¨æ€é“¾æ¥(Dynamic Linking)(æˆ–æŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± çš„æ–¹æ³•å¼•ç”¨)</p></li><li><p>æ–¹æ³•è¿”å›åœ°å€ï¼ˆReturn Addressï¼‰(æˆ–æ–¹æ³•æ­£å¸¸é€€å‡ºæˆ–è€…å¼‚å¸¸é€€å‡ºçš„å®šä¹‰)</p></li><li><p>ä¸€äº›é™„åŠ ä¿¡æ¯</p></li></ol><h3 id="å±€éƒ¨å˜é‡è¡¨" tabindex="-1"><a class="header-anchor" href="#å±€éƒ¨å˜é‡è¡¨" aria-hidden="true">#</a> å±€éƒ¨å˜é‡è¡¨</h3><h4 id="å‡ ç‚¹è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#å‡ ç‚¹è¯´æ˜" aria-hidden="true">#</a> å‡ ç‚¹è¯´æ˜</h4><ol><li><p>å±€éƒ¨å˜é‡è¡¨ä¹Ÿè¢«ç§°ä¹‹ä¸º<strong>å±€éƒ¨å˜é‡æ•°ç»„</strong>æˆ–æœ¬åœ°å˜é‡è¡¨ã€‚</p></li><li><p>å®šä¹‰ä¸ºä¸€ä¸ªæ•°å­—æ•°ç»„ï¼Œä¸»è¦ç”¨äºå­˜å‚¨æ–¹æ³•å‚æ•°å’Œå®šä¹‰åœ¨æ–¹æ³•ä½“å†…çš„å±€éƒ¨å˜é‡è¿™äº›æ•°æ®ç±»å‹åŒ…æ‹¬å„ç±»åŸºæœ¬æ•°æ®ç±»å‹ã€å¯¹è±¡å¼•ç”¨ï¼ˆreference)ï¼Œä»¥åŠreturnAddressç±»å‹ã€‚</p></li><li><p>ç”±äºå±€éƒ¨å˜é‡è¡¨æ˜¯å»ºç«‹åœ¨çº¿ç¨‹çš„æ ˆä¸Šï¼Œæ˜¯çº¿ç¨‹çš„ç§æœ‰æ•°æ®ï¼Œå› æ­¤ä¸å­˜åœ¨æ•°æ®å®‰å…¨é—®é¢˜ã€‚</p></li><li><p><strong>å±€éƒ¨å˜é‡è¡¨æ‰€éœ€çš„å®¹é‡å¤§å°æ˜¯åœ¨ç¼–è¯‘æœŸç¡®å®šä¸‹æ¥çš„</strong>ï¼Œå¹¶ä¿å­˜åœ¨æ–¹æ³•çš„Codeå±æ€§çš„maximum local variablesæ•°æ®é¡¹ä¸­ã€‚åœ¨æ–¹æ³•è¿è¡ŒæœŸé—´æ˜¯ä¸ä¼šæ”¹å˜å±€éƒ¨å˜é‡è¡¨çš„å¤§å°çš„ã€‚</p></li><li><p>æ–¹æ³•åµŒå¥—è°ƒç”¨çš„æ¬¡æ•°ç”±æ ˆçš„å¤§å°å†³å®šã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ ˆè¶Šå¤§ï¼Œæ–¹æ³•åµŒå¥—è°ƒç”¨æ¬¡æ•°è¶Šå¤šã€‚å¯¹ä¸€ä¸ªå‡½æ•°è€Œè¨€ï¼Œå®ƒçš„å‚æ•°å’Œå±€éƒ¨å˜é‡è¶Šå¤šï¼Œä½¿å¾—å±€éƒ¨å˜é‡è¡¨è†¨èƒ€ï¼Œå®ƒçš„æ ˆå¸§å°±è¶Šå¤§ï¼Œä»¥æ»¡è¶³æ–¹æ³•è°ƒç”¨æ‰€éœ€ä¼ é€’çš„ä¿¡æ¯å¢å¤§çš„éœ€æ±‚ã€‚è¿›è€Œå‡½æ•°è°ƒç”¨å°±ä¼šå ç”¨æ›´å¤šçš„æ ˆç©ºé—´ï¼Œå¯¼è‡´å…¶åµŒå¥—è°ƒç”¨æ¬¡æ•°å°±ä¼šå‡å°‘ã€‚</p></li><li><p>å±€éƒ¨å˜é‡è¡¨ä¸­çš„å˜é‡åªåœ¨å½“å‰æ–¹æ³•è°ƒç”¨ä¸­æœ‰æ•ˆã€‚åœ¨æ–¹æ³•æ‰§è¡Œæ—¶ï¼Œè™šæ‹Ÿæœºé€šè¿‡ä½¿ç”¨å±€éƒ¨å˜é‡è¡¨å®Œæˆå‚æ•°å€¼åˆ°å‚æ•°å˜é‡åˆ—è¡¨çš„ä¼ é€’è¿‡ç¨‹ã€‚å½“æ–¹æ³•è°ƒç”¨ç»“æŸåï¼Œéšç€æ–¹æ³•æ ˆå¸§çš„é”€æ¯ï¼Œå±€éƒ¨å˜é‡è¡¨ä¹Ÿä¼šéšä¹‹é”€æ¯ã€‚</p></li></ol><h4 id="å­—èŠ‚ç ä¸­æ–¹æ³•çš„å†…éƒ¨ç»“æ„" tabindex="-1"><a class="header-anchor" href="#å­—èŠ‚ç ä¸­æ–¹æ³•çš„å†…éƒ¨ç»“æ„" aria-hidden="true">#</a> å­—èŠ‚ç ä¸­æ–¹æ³•çš„å†…éƒ¨ç»“æ„</h4><p>Vä»£è¡¨è¿”å›å€¼ç±»å‹ï¼švoid</p><h4 id="å…³äºslotçš„ç†è§£" tabindex="-1"><a class="header-anchor" href="#å…³äºslotçš„ç†è§£" aria-hidden="true">#</a> å…³äºSlotçš„ç†è§£</h4><h5 id="å‡ ç‚¹è¯´æ˜-1" tabindex="-1"><a class="header-anchor" href="#å‡ ç‚¹è¯´æ˜-1" aria-hidden="true">#</a> å‡ ç‚¹è¯´æ˜</h5><ol><li><p>å‚æ•°å€¼çš„å­˜æ”¾æ€»æ˜¯åœ¨å±€éƒ¨å˜é‡æ•°ç»„çš„index0å¼€å§‹ï¼Œåˆ°æ•°ç»„é•¿åº¦-1çš„ç´¢å¼•ç»“æŸã€‚</p></li><li><p>å±€éƒ¨å˜é‡è¡¨ï¼Œæœ€åŸºæœ¬çš„å­˜å‚¨å•å…ƒæ˜¯slot(å˜é‡æ§½)</p></li><li><p>å±€éƒ¨å˜é‡è¡¨ä¸­å­˜æ”¾ç¼–è¯‘æœŸå¯çŸ¥çš„å„ç§åŸºæœ¬æ•°æ®ç±»å‹(8ç§)ï¼Œå¼•ç”¨ç±»å‹(reference) ï¼ŒreturnAddressç±»å‹çš„å˜é‡ã€‚</p></li><li><p>åœ¨å±€éƒ¨å˜é‡è¡¨é‡Œï¼Œ32ä½ä»¥å†…çš„ç±»å‹åªå ç”¨ä¸€ä¸ªslot(åŒ…æ‹¬returnAddressç±»å‹ï¼‰ï¼Œ64ä½çš„ç±»å‹(longå’Œdouble)å ç”¨ä¸¤ä¸ªslotã€‚</p><ul><li><p>byteã€shortã€charåœ¨å­˜å‚¨å‰è¢«è½¬æ¢ä¸ºintï¼Œbooleanä¹Ÿè¢«è½¬æ¢ä¸ºintï¼Œ0è¡¨ç¤ºfalseï¼Œé0è¡¨ç¤ºtrueã€‚</p></li><li><p>longå’Œdouble åˆ™å æ®ä¸¤ä¸ªslotã€‚</p></li></ul></li><li><p>JVMä¼šä¸ºå±€éƒ¨å˜é‡è¡¨ä¸­çš„æ¯ä¸€ä¸ªslotéƒ½åˆ†é…ä¸€ä¸ªè®¿é—®ç´¢å¼•ï¼Œé€šè¿‡è¿™ä¸ªç´¢å¼•å³å¯æˆåŠŸè®¿é—®åˆ°å±€éƒ¨å˜é‡è¡¨ä¸­æŒ‡å®šçš„å±€éƒ¨å˜é‡å€¼ã€‚</p></li><li><p>å½“ä¸€ä¸ªå®ä¾‹æ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œå®ƒçš„æ–¹æ³•å‚æ•°å’Œæ–¹æ³•ä½“å†…éƒ¨å®šä¹‰çš„å±€éƒ¨å˜é‡å°†ä¼šæŒ‰ç…§é¡ºåºè¢«å¤åˆ¶åˆ°å±€éƒ¨å˜é‡è¡¨ä¸­çš„æ¯ä¸€ä¸ªslotä¸Šã€‚</p></li><li><p>å¦‚æœéœ€è¦è®¿é—®å±€éƒ¨å˜é‡è¡¨ä¸­ä¸€ä¸ª64bitçš„å±€éƒ¨å˜é‡å€¼æ—¶ï¼Œåªéœ€è¦ä½¿ç”¨å‰ä¸€ä¸ªç´¢å¼•å³å¯ã€‚(æ¯”å¦‚è®¿é—®longæˆ–doubleç±»å‹å˜é‡)</p></li><li><p>å¦‚æœå½“å‰å¸§æ˜¯ç”±æ„é€ æ–¹æ³•æˆ–è€…å®ä¾‹æ–¹æ³•åˆ›å»ºçš„ï¼Œé‚£ä¹ˆè¯¥å¯¹è±¡å¼•ç”¨thiså°†ä¼šå­˜æ”¾åœ¨indexä¸º0çš„slotå¤„ï¼Œå…¶ä½™çš„å‚æ•°æŒ‰ç…§å‚æ•°è¡¨é¡ºåºç»§ç»­æ’åˆ—ã€‚</p><p>å®ä¾‹æ–¹æ³•é»˜è®¤æ˜¯æœ‰thisçš„</p><p>å¦‚æœä¸ä½¿ç”¨å˜é‡æ¥æ”¶ä¸€ä¸ªæ–¹æ³•çš„è¿”å›å€¼ï¼Œé‚£ä¹ˆslotä¸­ä¸ä¼šå‡ºç°è¿”å›å€¼ã€‚</p></li><li><p>åœ¨æ ˆå¸§ä¸­ï¼Œä¸æ€§èƒ½è°ƒä¼˜å…³ç³»æœ€ä¸ºå¯†åˆ‡çš„éƒ¨åˆ†å°±æ˜¯å‰é¢æåˆ°çš„å±€éƒ¨å˜é‡è¡¨ã€‚åœ¨æ–¹æ³•æ‰§è¡Œæ—¶ï¼Œè™šæ‹Ÿæœºä½¿ç”¨å±€éƒ¨å˜é‡è¡¨å®Œæˆæ–¹æ³•çš„ä¼ é€’ã€‚</p></li><li><p>å±€éƒ¨å˜é‡è¡¨ä¸­çš„å˜é‡ä¹Ÿæ˜¯é‡è¦çš„åƒåœ¾å›æ”¶æ ¹èŠ‚ç‚¹ï¼Œåªè¦è¢«å±€éƒ¨å˜é‡è¡¨ä¸­ç›´æ¥æˆ–é—´æ¥å¼•ç”¨çš„å¯¹è±¡éƒ½ä¸ä¼šè¢«å›æ”¶ã€‚</p></li></ol><h5 id="slotçš„é‡å¤åˆ©ç”¨" tabindex="-1"><a class="header-anchor" href="#slotçš„é‡å¤åˆ©ç”¨" aria-hidden="true">#</a> Slotçš„é‡å¤åˆ©ç”¨</h5><p>â€‹ æ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨ä¸­çš„æ§½ä½æ˜¯å¯ä»¥é‡ç”¨çš„ï¼Œå¦‚æœä¸€ä¸ªå±€éƒ¨å˜é‡è¿‡äº†å…¶ä½œç”¨åŸŸï¼Œé‚£ä¹ˆåœ¨å…¶ä½œç”¨åŸŸä¹‹åç”³æ˜çš„æ–°çš„å±€éƒ¨å˜é‡å°±å¾ˆæœ‰å¯èƒ½ä¼šå¤ç”¨è¿‡æœŸå±€éƒ¨å˜é‡çš„æ§½ä½ï¼Œä»è€Œè¾¾åˆ°èŠ‚çœèµ„æºçš„ç›®çš„ã€‚</p><p>å˜é‡cä½¿ç”¨ä¹‹å‰ä¼šå…ˆä½¿ç”¨å·²ç»é”€æ¯çš„å˜é‡bå æ®çš„slotçš„ä½ç½®ã€‚ï¼ˆåºå·ç›¸åŒï¼‰</p><p>åœ¨æ–¹æ³•æˆ–è¯­å¥ä¸­å‡ºç°çš„{}å°±ç§°ä¸ºæ™®é€šä»£ç å—ã€‚æ™®é€šä»£ç å—å’Œä¸€èˆ¬è¯­å¥çš„æ‰§è¡Œé¡ºåºç”±ä»–ä»¬åœ¨ä»£ç ä¸­å‡ºç°çš„æ¬¡åºå†³å®šï¼Œå…ˆå‡ºç°å…ˆæ‰§è¡Œã€‚</p><h4 id="é™æ€å˜é‡ä¸å±€éƒ¨å˜é‡çš„å¯¹æ¯”" tabindex="-1"><a class="header-anchor" href="#é™æ€å˜é‡ä¸å±€éƒ¨å˜é‡çš„å¯¹æ¯”" aria-hidden="true">#</a> é™æ€å˜é‡ä¸å±€éƒ¨å˜é‡çš„å¯¹æ¯”</h4><p>å‚æ•°è¡¨åˆ†é…å®Œæ¯•ä¹‹åï¼Œå†æ ¹æ®æ–¹æ³•ä½“å†…å®šä¹‰çš„å˜é‡çš„é¡ºåºå’Œä½œç”¨åŸŸåˆ†é…ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ç±»å˜é‡è¡¨æœ‰ä¸¤æ¬¡åˆå§‹åŒ–çš„æœºä¼šï¼Œç¬¬ä¸€æ¬¡æ˜¯åœ¨&quot;å‡†å¤‡é˜¶æ®µ&quot;ï¼Œæ‰§è¡Œç³»ç»Ÿåˆå§‹åŒ–ï¼Œå¯¹ç±»å˜é‡è®¾ç½®é›¶å€¼ï¼Œå¦ä¸€æ¬¡åˆ™æ˜¯åœ¨&quot;åˆå§‹åŒ–&quot;é˜¶æ®µï¼Œèµ‹äºˆç¨‹åºå‘˜åœ¨ä»£ç ä¸­å®šä¹‰çš„åˆå§‹å€¼ã€‚</p><p>å’Œç±»å˜é‡åˆå§‹åŒ–ä¸åŒçš„æ˜¯ï¼Œå±€éƒ¨å˜é‡è¡¨ä¸å­˜åœ¨ç³»ç»Ÿåˆå§‹åŒ–çš„è¿‡ç¨‹ï¼Œè¿™æ„å‘³ç€ä¸€æ—¦å®šä¹‰äº†å±€éƒ¨å˜é‡åˆ™å¿…é¡»äººä¸ºçš„åˆå§‹åŒ–ï¼Œå¦åˆ™æ— æ³•ä½¿ç”¨ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> num<span class="token punctuation">;</span>
        <span class="token comment">//å¿…é¡»æ˜¾ç¤ºèµ‹å€¼</span>
        <span class="token comment">// System.out.println(num);</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ ˆå¸§ä¸­ï¼Œä¸æ€§èƒ½è°ƒä¼˜å…³ç³»æœ€ä¸ºå¯†åˆ‡çš„éƒ¨åˆ†å°±æ˜¯å‰é¢æåˆ°çš„å±€éƒ¨å˜é‡è¡¨ã€‚åœ¨æ–¹æ³•æ‰§è¡Œæ—¶ï¼Œè™šæ‹Ÿæœºä½¿ç”¨å±€éƒ¨å˜é‡è¡¨å®Œæˆæ–¹æ³•çš„ä¼ é€’ã€‚</p><p>å±€éƒ¨å˜é‡è¡¨ä¸­çš„å˜é‡ä¹Ÿæ˜¯é‡è¦çš„åƒåœ¾å›æ”¶æ ¹èŠ‚ç‚¹ï¼Œåªè¦è¢«å±€éƒ¨å˜é‡è¡¨ä¸­ç›´æ¥æˆ–é—´æ¥å¼•ç”¨çš„å¯¹è±¡éƒ½ä¸ä¼šè¢«å›æ”¶ã€‚</p><h3 id="æ“ä½œæ•°æ ˆ" tabindex="-1"><a class="header-anchor" href="#æ“ä½œæ•°æ ˆ" aria-hidden="true">#</a> æ“ä½œæ•°æ ˆ</h3><p>æ“ä½œæ•°æ ˆä½¿ç”¨æ•°ç»„ï¼ˆé“¾è¡¨ï¼‰å®ç°</p><p>æ¯ä¸€ä¸ªç‹¬ç«‹çš„æ ˆå¸§ä¸­é™¤äº†åŒ…å«å±€éƒ¨å˜é‡è¡¨ä»¥å¤–ï¼Œè¿˜åŒ…å«ä¸€ä¸ªåè¿›å…ˆå‡º(Last-In-First-Out)çš„æ“ä½œæ•°æ ˆï¼Œä¹Ÿå¯ä»¥ç§°ä¹‹ä¸ºè¡¨è¾¾å¼æ ˆ(Expression Stack) ã€‚</p><p>æ“ä½œæ•°æ ˆï¼Œåœ¨æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ ¹æ®å­—èŠ‚ç æŒ‡ä»¤ï¼Œå¾€æ ˆä¸­å†™å…¥æ•°æ®æˆ–æå–æ•°æ®ï¼Œå³å…¥æ ˆ(push) /å‡ºæ ˆ(pop)ã€‚</p><p>æŸäº›å­—èŠ‚ç æŒ‡ä»¤å°†å€¼å‹å…¥æ“ä½œæ•°æ ˆï¼Œå…¶ä½™çš„å­—èŠ‚ç æŒ‡ä»¤å°†æ“ä½œæ•°å–å‡ºæ ˆã€‚ä½¿ç”¨å®ƒä»¬åå†æŠŠç»“æœå‹å…¥æ ˆã€‚</p><p>æ¯”å¦‚ï¼šæ‰§è¡Œå¤åˆ¶ã€äº¤æ¢ã€æ±‚å’Œç­‰æ“ä½œã€‚</p><p>æ“ä½œæ•°æ ˆï¼Œä¸»è¦ç”¨äºä¿å­˜è®¡ç®—è¿‡ç¨‹çš„ä¸­é—´ç»“æœï¼ŒåŒæ—¶ä½œä¸ºè®¡ç®—è¿‡ç¨‹ä¸­å˜é‡</p><p>ä¸´æ—¶çš„å­˜å‚¨ç©ºé—´ã€‚</p><p>æ“ä½œæ•°æ ˆå°±æ˜¯JVMæ‰§è¡Œå¼•æ“çš„ä¸€ä¸ªå·¥ä½œåŒºï¼Œå½“ä¸€ä¸ªæ–¹æ³•åˆšå¼€å§‹æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€ä¸ªæ–°çš„æ ˆå¸§ä¹Ÿä¼šéšä¹‹è¢«åˆ›å»ºå‡ºæ¥ï¼Œè¿™ä¸ªæ–¹æ³•çš„æ“ä½œæ•°æ ˆæ˜¯ç©ºçš„ã€‚</p><p>æ¯ä¸€ä¸ªæ“ä½œæ•°æ ˆéƒ½ä¼šæ‹¥æœ‰ä¸€ä¸ªæ˜ç¡®çš„æ ˆæ·±åº¦ç”¨äºå­˜å‚¨æ•°å€¼ï¼Œå…¶æ‰€éœ€çš„æœ€å¤§æ·±åº¦åœ¨ç¼–è¯‘æœŸå°±å®šä¹‰å¥½äº†ï¼Œä¿å­˜åœ¨æ–¹æ³•çš„Codeå±æ€§ä¸­ï¼Œä¸ºmax_stackçš„å€¼ã€‚</p><p>æ ˆä¸­çš„ä»»ä½•ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯å¯ä»¥ä»»æ„çš„Javaæ•°æ®ç±»å‹ã€‚</p><p>32bitçš„ç±»å‹å ç”¨ä¸€ä¸ªæ ˆå•ä½æ·±åº¦</p><p>64bitçš„ç±»å‹å ç”¨ä¸¤ä¸ªæ ˆå•ä½æ·±åº¦</p><p>æ“ä½œæ•°æ ˆå¹¶éé‡‡ç”¨è®¿é—®ç´¢å¼•çš„æ–¹å¼æ¥è¿›è¡Œæ•°æ®è®¿é—®çš„ï¼Œè€Œæ˜¯åªèƒ½é€šè¿‡æ ‡å‡†çš„å…¥æ ˆ(push)å’Œå‡ºæ ˆ(pop)æ“ä½œæ¥å®Œæˆä¸€æ¬¡æ•°æ®è®¿é—®ã€‚</p><p>å¦‚æœè¢«è°ƒç”¨çš„æ–¹æ³•å¸¦æœ‰è¿”å›å€¼çš„è¯ï¼Œå…¶è¿”å›å€¼å°†ä¼šè¢«å‹å…¥å½“å‰æ ˆå¸§çš„æ“ä½œæ•°æ ˆä¸­ï¼Œå¹¶æ›´æ–°PCå¯„å­˜å™¨ä¸­ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ã€‚</p><p>æ“ä½œæ•°æ ˆä¸­å…ƒç´ çš„æ•°æ®ç±»å‹å¿…é¡»ä¸å­—èŠ‚ç æŒ‡ä»¤çš„åºåˆ—ä¸¥æ ¼åŒ¹é…ï¼Œè¿™ç”±ç¼–è¯‘å™¨åœ¨ç¼–è¯‘å™¨æœŸé—´è¿›è¡ŒéªŒè¯ï¼ŒåŒæ—¶åœ¨ç±»åŠ è½½è¿‡ç¨‹ä¸­çš„ç±»æ£€éªŒé˜¶æ®µçš„æ•°æ®æµåˆ†æé˜¶æ®µè¦å†æ¬¡éªŒè¯ã€‚</p><p>å¦å¤–ï¼Œæˆ‘ä»¬è¯´Javaè™šæ‹Ÿæœºçš„è§£é‡Šå¼•æ“æ˜¯åŸºäºæ ˆçš„æ‰§è¡Œå¼•æ“ï¼Œå…¶ä¸­çš„æ ˆæŒ‡çš„å°±æ˜¯æ“ä½œæ•°æ ˆã€‚</p><p>æ²¡æœ‰è¿”å›å€¼çš„æ“ä½œæ•°æ ˆç¤ºä¾‹ï¼š</p><p>æœ‰è¿”å›å€¼çš„æ“ä½œæ•°æ ˆç¤ºä¾‹ï¼š</p><p>i++ä¸++içš„åŒºåˆ«ï¼š</p><h3 id="æ ˆé¡¶ç¼“å­˜æŠ€æœ¯" tabindex="-1"><a class="header-anchor" href="#æ ˆé¡¶ç¼“å­˜æŠ€æœ¯" aria-hidden="true">#</a> æ ˆé¡¶ç¼“å­˜æŠ€æœ¯</h3><p>å‰è€Œæè¿‡ï¼ŒåŸºäºæ ˆå¼æ¶æ„çš„è™šæ‹Ÿæœºæ‰€ä½¿ç”¨çš„é›¶åœ°å€æŒ‡ä»¤æ›´åŠ ç´§å‡‘ï¼Œä½†å®Œæˆä¸€é¡¹æ“ä½œçš„æ—¶å€™å¿…ç„¶éœ€è¦ä½¿ç”¨æ›´å¤šçš„å…¥æ ˆå’Œå‡ºæ ˆæŒ‡ä»¤ï¼Œè¿™åŒæ—¶ä¹Ÿå°±æ„å‘³ç€å°†éœ€è¦æ›´å¤šçš„æŒ‡ä»¤åˆ†æ´¾(instruction dispatch) æ¬¡æ•°å’Œå†…å­˜è¯»/å†™æ¬¡æ•°ã€‚</p><p>ç”±äºæ“ä½œæ•°æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Œå› æ­¤é¢‘ç¹åœ°æ‰§è¡Œå†…å­˜è¯»/å†™æ“ä½œå¿…ç„¶ä¼šå½±å“æ‰§è¡Œé€Ÿåº¦ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒHotspot JVMçš„è®¾è®¡è€…ä»¬æå‡ºäº†æ ˆé¡¶ç¼“å­˜(Tosï¼Œ Top-of-Stack Cashing) æŠ€æœ¯ï¼Œå°†æ ˆé¡¶å…ƒç´ å…¨éƒ¨ç¼“å­˜åœ¨ç‰©ç†CPUçš„å¯„å­˜å™¨ä¸­ï¼Œä»¥æ­¤é™ä½å¯¹å†…å­˜çš„è¯»/å†™æ¬¡æ•°ï¼Œæå‡æ‰§è¡Œå¼•æ“çš„æ‰§è¡Œæ•ˆç‡ã€‚</p><h3 id="åŠ¨æ€é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#åŠ¨æ€é“¾æ¥" aria-hidden="true">#</a> åŠ¨æ€é“¾æ¥</h3><p>å¸§æ•°æ®åŒºï¼šæ–¹æ³•è¿”å›åœ°å€ + ä¸€äº›é™„åŠ ä¿¡æ¯</p><p>æ¯ä¸€ä¸ªæ ˆå¸§å†…éƒ¨éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± ä¸­è¯¥æ ˆå¸§æ‰€å±æ–¹æ³•çš„å¼•ç”¨åŒ…å«è¿™ä¸ªå¼•ç”¨çš„ç›®çš„å°±æ˜¯ä¸ºäº†æ”¯æŒå½“å‰æ–¹æ³•çš„ä»£ç èƒ½å¤Ÿå®ç°åŠ¨æ€é“¾æ¥(Dynamic Linking)ã€‚æ¯”å¦‚: invokedynamicæŒ‡ä»¤ã€‚</p><p>åœ¨Javaæºæ–‡ä»¶è¢«ç¼–è¯‘åˆ°å­—èŠ‚ç æ–‡ä»¶ä¸­æ—¶ï¼Œæ‰€æœ‰çš„å˜é‡å’Œæ–¹æ³•å¼•ç”¨éƒ½ä½œä¸ºç¬¦å·å¼•ç”¨(symbolic Reference) ä¿å­˜åœ¨classæ–‡ä»¶çš„å¸¸é‡æ± é‡Œã€‚</p><p>æ¯”å¦‚ï¼šæè¿°ä¸€ä¸ªæ–¹æ³•è°ƒç”¨äº†å¦å¤–çš„å…¶ä»–æ–¹æ³•æ—¶ï¼Œå°±æ˜¯é€šè¿‡å¸¸é‡æ± ä¸­æŒ‡å‘æ–¹æ³•çš„ç¬¦å·å¼•ç”¨æ¥è¡¨ç¤ºçš„ï¼Œé‚£ä¹ˆåŠ¨æ€é“¾æ¥çš„ä½œç”¨å°±æ˜¯ä¸ºäº†å°†è¿™äº›ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºè°ƒç”¨æ–¹æ³•çš„ç›´æ¥å¼•ç”¨ã€‚</p><p>å­—èŠ‚ç ä¸­çš„å¸¸é‡æ± è¿è¡Œä»¥åå°±æ”¾åœ¨æ–¹æ³•åŒºã€‚ï¼ˆè¿è¡Œæ—¶å¸¸é‡æ± ï¼‰</p><p>ä¸ºä»€ä¹ˆéœ€è¦å¸¸é‡æ± ?</p><p>å¸¸é‡æ± çš„ä½œç”¨ï¼Œå°±æ˜¯ä¸ºäº†æä¾›- -äº›ç¬¦å·å’Œå¸¸é‡ï¼Œä¾¿äºæŒ‡ä»¤çš„è¯†åˆ«ã€‚</p><h3 id="æ–¹æ³•çš„è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•çš„è°ƒç”¨" aria-hidden="true">#</a> æ–¹æ³•çš„è°ƒç”¨</h3><h4 id="åŠ¨æ€é“¾æ¥ä¸é™æ€é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#åŠ¨æ€é“¾æ¥ä¸é™æ€é“¾æ¥" aria-hidden="true">#</a> åŠ¨æ€é“¾æ¥ä¸é™æ€é“¾æ¥</h4><p>åœ¨JVMä¸­ï¼Œå°†ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºè°ƒç”¨æ–¹æ³•çš„ç›´æ¥å¼•ç”¨ä¸æ–¹æ³•çš„ç»‘å®šæœºåˆ¶ç›¸å…³ã€‚</p><p>é™æ€é“¾æ¥ï¼š</p><p>å½“ä¸€ä¸ªå­—èŠ‚ç æ–‡ä»¶è¢«è£…è½½è¿›JVMå†…éƒ¨æ—¶ï¼Œå¦‚æœè¢«è°ƒç”¨çš„ç›®æ ‡æ–¹æ³•åœ¨ç¼–è¯‘æœŸå¯çŸ¥ï¼Œä¸”è¿è¡ŒæœŸä¿æŒä¸å˜æ—¶ã€‚è¿™ç§æƒ…å†µä¸‹å°†è°ƒç”¨æ–¹æ³•çš„ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ç§°ä¹‹ä¸ºé™æ€é“¾æ¥ã€‚</p><p>åŠ¨æ€é“¾æ¥ï¼š</p><p>å¦‚æœè¢«è°ƒç”¨çš„æ–¹æ³•åœ¨ç¼–è¯‘æœŸæ— æ³•è¢«ç¡®å®šä¸‹æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªèƒ½å¤Ÿåœ¨ç¨‹åºè¿è¡Œ</p><p>æœŸå°†è°ƒç”¨æ–¹æ³•çš„ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨ï¼Œç”±äºè¿™ç§å¼•ç”¨è½¬æ¢è¿‡ç¨‹å…·å¤‡åŠ¨æ€æ€§ï¼Œå› æ­¤ä¹Ÿå°±è¢«ç§°ä¹‹ä¸ºåŠ¨æ€é“¾æ¥ã€‚</p><p>å¯¹åº”çš„æ–¹æ³•çš„ç»‘å®šæœºåˆ¶ä¸ºï¼šæ—©æœŸç»‘å®š(Early Binding) å’Œæ™šæœŸç»‘å®š(Late Binding)ã€‚ç»‘å®šæ˜¯ä¸€ä¸ªå­—æ®µã€æ–¹æ³•æˆ–è€…ç±»åœ¨ç¬¦å·å¼•ç”¨è¢«æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ï¼Œè¿™ä»…ä»…å‘ç”Ÿä¸€æ¬¡ã€‚</p><h4 id="æ—©æœŸç»‘å®šä¸æ™šæœŸç»‘å®š" tabindex="-1"><a class="header-anchor" href="#æ—©æœŸç»‘å®šä¸æ™šæœŸç»‘å®š" aria-hidden="true">#</a> æ—©æœŸç»‘å®šä¸æ™šæœŸç»‘å®š</h4><p>æ—©æœŸç»‘å®šï¼š</p><p>æ—©æœŸç»‘å®šå°±æ˜¯æŒ‡è¢«è°ƒç”¨çš„ç›®æ ‡æ–¹æ³•å¦‚æœåœ¨ç¼–è¯‘æœŸå¯çŸ¥ï¼Œä¸”è¿è¡ŒæœŸä¿æŒä¸å˜æ—¶,</p><p>å³å¯å°†è¿™ä¸ªæ–¹æ³•ä¸æ‰€å±çš„ç±»å‹è¿›è¡Œç»‘å®šï¼Œè¿™æ ·ä¸€æ¥ï¼Œç”±äºæ˜ç¡®äº†è¢«è°ƒç”¨çš„ç›®æ ‡æ–¹æ³•ç©¶ç«Ÿæ˜¯å“ª-ä¸€ä¸ªï¼Œå› æ­¤ä¹Ÿå°±å¯ä»¥ä½¿ç”¨é™æ€é“¾æ¥çš„æ–¹å¼å°†ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨ã€‚</p><p>æ™šæœŸç»‘å®šï¼š</p><p>å¦‚æœè¢«è°ƒç”¨çš„æ–¹æ³•åœ¨ç¼–è¯‘æœŸæ— æ³•è¢«ç¡®å®šä¸‹æ¥ï¼Œåªèƒ½å¤Ÿåœ¨ç¨‹åºè¿è¡ŒæœŸæ ¹æ®å®é™…çš„ç±»å‹ç»‘å®šç›¸å…³çš„æ–¹æ³•ï¼Œè¿™ç§ç»‘å®šæ–¹å¼ä¹Ÿå°±è¢«ç§°ä¹‹ä¸ºæ™šæœŸç»‘å®šã€‚</p><p>éšç€é«˜çº§è¯­è¨€çš„æ¨ªç©ºå‡ºä¸–ï¼Œç±»ä¼¼äºJava-æ ·çš„åŸºäºé¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€å¦‚ä»Š</p><p>è¶Šæ¥è¶Šå¤šï¼Œå°½ç®¡è¿™ç±»ç¼–ç¨‹è¯­è¨€åœ¨è¯­æ³•é£æ ¼ä¸Šå­˜åœ¨ä¸€å®šçš„å·®åˆ«ï¼Œä½†æ˜¯å®ƒä»¬å½¼æ­¤ä¹‹é—´å§‹ç»ˆä¿æŒç€ä¸€ä¸ªå…±æ€§ï¼Œé‚£å°±æ˜¯éƒ½æ”¯æŒå°è£…ã€ç»§æ‰¿å’Œå¤šæ€ç­‰é¢å‘å¯¹è±¡ç‰¹æ€§, æ—¢ç„¶è¿™ä¸€ç±»çš„ç¼–ç¨‹è¯­è¨€å…·å¤‡å¤šæ€ç‰¹æ€§ï¼Œé‚£ä¹ˆè‡ªç„¶ä¹Ÿå°±å…·å¤‡æ—©æœŸç»‘å®šå’Œæ™šæœŸç»‘å®šä¸¤ç§ç»‘å®šæ–¹å¼ã€‚</p><p>Javaä¸­ä»»ä½•ä¸€ä¸ªæ™®é€šçš„æ–¹æ³•å…¶å®éƒ½å…·å¤‡è™›å‡½æ•°çš„ç‰¹å¾ï¼Œå®ƒä»¬ç›¸å½“äºC++è¯­è¨€</p><p>ä¸­çš„è™šå‡½æ•°(C++ä¸­åˆ™éœ€è¦ä½¿ç”¨å…³é”®å­—virtualæ¥æ˜¾å¼å®šä¹‰)ã€‚å¦‚æœåœ¨Javaç¨‹åºä¸­ä¸å¸Œæœ›æŸä¸ªæ–¹æ³•æ‹¥æœ‰è™šå‡½æ•°çš„ç‰¹å¾æ—¶ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å…³é”®å­—finalæ¥æ ‡ï¼Œè®°è¿™ä¸ªæ–¹æ³•ã€‚</p><h4 id="è™šæ–¹æ³•ä¸éè™šæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#è™šæ–¹æ³•ä¸éè™šæ–¹æ³•" aria-hidden="true">#</a> è™šæ–¹æ³•ä¸éè™šæ–¹æ³•</h4><p>éè™šæ–¹æ³•ï¼š</p><p>å¦‚æœæ–¹æ³•åœ¨ç¼–è¯‘æœŸå°±ç¡®å®šäº†å…·ä½“çš„è°ƒç”¨ç‰ˆæœ¬ï¼Œè¿™ä¸ªç‰ˆæœ¬åœ¨è¿è¡Œæ—¶æ˜¯ä¸å¯å˜çš„ã€‚</p><p>è¿™æ ·çš„æ–¹æ³•ç§°ä¸ºéè™šæ–¹æ³•ã€‚</p><p>é™æ€æ–¹æ³•ã€ç§æœ‰æ–¹æ³•ã€finalæ–¹æ³•ã€å®ä¾‹æ„é€ å™¨ã€çˆ¶ç±»æ–¹æ³•éƒ½æ˜¯éè™šæ–¹æ³•ã€‚</p><p>å…¶ä»–æ–¹æ³•ç§°ä¸ºè™šæ–¹æ³•ã€‚</p><p>è™šæ‹Ÿæœºä¸­æä¾›äº†ä»¥ä¸‹å‡ æ¡æ–¹æ³•è°ƒç”¨æŒ‡ä»¤ï¼š</p><p>æ™®é€šè°ƒç”¨æŒ‡ä»¤ï¼š</p><p>\1. invokestatic: è°ƒç”¨é™æ€æ–¹æ³•ï¼Œè§£æé˜¶æ®µç¡®å®šå”¯ä¸€æ–¹æ³•ç‰ˆæœ¬</p><p>\2. invokespecial: è°ƒç”¨&lt;init&gt;æ–¹æ³•ã€ç§æœ‰åŠçˆ¶ç±»æ–¹æ³•ï¼Œè§£æé˜¶æ®µç¡®å®šå”¯ä¸€æ–¹æ³•ç‰ˆæœ¬</p><p>\3. invokevirtual: è°ƒç”¨æ‰€æœ‰è™šæ–¹æ³•</p><p>\4. invokeinterface: è°ƒç”¨æ¥å£æ–¹æ³•</p><p>åŠ¨æ€è°ƒç”¨æŒ‡ä»¤ï¼š</p><p>\5. invokedynamic: åŠ¨æ€è§£æå‡ºéœ€è¦è°ƒç”¨çš„æ–¹æ³•ï¼Œç„¶åæ‰§è¡Œ</p><p>å‰å››æ¡æŒ‡ä»¤å›ºåŒ–åœ¨è™šæ‹Ÿæœºå†…éƒ¨ï¼Œæ–¹æ³•çš„è°ƒç”¨æ‰§è¡Œä¸å¯äººä¸ºå¹²é¢„ï¼Œè€ŒinvokedynamicæŒ‡ä»¤åˆ™æ”¯æŒç”±ç”¨æˆ·ç¡®å®šæ–¹æ³•ç‰ˆæœ¬ã€‚å…¶ä¸­invokestaticæŒ‡ä»¤å’ŒinvokespecialæŒ‡ä»¤è°ƒç”¨çš„æ–¹æ³•ç§°ä¸ºéè™šæ–¹æ³•ï¼Œå…¶ä½™çš„(finalä¿®é¥°çš„é™¤å¤–)ç§°ä¸ºè™šæ–¹æ³•ã€‚</p><p>å…³äºinvokedynamicæŒ‡ä»¤</p><p>JVMå­—èŠ‚ç æŒ‡ä»¤é›†ä¸€ç›´æ¯”è¾ƒç¨³å®šï¼Œä¸€ç›´åˆ°Java7ä¸­æ‰å¢åŠ äº†ä¸€ä¸ªinvokedynamicæŒ‡ä»¤ï¼Œè¿™æ˜¯Javaä¸ºäº†å®ç°ã€åŠ¨æ€ç±»å‹è¯­è¨€ã€‘æ”¯æŒè€Œåšçš„ä¸€ç§æ”¹è¿›ã€‚</p><p>ä½†æ˜¯åœ¨Java7ä¸­å¹¶æ²¡æœ‰æä¾›ç›´æ¥ç”ŸæˆinvokedynamicæŒ‡ä»¤çš„æ–¹æ³•ï¼Œéœ€è¦å€ŸåŠ©ASMè¿™ç§åº•å±‚å­—èŠ‚ç å·¥å…·æ¥äº§ç”ŸinvokedynamicæŒ‡ä»¤ã€‚ç›´åˆ°Java8çš„Lambdaè¡¨è¾¾å¼çš„å‡ºç°ï¼ŒinvokedynamicæŒ‡ä»¤çš„ç”Ÿæˆï¼Œåœ¨Javaä¸­æ‰æœ‰äº†ç›´æ¥çš„ç”Ÿæˆæ–¹å¼ã€‚</p><p>Java7ä¸­å¢åŠ çš„åŠ¨æ€è¯­è¨€ç±»å‹æ”¯æŒçš„æœ¬è´¨æ˜¯å¯¹Javaè™šæ‹Ÿæœºè§„èŒƒçš„ä¿®æ”¹ï¼Œè€Œä¸æ˜¯å¯¹Javaè¯­è¨€è§„åˆ™çš„ä¿®æ”¹ï¼Œè¿™ä¸€å—ç›¸å¯¹æ¥è®²æ¯”è¾ƒå¤æ‚ï¼Œå¢åŠ äº†è™šæ‹Ÿæœºä¸­çš„æ–¹æ³•è°ƒç”¨ï¼Œæœ€ç›´æ¥çš„å—ç›Šè€…å°±æ˜¯è¿è¡Œåœ¨Javaå¹³å°çš„åŠ¨æ€è¯­è¨€çš„ç¼–è¯‘å™¨ã€‚</p><p>åŠ¨æ€ç±»å‹è¯­è¨€å’Œé™æ€ç±»å‹è¯­è¨€ï¼š</p><p>åŠ¨æ€ç±»å‹è¯­è¨€å’Œé™æ€ç±»å‹è¯­è¨€ä¸¤è€…çš„åŒºåˆ«å°±åœ¨äºå¯¹ç±»å‹çš„æ£€æŸ¥æ˜¯åœ¨ç¼–è¯‘æœŸè¿˜æ˜¯åœ¨è¿è¡ŒæœŸï¼Œæ»¡è¶³å‰è€…å°±æ˜¯é™æ€ç±»å‹è¯­è¨€ï¼Œåä¹‹æ˜¯åŠ¨æ€ç±»å‹è¯­è¨€ã€‚</p><p>è¯´çš„å†ç›´ç™½ä¸€ç‚¹å°±æ˜¯ï¼Œé™æ€ç±»å‹è¯­è¨€æ˜¯åˆ¤æ–­å˜é‡è‡ªèº«çš„ç±»å‹ä¿¡æ¯ï¼›åŠ¨æ€ç±»å‹</p><p>è¯­è¨€æ˜¯åˆ¤æ–­å˜é‡å€¼çš„ç±»å‹ä¿¡æ¯ï¼Œå˜é‡æ²¡æœ‰ç±»å‹ä¿¡æ¯ï¼Œå˜é‡å€¼æ‰æœ‰ç±»å‹ä¿¡æ¯ï¼Œ</p><p>è¿™æ˜¯åŠ¨æ€è¯­è¨€çš„ä¸€ä¸ªé‡è¦ç‰¹å¾ã€‚</p><p>Javaæ˜¯é™æ€ç±»å‹è¯­è¨€</p><h4 id="æ–¹æ³•é‡å†™çš„æœ¬è´¨ä¸è™šæ–¹æ³•è¡¨çš„ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•é‡å†™çš„æœ¬è´¨ä¸è™šæ–¹æ³•è¡¨çš„ä½¿ç”¨" aria-hidden="true">#</a> æ–¹æ³•é‡å†™çš„æœ¬è´¨ä¸è™šæ–¹æ³•è¡¨çš„ä½¿ç”¨</h4><p>Javaè¯­è¨€ä¸­æ–¹æ³•é‡å†™çš„æœ¬è´¨ï¼š</p><p>\1. æ‰¾åˆ°æ“ä½œæ•°æ ˆé¡¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ‰€æ‰§è¡Œçš„å¯¹è±¡çš„å®é™…ç±»å‹ï¼Œè®°ä½œCã€‚</p><p>\2. å¦‚æœåœ¨ç±»å‹ä¸­æ‰¾åˆ°ä¸å¸¸é‡ä¸­çš„æè¿°ç¬¦åˆç®€å•åç§°éƒ½ç›¸ç¬¦çš„æ–¹æ³•ï¼Œåˆ™è¿›è¡Œè®¿é—®æƒé™æ¾éªŒï¼Œå¦‚æœé€šè¿‡åˆ™è¿”å›è¿™ä¸ªæ–¹æ³•çš„ç›´æ¥å¼•ç”¨ï¼ŒæŸ¥æ‰¾è¿‡ç¨‹ç»“æŸï¼›å¦‚æœä¸é€šè¿‡ï¼Œåˆ™è¿”å›java.lang.IllegalAccessErrorå¼‚å¸¸ã€‚</p><p>\3. å¦åˆ™ï¼ŒæŒ‰ç…§ç»§æ‰¿å…³ç³»ä»ä¸‹å¾€ä¸Šä¾æ¬¡å¯¹Cçš„å„ä¸ªçˆ¶ç±»è¿›è¡Œç¬¬2æ­¥çš„æœç´¢å’ŒéªŒè¯è¿‡ç¨‹ã€‚</p><p>\4. å¦‚æœå§‹ç»ˆæ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„æ–¹æ³•ï¼Œåˆ™æŠ›å‡ºjava.lang.AbstractMethodErrorå¼‚å¸¸ã€‚</p><p>IllegalAccessErrorä»‹ç»ï¼š</p><p>ç¨‹åºè¯•å›¾è®¿é—®æˆ–ä¿®æ”¹ä¸€ä¸ªå±æ€§æˆ–è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªå±æ€§æˆ–æ–¹æ³•ï¼Œä½ æ²¡æœ‰æƒé™è®¿é—®ã€‚ä¸€èˆ¬çš„ï¼Œè¿™ä¸ªä¼šå¼•èµ·ç¼–è¯‘å™¨å¼‚å¸¸ã€‚è¿™ä¸ªé”™è¯¯å¦‚æœå‘ç”Ÿåœ¨è¿è¡Œæ—¶ï¼Œå°±è¯´æ˜ä¸€ä¸ªç±»å‘ç”Ÿäº†ä¸å…¼å®¹çš„æ”¹å˜ã€‚</p><p>ã€åœ¨å­ç±»å¯¹è±¡ä¸­æ‰¾åˆ°ä¸å¸¸é‡ä¸­æè¿°ç›¸ç¬¦çš„æ–¹æ³•ï¼Œåˆ™è¿›è¡Œæƒé™æ ¡éªŒã€‘</p><p>åœ¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ä¸­ï¼Œä¼šå¾ˆé¢‘ç¹çš„ä½¿ç”¨åˆ°åŠ¨æ€åˆ†æ´¾ï¼Œå¦‚æœåœ¨æ¯æ¬¡åŠ¨æ€åˆ†æ´¾çš„è¿‡ç¨‹ä¸­éƒ½è¦é‡æ–°åœ¨ç±»çš„æ–¹æ³•å…ƒæ•°æ®ä¸­æœç´¢åˆé€‚çš„ç›®æ ‡çš„è¯å°±å¯èƒ½å½±å“åˆ°æ‰§è¡Œæ•ˆç‡ã€‚å› æ­¤ï¼Œä¸ºäº†æé«˜æ€§èƒ½ï¼ŒJVMé‡‡ç”¨åœ¨ç±»çš„æ–¹æ³•åŒºå»ºç«‹ä¸€ä¸ªè™šæ–¹æ³•è¡¨(virtual method table) (éè™šæ–¹æ³•ä¸ä¼šå‡ºç°åœ¨è¡¨ä¸­)æ¥å®ç°ã€‚ä½¿ç”¨ç´¢å¼•è¡¨æ¥ä»£æ›¿æŸ¥æ‰¾ã€‚</p><p>æ¯ä¸ªç±»ä¸­éƒ½æœ‰ä¸€ä¸ªè™šæ–¹æ³•è¡¨ï¼Œè¡¨ä¸­å­˜æ”¾ç€å„ä¸ªæ–¹æ³•çš„å®é™…å…¥å£ã€‚</p><p>é‚£ä¹ˆè™šæ–¹æ³•è¡¨ä»€ä¹ˆæ—¶å€™è¢«åˆ›å»º?</p><p>è™šæ–¹æ³•è¡¨ä¼šåœ¨ç±»åŠ è½½çš„é“¾æ¥é˜¶æ®µè¢«åˆ›å»ºå¹¶å¼€å§‹åˆå§‹åŒ–ï¼Œç±»çš„å˜é‡åˆå§‹å€¼å‡†å¤‡å®Œæˆä¹‹åï¼ŒJVMä¼šæŠŠè¯¥ç±»çš„æ–¹æ³•è¡¨ä¹Ÿåˆå§‹åŒ–å®Œæ¯•ã€‚</p><h3 id="æ–¹æ³•è¿”å›åœ°å€" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•è¿”å›åœ°å€" aria-hidden="true">#</a> æ–¹æ³•è¿”å›åœ°å€</h3><p>å­˜æ”¾è°ƒç”¨è¯¥æ–¹æ³•çš„pcå¯„å­˜å™¨çš„å€¼ã€‚</p><p>ä¸€ä¸ªæ–¹æ³•çš„ç»“æŸï¼Œæœ‰ä¸¤ç§æ–¹å¼:</p><p>æ­£å¸¸æ‰§è¡Œå®Œæˆ</p><p>å‡ºç°æœªå¤„ç†çš„å¼‚å¸¸ï¼Œéæ­£å¸¸é€€å‡º</p><p>æ— è®ºé€šè¿‡å“ªç§æ–¹å¼é€€å‡ºï¼Œåœ¨æ–¹æ³•é€€å‡ºåéƒ½è¿”å›åˆ°è¯¥æ–¹æ³•è¢«è°ƒç”¨çš„ä½ç½®ã€‚æ–¹æ³•æ­£å¸¸é€€å‡ºæ—¶ï¼Œè°ƒç”¨è€…çš„pcè®¡æ•°å™¨çš„å€¼ä½œä¸ºè¿”å›åœ°å€ï¼Œå³è°ƒç”¨è¯¥æ–¹æ³•çš„æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ã€‚è€Œé€šè¿‡å¼‚å¸¸é€€å‡ºçš„ï¼Œè¿”å›åœ°å€æ˜¯è¦é€šè¿‡å¼‚å¸¸è¡¨æ¥ç¡®å®šï¼Œæ ˆå¸§ä¸­ä¸€èˆ¬ä¸ä¼šä¿å­˜è¿™éƒ¨åˆ†ä¿¡æ¯ã€‚</p><p>å½“ä¸€ä¸ªæ–¹æ³•å¼€å§‹æ‰§è¡Œåï¼Œåªæœ‰ä¸¤ç§æ–¹å¼å¯ä»¥é€€å‡ºè¿™ä¸ªæ–¹æ³•ï¼š</p><p>1ã€æ‰§è¡Œå¼•æ“é‡åˆ°ä»»æ„ä¸€ä¸ªæ–¹æ³•è¿”å›çš„å­—èŠ‚ç æŒ‡ä»¤(return) ï¼Œä¼šæœ‰è¿”å›å€¼ä¼ é€’ç»™ä¸Šå±‚çš„æ–¹æ³•è°ƒç”¨è€…ï¼Œç®€ç§°æ­£å¸¸å®Œæˆå‡ºå£ï¼š</p><ol><li><p>ä¸€ä¸ªæ–¹æ³•åœ¨æ­£å¸¸è°ƒç”¨å®Œæˆä¹‹åç©¶ç«Ÿéœ€è¦ä½¿ç”¨å“ªä¸ªè¿”å›æŒ‡ä»¤è¿˜éœ€è¦æ ¹æ®æ–¹æ³•è¿”å›å€¼çš„å®é™…æ•°æ®ç±»å‹è€Œå®šã€‚</p></li><li><p>åœ¨å­—èŠ‚ç æŒ‡ä»¤ä¸­ï¼Œè¿”å›æŒ‡ä»¤åŒ…å«ireturn (å½“è¿”å›å€¼æ˜¯booleanã€ byteã€ charã€</p></li></ol><p>shortå’Œintç±»å‹æ—¶ä½¿ç”¨)ã€lreturnã€freturnã€dreturnä»¥åŠareturnï¼ˆå¼•ç”¨åœ°å€ï¼‰ï¼Œå¦å¤–è¿˜æœ‰ä¸€ä¸ªreturnæŒ‡ä»¤ä¾›å£°æ˜ä¸ºvoidçš„æ–¹æ³•ã€å®ä¾‹åˆå§‹åŒ–æ–¹æ³•ã€ç±»å’Œæ¥å£çš„åˆå§‹åŒ–æ–¹æ³•ä½¿ç”¨ã€‚</p><p>2ã€åœ¨æ–¹æ³•æ‰§è¡Œçš„è¿‡ç¨‹ä¸­é‡åˆ°äº†å¼‚å¸¸(Exception)ï¼Œå¹¶ä¸”è¿™ä¸ªå¼‚å¸¸æ²¡æœ‰åœ¨æ–¹æ³•å†…è¿›è¡Œå¤„ç†ï¼Œä¹Ÿå°±æ˜¯åªè¦åœ¨æœ¬æ–¹æ³•çš„å¼‚å¸¸è¡¨ä¸­æ²¡æœ‰æœç´¢åˆ°åŒ¹é…çš„å¼‚å¸¸å¤„ç†å™¨ï¼Œå°±ä¼šå¯¼è‡´æ–¹æ³•é€€å‡ºã€‚ç®€ç§°å¼‚å¸¸å®Œæˆå‡ºå£ã€‚</p><p>æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºå¼‚å¸¸æ—¶çš„å¼‚å¸¸å¤„ç†ï¼Œå­˜å‚¨åœ¨ä¸€ä¸ªå¼‚å¸¸å¤„ç†è¡¨ï¼Œæ–¹ä¾¿åœ¨å‘ç”Ÿå¼‚å¸¸çš„æ—¶å€™æ‰¾åˆ°å¤„ç†å¼‚å¸¸çš„ä»£ç ã€‚</p><p>ã€å­—èŠ‚ç æŒ‡ä»¤ä»4åˆ°8å‡ºç°å¼‚å¸¸è·³è½¬è‡³11è¿›è¡Œå¤„ç†ã€‘</p><p>æœ¬è´¨ä¸Šï¼Œæ–¹æ³•çš„é€€å‡ºå°±æ˜¯å½“å‰æ ˆå¸§å‡ºæ ˆçš„è¿‡ç¨‹ã€‚æ­¤æ—¶ï¼Œéœ€è¦æ¢å¤ä¸Šå±‚æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€å°†è¿”å›å€¼å‹å…¥è°ƒç”¨è€…æ ˆå¸§çš„æ“ä½œæ•°æ ˆã€è®¾ç½®PCå¯„å­˜å™¨å€¼ç­‰ï¼Œè®©è°ƒç”¨è€…æ–¹æ³•ç»§ç»­æ‰§è¡Œä¸‹å»ã€‚</p><p>æ­£å¸¸å®Œæˆå‡ºå£å’Œå¼‚å¸¸å®Œæˆå‡ºå£çš„åŒºåˆ«åœ¨äºï¼šé€šè¿‡å¼‚å¸¸å®Œæˆå‡ºå£é€€å‡ºçš„ä¸ä¼šç»™ä»–çš„ä¸Šå±‚è°ƒç”¨è€…äº§ç”Ÿä»»ä½•çš„è¿”å›å€¼ã€‚</p><h3 id="ä¸€äº›é™„åŠ ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#ä¸€äº›é™„åŠ ä¿¡æ¯" aria-hidden="true">#</a> ä¸€äº›é™„åŠ ä¿¡æ¯</h3><p>æ ˆå¸§ä¸­è¿˜å…è®¸æºå¸¦ä¸Javaè™šæ‹Ÿæœºå®ç°ç›¸å…³çš„ä¸€äº›é™„åŠ ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œå¯¹ç¨‹åºè°ƒè¯•æä¾›æ”¯æŒçš„ä¿¡æ¯ã€‚</p><h3 id="ç›¸å…³5ä¸ªé—®é¢˜" tabindex="-1"><a class="header-anchor" href="#ç›¸å…³5ä¸ªé—®é¢˜" aria-hidden="true">#</a> ç›¸å…³5ä¸ªé—®é¢˜</h3><p>\1. è®¾ç½®æ ˆçš„å¤§å°</p><p>é€šè¿‡-Xssè®¾ç½®å¤§å°</p><p>\2. è°ƒæ•´æ ˆçš„å¤§å°ï¼Œå°±èƒ½ä¿è¯ä¸å‡ºç°æº¢å‡ºå—ï¼Ÿ</p><p>ä¸èƒ½ï¼Œå¾€å°çš„è°ƒã€‚</p><p>\3. åˆ†é…çš„æ ˆå†…å­˜è¶Šå¤§è¶Šå¥½å—ï¼Ÿ</p><p>ä¸æ˜¯ï¼Œå¤§å°±ä¼šå ç”¨å…¶ä»–çš„è¿›ç¨‹</p><p>\4. åƒåœ¾å›æ”¶æ˜¯å¦ä¼šæ¶‰åŠè™šæ‹Ÿæœºæ ˆï¼Ÿ</p><p>ä¸ä¼šã€‚</p><table><thead><tr><th></th><th>OOM</th><th>GC</th></tr></thead><tbody><tr><td>PCå¯„å­˜å™¨</td><td>æ²¡æœ‰</td><td>æ²¡æœ‰</td></tr><tr><td>è™šæ‹Ÿæœºæ ˆ</td><td>æœ‰</td><td>æ²¡æœ‰</td></tr><tr><td>æœ¬åœ°æ–¹æ³•æ ˆ</td><td>æœ‰</td><td>æ²¡æœ‰</td></tr><tr><td>å †</td><td>æœ‰</td><td>æœ‰</td></tr><tr><td>æ–¹æ³•åŒº</td><td>æœ‰</td><td>æœ‰</td></tr></tbody></table><p>\1. æ–¹æ³•ä¸­å®šä¹‰çš„å±€éƒ¨å˜é‡æ˜¯å¦ä¸€å®šçº¿ç¨‹å®‰å…¨</p><h2 id="æœ¬åœ°æ–¹æ³•æ¥å£-java-method-interface" tabindex="-1"><a class="header-anchor" href="#æœ¬åœ°æ–¹æ³•æ¥å£-java-method-interface" aria-hidden="true">#</a> æœ¬åœ°æ–¹æ³•æ¥å£ï¼ˆJava Method Interfaceï¼‰</h2><p>ä»€ä¹ˆæ˜¯æœ¬åœ°æ–¹æ³•?</p><p>ç®€å•åœ°è®²ï¼Œä¸€ä¸ªNative Methodå°±æ˜¯ä¸€ä¸ªJavaè°ƒç”¨éJavaä»£ç çš„æ¥å£ã€‚ä¸€ä¸ªNative Methodæ˜¯è¿™æ ·ä¸€ä¸ªJavaæ–¹æ³•:è¯¥æ–¹æ³•çš„å®ç°ç”±éJavaè¯­è¨€å®ç°ï¼Œæ¯”å¦‚</p><p>Cã€‚è¿™ä¸ªç‰¹å¾å¹¶éJavaæ‰€ç‰¹æœ‰ï¼Œå¾ˆå¤šå…¶å®ƒçš„ç¼–ç¨‹è¯­è¨€éƒ½æœ‰è¿™ä¸€æœºåˆ¶ï¼Œæ¯”å¦‚åœ¨C++ä¸­ï¼Œä½ å¯ä»¥ç”¨extern &quot;C&quot; å‘ŠçŸ¥C++ç¼–è¯‘å™¨å»è°ƒç”¨ä¸€ä¸ªCçš„å‡½æ•°ã€‚</p><p>&quot;A native method is a Java method whose implementation is provided by non-java code.&quot;</p><p>åœ¨å®šä¹‰ä¸€ä¸ªnative methodæ—¶ï¼Œå¹¶ä¸æä¾›å®ç°ä½“(æœ‰äº›åƒå®šä¹‰ä¸€ä¸ªJava interface)ï¼Œå› ä¸ºå…¶å®ç°ä½“æ˜¯ç”±éjavaè¯­è¨€åœ¨å¤–é¢å®ç°çš„ã€‚</p><p>æœ¬åœ°æ¥å£çš„ä½œç”¨æ˜¯èåˆä¸åŒçš„ç¼–ç¨‹è¯­è¨€ä¸ºJavaæ‰€ç”¨ï¼Œå®ƒçš„åˆè¡·æ˜¯èåˆC/C++ç¨‹åºã€‚</p><h2 id="æœ¬åœ°æ–¹æ³•æ ˆ-native-method-stack" tabindex="-1"><a class="header-anchor" href="#æœ¬åœ°æ–¹æ³•æ ˆ-native-method-stack" aria-hidden="true">#</a> æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰</h2><p>Javaè™šæ‹Ÿæœºæ ˆç”¨äºç®¡ç†Javaæ–¹æ³•çš„è°ƒç”¨ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆç”¨äºç®¡ç†æœ¬åœ°æ–¹æ³•</p><p>çš„è°ƒç”¨ã€‚</p><p>æœ¬åœ°æ–¹æ³•æ ˆï¼Œä¹Ÿæ˜¯çº¿ç¨‹ç§æœ‰çš„ã€‚</p><p>å…è®¸è¢«å®ç°æˆå›ºå®šæˆ–è€…æ˜¯å¯åŠ¨æ€æ‰©å±•çš„å†…å­˜å¤§å°ã€‚(åœ¨å†…å­˜æº¢å‡ºæ–¹é¢æ˜¯ç›¸åŒçš„)</p><p>Ã˜ å¦‚æœçº¿ç¨‹è¯·æ±‚åˆ†é…çš„æ ˆå®¹é‡è¶…è¿‡æœ¬åœ°æ–¹æ³•æ ˆå…è®¸çš„æœ€å¤§å®¹é‡ï¼ŒJavaè™šæ‹Ÿæœºå°†ä¼šæŠ›å‡ºä¸€ä¸ªstackoverflowError å¼‚å¸¸ã€‚</p><p>Ã˜ å¦‚æœæœ¬åœ°æ–¹æ³•æ ˆå¯ä»¥åŠ¨æ€æ‰©å±•ï¼Œå¹¶ä¸”åœ¨å°è¯•æ‰©å±•çš„æ—¶å€™æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜ï¼Œæˆ–è€…åœ¨åˆ›å»ºæ–°çš„çº¿ç¨‹æ—¶æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜å»åˆ›å»ºå¯¹åº”çš„æœ¬åœ°æ–¹æ³•æ ˆï¼Œé‚£ä¹ˆJavaè™šæ‹Ÿæœºå°†ä¼šæŠ›å‡ºä¸€ä¸ªoutofMemoryError å¼‚å¸¸ã€‚</p><p>æœ¬åœ°æ–¹æ³•æ˜¯ä½¿ç”¨Cè¯­è¨€å®ç°çš„ã€‚</p><p>å®ƒçš„å…·ä½“åšæ³•æ˜¯Native Method stackä¸­ç™»è®°nativeæ–¹æ³•ï¼Œåœ¨Execution Engineæ‰§è¡Œæ—¶åŠ è½½æœ¬åœ°æ–¹æ³•åº“ã€‚</p><p>å½“æŸä¸ªçº¿ç¨‹è°ƒç”¨ä¸€ä¸ªæœ¬åœ°æ–¹æ³•æ—¶ï¼Œå®ƒå°±è¿›å…¥äº†ä¸€ä¸ªå…¨æ–°çš„å¹¶ä¸”ä¸å†å—è™šæ‹Ÿ</p><p>æœºé™åˆ¶çš„ä¸–ç•Œã€‚å®ƒå’Œè™šæ‹Ÿæœºæ‹¥æœ‰åŒæ ·çš„æƒé™ã€‚</p><p>Ã˜ æœ¬åœ°æ–¹æ³•å¯ä»¥é€šè¿‡æœ¬åœ°æ–¹æ³•æ¥å£æ¥è®¿é—®è™šæ‹Ÿæœºå†…éƒ¨çš„è¿è¡Œæ—¶æ•°æ®åŒºã€‚</p><p>Ã˜ å®ƒç”šè‡³å¯ä»¥ç›´æ¥ä½¿ç”¨æœ¬åœ°å¤„ç†å™¨ä¸­çš„å¯„å­˜å™¨</p><p>Ã˜ ç›´æ¥ä»æœ¬åœ°å†…å­˜çš„å †ä¸­åˆ†é…ä»»æ„æ•°é‡çš„å†…å­˜ã€‚</p><p>å¹¶ä¸æ˜¯æ‰€æœ‰çš„JVMéƒ½æ”¯æŒæœ¬åœ°æ–¹æ³•ã€‚å› ä¸ºJavaè™šæ‹Ÿæœºè§„èŒƒå¹¶æ²¡æœ‰æ˜ç¡®è¦æ±‚</p><p>æœ¬åœ°æ–¹æ³•æ ˆçš„ä½¿ç”¨è¯­è¨€ã€å…·ä½“å®ç°æ–¹å¼ã€æ•°æ®ç»“æ„ç­‰ã€‚å¦‚æœJVMäº§å“ä¸æ‰“ç®—æ”¯æŒnativeæ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ— éœ€å®ç°æœ¬åœ°æ–¹æ³•æ ˆã€‚</p><p>åœ¨Hotspot JVMä¸­ï¼Œ ç›´æ¥å°†æœ¬åœ°æ–¹æ³•æ ˆå’Œè™šæ‹Ÿæœºæ ˆåˆäºŒä¸ºä¸€ã€‚</p><h2 id="å †" tabindex="-1"><a class="header-anchor" href="#å †" aria-hidden="true">#</a> å †</h2><h3 id="å †çš„æ ¸å¿ƒæè¿°" tabindex="-1"><a class="header-anchor" href="#å †çš„æ ¸å¿ƒæè¿°" aria-hidden="true">#</a> å †çš„æ ¸å¿ƒæè¿°</h3><ol><li><p>ä¸€ä¸ªJVMå®ä¾‹åªå­˜åœ¨ä¸€ä¸ªå †å†…å­˜ï¼Œå †ä¹Ÿæ˜¯ Java å†…å­˜ç®¡ç†çš„æ ¸å¿ƒåŒºåŸŸã€‚</p></li><li><p>Java å †åŒºåœ¨ JVM å¯åŠ¨çš„æ—¶å€™å³è¢«åˆ›å»ºï¼Œå…¶ç©ºé—´å¤§å°ä¹Ÿå°±ç¡®å®šäº†ã€‚æ˜¯ JVM ç®¡ç†çš„æœ€å¤§ä¸€å—å†…å­˜ç©ºé—´ã€‚</p></li><li><p>å †å†…å­˜çš„å¤§å°æ˜¯å¯ä»¥è°ƒèŠ‚çš„ã€‚</p></li><li><p>ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹è§„å®šï¼Œå †å¯ä»¥å¤„äºç‰©ç†ä¸Šä¸è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­ï¼Œä½†åœ¨é€»è¾‘ä¸Šå®ƒåº”è¯¥è¢«è§†ä¸ºè¿ç»­çš„ã€‚</p></li><li><p><strong>æ‰€æœ‰çš„çº¿ç¨‹å…±äº«Javaå †ï¼Œå…±äº«æ•°æ®å¹¶å‘æ€§ä¸å¥½ï¼Œå› æ­¤åœ¨è¿™é‡Œè¿˜å¯ä»¥åˆ’åˆ†çº¿ç¨‹ç§æœ‰çš„ç¼“å†²åŒºï¼ˆThread Local Allocation Buffer, TLAB ã€‚</strong></p></li></ol><p><strong>ï¼ˆå³å †ä¸æ˜¯å…¨éƒ¨å…±äº«çš„ï¼‰</strong></p><p>â€‹ <strong>è®¾ç½®å †å†…å­˜ï¼šåˆå§‹ï¼ˆ-Xms20mï¼‰æœ€å¤§ï¼ˆ-Xmx20mï¼‰</strong></p><p>Ideaä¸­åœ¨vm options ä¸­è®¾ç½® -Xms å’Œ -Xmxï¼Œè¿è¡Œç¨‹åºï¼Œä½¿ç”¨ Jdk è‡ªå¸¦çš„ jvisualvm.exe æŸ¥çœ‹å †å†…å­˜çš„å¤§å°ã€‚</p><p>ç¤ºä¾‹ï¼šæ¯ä¸ªè¿›ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„ä¸€ä»½å †ç©ºé—´ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * å †å†…å­˜å¤§å°è®¾ç½®ï¼š
 * -Xms10m -Xmx10m
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HeadDemo01</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;start...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;shutdown....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * å †å†…å­˜å¤§å°è®¾ç½®ï¼š
 * -Xms15m -Xmx15m
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HeadDemo02</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;start...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;shutdown....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨ Jdk è‡ªå¸¦çš„ jvisualvm.exe æŸ¥çœ‹å †å†…å­˜çš„å¤§å°ï¼š</p><p>ã€æ³¨æ„ï¼šä½¿ç”¨ç®¡ç†å‘˜æƒé™è¿è¡Œï¼Œå¦åˆ™ä¼šæŠ¥ï¼š jvisualvm æ— æ³•æ£€æµ‹åˆ°æœ¬åœ°javaåº”ç”¨ç¨‹åºã€‘</p><figure><img src="/assets/ä½¿ç”¨jvisualvmæŸ¥çœ‹å †å†…å­˜å¤§å°-ff876bf4.png" alt="ä½¿ç”¨jvisualvmæŸ¥çœ‹å †å†…å­˜å¤§å°.png" tabindex="0" loading="lazy"><figcaption>ä½¿ç”¨jvisualvmæŸ¥çœ‹å †å†…å­˜å¤§å°.png</figcaption></figure><ol start="6"><li>ã€ŠJavaè™›æ‹Ÿæœºè§„èŒƒã€‹ä¸­å¯¹ Java å †çš„æè¿°æ˜¯ï¼š<strong>æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹ä»¥åŠæ•°ç»„éƒ½åº”å½“åœ¨è¿è¡Œæ—¶åˆ†é…åœ¨å †ä¸Š</strong>ã€‚(The heap is the run-time data area from which memory for all cla3s instances and arrays is allocated )</li></ol><p>æ³¨æ„: â€œå‡ ä¹â€æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜ã€‚â€”â€”ä»å®é™…ä½¿ç”¨è§’åº¦çœ‹çš„ã€‚</p><ol start="7"><li><strong>æ•°ç»„å’Œå¯¹è±¡å¯èƒ½æ°¸è¿œä¸ä¼šå­˜å‚¨åœ¨æ ˆä¸Šï¼Œå› ä¸ºæ ˆå¸§ä¸­ä¿å­˜å¼•ç”¨ï¼Œè¿™ä¸ªå¼•ç”¨æŒ‡å‘å¯¹è±¡æˆ–è€…æ•°ç»„åœ¨å †ä¸­çš„ä½ç½®ã€‚</strong></li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * å¯¹è±¡å¼•ç”¨æ¶ˆå¤±ï¼Œå †é‡Œé¢çš„å¯¹è±¡ä¸ä¼šç«‹å³GC
 * å¦‚æœGCè¿‡äºé¢‘ç¹ï¼Œå°±ä¼šå½±å“ç”¨æˆ·çº¿ç¨‹ï¼Œå¿…è¦æ—¶å¯ä»¥å°†å †å†…å­˜å¢å¤§
 * å…ˆè¿›è¡Œç¼–è¯‘ï¼Œå†ä½¿ç”¨jclasslibæŸ¥çœ‹è¯¦æƒ…
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleHeap</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> id<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">SimpleHeap</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SimpleHeap</span> simpleHeap01 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleHeap</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SimpleHeap</span> simpleHeap02 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleHeap</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr01 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr02 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å­—èŠ‚ç ä¿¡æ¯ï¼šnew åˆ›å»ºå¯¹è±¡</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code> <span class="token number">0</span> <span class="token keyword">new</span> #<span class="token number">3</span> <span class="token operator">&lt;</span>com<span class="token operator">/</span>example<span class="token operator">/</span>java<span class="token operator">/</span><span class="token class-name">SimpleHeap</span><span class="token operator">&gt;</span>
 <span class="token number">3</span> dup
 <span class="token number">4</span> iconst_1
 <span class="token number">5</span> invokespecial #<span class="token number">4</span> <span class="token operator">&lt;</span>com<span class="token operator">/</span>example<span class="token operator">/</span>java<span class="token operator">/</span><span class="token class-name">SimpleHeap</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span>init<span class="token punctuation">&gt;</span></span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token class-name">V</span><span class="token operator">&gt;</span>
 <span class="token number">8</span> astore_1
 <span class="token number">9</span> <span class="token keyword">new</span> #<span class="token number">3</span> <span class="token operator">&lt;</span>com<span class="token operator">/</span>example<span class="token operator">/</span>java<span class="token operator">/</span><span class="token class-name">SimpleHeap</span><span class="token operator">&gt;</span>
<span class="token number">12</span> dup
<span class="token number">13</span> iconst_1
<span class="token number">14</span> invokespecial #<span class="token number">4</span> <span class="token operator">&lt;</span>com<span class="token operator">/</span>example<span class="token operator">/</span>java<span class="token operator">/</span><span class="token class-name">SimpleHeap</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span>init<span class="token punctuation">&gt;</span></span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token class-name">V</span><span class="token operator">&gt;</span>
<span class="token number">17</span> astore_2
<span class="token number">18</span> bipush <span class="token number">10</span>
<span class="token number">20</span> newarray <span class="token number">10</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token number">22</span> astore_3
<span class="token number">23</span> bipush <span class="token number">10</span>
<span class="token number">25</span> anewarray #<span class="token number">5</span> <span class="token operator">&lt;</span>java<span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Object</span><span class="token operator">&gt;</span>
<span class="token number">28</span> astore <span class="token number">4</span>
<span class="token number">30</span> <span class="token keyword">return</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="8"><li><p>åœ¨æ–¹æ³•ç»“æŸåï¼Œå †ä¸­çš„å¯¹è±¡ä¸ä¼šé©¬ä¸Šè¢«ç§»é™¤ï¼Œä»…ä»…åœ¨åƒåœ¾æ”¶é›†çš„æ—¶å€™æ‰ä¼šè¢«ç§»é™¤ã€‚<strong>ã€é¢‘ç¹GCå½±å“ç”¨æˆ·è¿›ç¨‹çš„æ‰§è¡Œã€‘</strong></p></li><li><p>å †ï¼Œæ˜¯GCï¼ˆGarbage Collection, åƒåœ¾æ”¶é›†å™¨ï¼‰æ‰§è¡Œåƒåœ¾å›æ”¶çš„é‡ç‚¹åŒºåŸŸã€‚</p></li></ol><h3 id="å †çš„æ ¸å¿ƒæè¿°-å†…å­˜ç»†åˆ†" tabindex="-1"><a class="header-anchor" href="#å †çš„æ ¸å¿ƒæè¿°-å†…å­˜ç»†åˆ†" aria-hidden="true">#</a> å †çš„æ ¸å¿ƒæè¿°ï¼šå†…å­˜ç»†åˆ†</h3><p>ç°ä»£åƒåœ¾æ”¶é›†å™¨å¤§éƒ¨åˆ†åŸºäºåˆ†ä»£æ”¶é›†ç†è®ºè®¾è®¡ï¼Œå †ç©ºé—´ç»†åˆ†ä¸ºï¼š</p><p>Java 7 åŠä¹‹å‰å †å†…å­˜é€»è¾‘ä¸Šåˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šæ–°ç”ŸåŒº + å…»è€åŒº + <mark>æ°¸ä¹…åŒº</mark></p><blockquote><p>Young Generation Space æ–°ç”ŸåŒº Young/New ã€åˆè¢«åˆ’åˆ†ä¸ºEdenåŒºå’ŒSurvivoråŒºã€‘</p><p>Tenure generation space å…»è€åŒº old/Tenure</p><p>Permanent Space æ°¸ä¹…åŒº Perm</p></blockquote><p>Java 8åŠä¹‹åå †å†…å­˜é€»è¾‘ä¸Šåˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šæ–°ç”ŸåŒº + å…»è€åŒº + <mark>å…ƒç©ºé—´</mark></p><blockquote><p>Young Generation Space æ–°ç”ŸåŒº Young/New ã€åˆè¢«åˆ’åˆ†ä¸ºEdenåŒºå’ŒSurvivoråŒºã€‘</p><p>Tenure generation space å…»è€åŒº old/Tenure</p><p>Meta Space å…ƒç©ºé—´ Meta</p></blockquote><p>ä¸€èˆ¬çº¦å®šï¼šã€æ–°ç”ŸåŒº = æ–°ç”Ÿä»£ = å¹´è½»ä»£ å…»è€åŒº = è€å¹´åŒº = è€å¹´ä»£ æ°¸ä¹…åŒº = æ°¸ä¹…ä»£ã€‘</p><p><strong>Visual GC æ’ä»¶å®‰è£…ï¼š</strong></p><p>ä½¿ç”¨ jvisualvm æŸ¥çœ‹å †å†…å­˜è¯¦ç»†ä¿¡æ¯ï¼Œå®‰è£… Visual GC æ’ä»¶ã€ç›¸å½“äºä¸€ä¸ªå¯è§†åŒ–æ’ä»¶ã€‘ï¼šå·¥å…·|æ’ä»¶|æœç´¢|å®‰è£…|é‡å¯</p><p>å¦‚æœå®‰è£…å‡ºç°ç½‘ç»œé—®é¢˜ï¼Œåˆ™ä¿®æ”¹ URLï¼š<a href="https://visualvm.github.io/archive/uc/8u40/updates.xml.gz" target="_blank" rel="noopener noreferrer">https://visualvm.github.io/archive/uc/8u40/updates.xml.gz<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p><p>ä¿®æ”¹HeapDemo01ï¼š-Xms10m -Xmx10mï¼Œä½¿ç”¨ Visual GC æŸ¥çœ‹ï¼š</p><p>æ³¨æ„ï¼š<strong>ã€å…ƒç©ºé—´/æ°¸ä¹…ä»£åªæ˜¯é€»è¾‘åŒºåŸŸã€‘</strong></p><p>![ä½¿ç”¨Visual GCæŸ¥çœ‹å †å†…å­˜ç©ºé—´å¤§å°.png](JVM/ä½¿ç”¨Visual GCæŸ¥çœ‹å †å†…å­˜ç©ºé—´å¤§å°.png)</p><p>ä¸Šå›¾è¯´æ˜ï¼š</p><p><strong>Survivor 0å’ŒSurvivor 1å¯¹äºåƒåœ¾å›æ”¶åªèƒ½æœ‰ä¸€ä¸ªåŒºåŸŸå­˜å‚¨æ•°æ®ï¼Œæ–°ç”Ÿä»£çš„å¤§å°æ˜¯Eden Space+ Survivor0/1ã€‚</strong></p><p>ä¹Ÿå¯ä»¥åœ¨æ§åˆ¶å°æ‰“å°**ã€æ³¨æ„è¯¥å‚æ•°åœ¨ç¨‹åºè¿è¡Œå®Œæˆä»¥åæ‰ä¼šæ‰“å°ã€‘**ï¼Œå¢åŠ  vm å‚æ•°ï¼š-XX:+PringGCDetails</p><p>ä¿®æ”¹ SimpleHeapï¼š-Xms10m -Xmx10m -XX:+PrintGCDetails</p><p>åˆ‡æ¢ä¸åŒçš„ jdk ç‰ˆæœ¬ï¼ŒæŸ¥çœ‹ Metaspace/</p><p>å¯¹äºjdk8ï¼Œå¯¹åº”å…ƒç©ºé—´ Metaspaceï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Heap</span>
 <span class="token class-name">PSYoungGen</span>      total <span class="token number">2560</span>K<span class="token punctuation">,</span> used <span class="token number">1703</span>K <span class="token punctuation">[</span><span class="token number">0x00000000ffd00000</span><span class="token punctuation">,</span> <span class="token number">0x0000000100000000</span><span class="token punctuation">,</span> <span class="token number">0x0000000100000000</span><span class="token punctuation">)</span>
  eden space <span class="token number">2048</span>K<span class="token punctuation">,</span> <span class="token number">83</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000ffd00000</span><span class="token punctuation">,</span><span class="token number">0x00000000ffea9d50</span><span class="token punctuation">,</span><span class="token number">0x00000000fff00000</span><span class="token punctuation">)</span>
  from space <span class="token number">512</span>K<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000fff80000</span><span class="token punctuation">,</span><span class="token number">0x00000000fff80000</span><span class="token punctuation">,</span><span class="token number">0x0000000100000000</span><span class="token punctuation">)</span>
  <span class="token keyword">to</span>   <span class="token namespace">space</span> <span class="token number">512</span>K<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000fff00000</span><span class="token punctuation">,</span><span class="token number">0x00000000fff00000</span><span class="token punctuation">,</span><span class="token number">0x00000000fff80000</span><span class="token punctuation">)</span>
 <span class="token class-name">ParOldGen</span>       total <span class="token number">7168</span>K<span class="token punctuation">,</span> used <span class="token number">0</span>K <span class="token punctuation">[</span><span class="token number">0x00000000ff600000</span><span class="token punctuation">,</span> <span class="token number">0x00000000ffd00000</span><span class="token punctuation">,</span> <span class="token number">0x00000000ffd00000</span><span class="token punctuation">)</span>
  object space <span class="token number">7168</span>K<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000ff600000</span><span class="token punctuation">,</span><span class="token number">0x00000000ff600000</span><span class="token punctuation">,</span><span class="token number">0x00000000ffd00000</span><span class="token punctuation">)</span>
 <span class="token class-name">Metaspace</span>       used <span class="token number">3241</span>K<span class="token punctuation">,</span> capacity <span class="token number">4496</span>K<span class="token punctuation">,</span> committed <span class="token number">4864</span>K<span class="token punctuation">,</span> reserved <span class="token number">1056768</span>K
  <span class="token keyword">class</span> space    used <span class="token number">352</span>K<span class="token punctuation">,</span> capacity <span class="token number">388</span>K<span class="token punctuation">,</span> committed <span class="token number">512</span>K<span class="token punctuation">,</span> reserved <span class="token number">1048576</span>K
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹äºjdk7ï¼Œå¯¹åº”å…ƒç©ºé—´ PSPermGenï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code> <span class="token class-name">PSYoungGen</span>      total <span class="token number">3072</span>K<span class="token punctuation">,</span> used <span class="token number">1381</span>K <span class="token punctuation">[</span><span class="token number">0x00000000ffc80000</span><span class="token punctuation">,</span> <span class="token number">0x0000000100000000</span><span class="token punctuation">,</span> <span class="token number">0x0000000100000000</span><span class="token punctuation">)</span>
  eden space <span class="token number">2560</span>K<span class="token punctuation">,</span> <span class="token number">53</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000ffc80000</span><span class="token punctuation">,</span><span class="token number">0x00000000ffdd9710</span><span class="token punctuation">,</span><span class="token number">0x00000000fff00000</span><span class="token punctuation">)</span>
  from space <span class="token number">512</span>K<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000fff80000</span><span class="token punctuation">,</span><span class="token number">0x00000000fff80000</span><span class="token punctuation">,</span><span class="token number">0x0000000100000000</span><span class="token punctuation">)</span>
  <span class="token keyword">to</span>   <span class="token namespace">space</span> <span class="token number">512</span>K<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000fff00000</span><span class="token punctuation">,</span><span class="token number">0x00000000fff00000</span><span class="token punctuation">,</span><span class="token number">0x00000000fff80000</span><span class="token punctuation">)</span>
 <span class="token class-name">ParOldGen</span>       total <span class="token number">7168</span>K<span class="token punctuation">,</span> used <span class="token number">0</span>K <span class="token punctuation">[</span><span class="token number">0x00000000ff580000</span><span class="token punctuation">,</span> <span class="token number">0x00000000ffc80000</span><span class="token punctuation">,</span> <span class="token number">0x00000000ffc80000</span><span class="token punctuation">)</span>
  object space <span class="token number">7168</span>K<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000ff580000</span><span class="token punctuation">,</span><span class="token number">0x00000000ff580000</span><span class="token punctuation">,</span><span class="token number">0x00000000ffc80000</span><span class="token punctuation">)</span>
 <span class="token class-name">PSPermGen</span>       total <span class="token number">21504</span>K<span class="token punctuation">,</span> used <span class="token number">2905</span>K <span class="token punctuation">[</span><span class="token number">0x00000000fa380000</span><span class="token punctuation">,</span> <span class="token number">0x00000000fb880000</span><span class="token punctuation">,</span> <span class="token number">0x00000000ff580000</span><span class="token punctuation">)</span>
  object space <span class="token number">21504</span>K<span class="token punctuation">,</span> <span class="token number">13</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000fa380000</span><span class="token punctuation">,</span><span class="token number">0x00000000fa656538</span><span class="token punctuation">,</span><span class="token number">0x00000000fb880000</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è®¾ç½®å †å†…å­˜çš„å¤§å°ä¸oom" tabindex="-1"><a class="header-anchor" href="#è®¾ç½®å †å†…å­˜çš„å¤§å°ä¸oom" aria-hidden="true">#</a> è®¾ç½®å †å†…å­˜çš„å¤§å°ä¸OOM</h3><p>Javaå †åŒºç”¨äºå­˜å‚¨Javaå¯¹è±¡å®ä¾‹ï¼Œé‚£ä¹ˆå †çš„å¤§å°åœ¨ JVM å¯åŠ¨æ—¶å°±å·²ç»è®¾å®šå¥½äº†ï¼Œå¯ä»¥é€šè¿‡é€‰é¡¹ &quot;-Xmx&quot; å’Œ &quot;-Xms&quot; æ¥è¿›è¡Œè®¾ç½®ã€‚</p><ul><li><p>&quot;-Xms&quot;ç”¨äºè¡¨ç¤ºå †åŒºçš„èµ·å§‹å†…å­˜**ï¼ˆmemory startï¼‰**ï¼Œç­‰ä»·äº -XX: InitialHeapSize</p></li><li><p>&quot;-Xmx&quot;åˆ™ç”¨äºè¡¨ç¤ºå †åŒºçš„æœ€å¤§å†…å­˜ï¼Œç­‰ä»·äºï¼š-XX :MaxHeapSize</p></li></ul><p>ä¸€æ—¦å †åŒºä¸­çš„å†…å­˜å¤§å°è¶…è¿‡ &quot;-Xmx&quot; æ‰€æŒ‡å®šçš„æœ€å¤§å†…å­˜æ—¶ï¼Œå°†ä¼šæŠ›å‡º OutOfMemoryError å¼‚å¸¸ã€‚</p><p><strong>é€šå¸¸ä¼šå°† -Xms å’Œ -Xmx ä¸¤ä¸ªå‚æ•°é…ç½®ç›¸åŒçš„å€¼ï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†èƒ½å¤Ÿåœ¨ java åƒåœ¾å›æ”¶æœºåˆ¶æ¸…ç†å®Œå †åŒºåä¸éœ€è¦é‡æ–°åˆ†éš”è®¡ç®—å †åŒºçš„å¤§å°ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚</strong>ï¼ˆæ¯”å¦‚ä¸æ–­æ‰©å®¹å’Œç¼©å®¹ï¼Œé€ æˆç³»ç»Ÿå‹åŠ›ï¼‰</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<strong>åˆå§‹å†…å­˜å¤§å°ï¼šç‰©ç†ç”µè„‘å†…å­˜å¤§å°/ 64ï¼Œæœ€å¤§å†…å­˜å¤§å°ï¼šç‰©ç†ç”µè„‘å†…å­˜å¤§å°/ 4</strong></p><p><strong>Runtimeå®ä¾‹ï¼šå•ä¾‹ï¼ˆè¿è¡Œæ—¶æ•°æ®åŒºï¼‰</strong></p><p>å‚æ•°è®¾ç½®ç½‘å€æŸ¥çœ‹ï¼š</p><p><a href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>ç¨‹åºé»˜è®¤å †å†…å­˜å¤§å°ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è®¾ç½®å †ç©ºé—´å¤§å°çš„å‚æ•°
 *      -Xms è®¾ç½®å †ç©ºé—´ï¼ˆæ–°ç”Ÿä»£+è€å¹´ä»£ï¼‰çš„åˆå§‹å†…å­˜å¤§å°
 *      -Xï¼šJVMè¿è¡Œå‚æ•°
 *      msï¼šmemory start
 * -Xmxï¼šç”¨æ¥è®¾ç½®å †ç©ºé—´ï¼ˆæ–°ç”Ÿä»£+è€å¹´ä»£ï¼‰çš„æœ€å¤§å†…å­˜å¤§å°
 *
 * é»˜è®¤å†…å­˜å¤§å°ï¼š
 *      é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆå§‹å†…å­˜å¤§å°ï¼šç‰©ç†ç”µè„‘å†…å­˜å¤§å°/ 64
 *      æœ€å¤§å†…å­˜å¤§å°ï¼šç‰©ç†ç”µè„‘å†…å­˜å¤§å°/ 4
 * é€šå¸¸ä¼šå°†-Xmså’Œ-Xmxä¸¤ä¸ªå‚æ•°é…ç½®ç›¸åŒçš„å€¼
 *      å…¶ç›®çš„æ˜¯ä¸ºäº†èƒ½å¤Ÿåœ¨javaåƒåœ¾å›æ”¶æœºåˆ¶æ¸…ç†å®Œå †åŒºåä¸éœ€è¦é‡æ–°åˆ†éš”è®¡ç®—å †åŒºçš„å¤§å°ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚
 *  æŸ¥çœ‹è®¾ç½®çš„å‚æ•°ï¼š
 *      æ–¹å¼ä¸€ï¼šjps     jstat -gc pid
 *      æ–¹å¼äºŒï¼š-XX:+PrintGCDetails
 * ä¿®æ”¹å †å†…å­˜ç©ºé—´å¤§å°ï¼š
 *  -Xms600m -Xmx600m
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HeapSpaceInitial</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¿”å›Javaè™šæ‹Ÿæœºä¸­çš„å †å†…å­˜æ€»é‡</span>
        <span class="token keyword">long</span> initialMemory <span class="token operator">=</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">totalMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">;</span>
        <span class="token comment">// è¿”å›Javaè™šæ‹Ÿæœºè¯•å›¾ä½¿ç”¨çš„æœ€å¤§å †å†…å­˜é‡</span>
        <span class="token keyword">long</span> maxMemory <span class="token operator">=</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">maxMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;initialMemory: &quot;</span> <span class="token operator">+</span> initialMemory<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//575</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;maxMemory &quot;</span> <span class="token operator">+</span> maxMemory<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//575</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ç³»ç»Ÿå†…å­˜å¤§å°ï¼š&quot;</span> <span class="token operator">+</span> initialMemory <span class="token operator">*</span> <span class="token number">64</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">+</span> <span class="token string">&quot;G&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//7G    æ“ä½œç³»ç»Ÿä¼šå ç”¨ä¸€äº›å†…å­˜</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ç³»ç»Ÿå†…å­˜å¤§å°ï¼š&quot;</span> <span class="token operator">+</span> maxMemory <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">+</span> <span class="token string">&quot;G&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// é…åˆjstat -gc pid</span>
        <span class="token comment">// ç¨‹åºè¿è¡Œå®Œæˆä»¥åï¼Œ-XX:+PrintGCDetailsæ‰ä¼šç”Ÿæ•ˆ</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥çœ‹è®¾ç½®çš„å‚æ•°ï¼š</p><p>æ–¹å¼ä¸€ï¼šä½¿ç”¨ jps + jstat æŸ¥çœ‹</p><p>jpsï¼šæŸ¥çœ‹ç¨‹åºè¿è¡Œçš„è¿›ç¨‹</p><p>jstat -gc 9581ï¼šæŸ¥çœ‹è¿›ç¨‹idä¸º 9581çš„å†…å­˜ä½¿ç”¨æƒ…å†µ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">D</span><span class="token operator">:</span>\<span class="token class-name">Software</span>\<span class="token class-name">Java</span>\jdk1<span class="token punctuation">.</span><span class="token number">8.0_181</span>\bin<span class="token operator">&gt;</span>jps
<span class="token number">18440</span> <span class="token class-name">Jps</span>
<span class="token number">15388</span> <span class="token class-name">HeapSpaceInitial</span>
<span class="token number">18908</span> <span class="token class-name">Launcher</span>

<span class="token class-name">D</span><span class="token operator">:</span>\<span class="token class-name">Software</span>\<span class="token class-name">Java</span>\jdk1<span class="token punctuation">.</span><span class="token number">8.0_181</span>\bin<span class="token operator">&gt;</span>jstat <span class="token operator">-</span>gc <span class="token number">15388</span>
 <span class="token constant">S0C</span>    <span class="token constant">S1C</span>    <span class="token constant">S0U</span>    <span class="token constant">S1U</span>      <span class="token constant">EC</span>       <span class="token constant">EU</span>        <span class="token constant">OC</span>         <span class="token constant">OU</span>       <span class="token constant">MC</span>     <span class="token constant">MU</span>    <span class="token constant">CCSC</span>   <span class="token constant">CCSU</span>   <span class="token constant">YGC</span>     <span class="token constant">YGCT</span>    <span class="token constant">FGC</span>    <span class="token constant">FGCT</span>     <span class="token constant">GCT</span>
<span class="token number">25600.0</span> <span class="token number">25600.0</span>  <span class="token number">0.0</span>    <span class="token number">0.0</span>   <span class="token number">153600.0</span> <span class="token number">18432.1</span>   <span class="token number">409600.0</span>     <span class="token number">0.0</span>     <span class="token number">4480.0</span> <span class="token number">775.1</span>  <span class="token number">384.0</span>   <span class="token number">76.4</span>       <span class="token number">0</span>    <span class="token number">0.000</span>   <span class="token number">0</span>      <span class="token number">0.000</span>    <span class="token number">0.000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¯´æ˜ï¼šè™½ç„¶è®¾ç½®äº† -Xms600mï¼Œä½†æ˜¯æ‰“å°ç»“æœä¸º 575mï¼Œæ˜¯å› ä¸ºS0 å’Œ S1å¯¹äºåƒåœ¾å›æ”¶æ¥è¯´åªèƒ½æœ‰ä¸€ä¸ªå­˜å‚¨æ•°æ®ã€‚</strong></p><p>æ–¹å¼äºŒï¼š-XX:+PrintGCDetails</p><p>æ³¨æ„ï¼šç¨‹åºè¿è¡Œå®Œæˆä»¥åï¼Œ-XX:+PrintGCDetailsæ‰ä¼šç”Ÿæ•ˆ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Heap</span>
 <span class="token class-name">PSYoungGen</span>      total <span class="token number">179200</span>K<span class="token punctuation">,</span> used <span class="token number">24576</span>K <span class="token punctuation">[</span><span class="token number">0x00000000f3800000</span><span class="token punctuation">,</span> <span class="token number">0x0000000100000000</span><span class="token punctuation">,</span> <span class="token number">0x0000000100000000</span><span class="token punctuation">)</span>
  eden space <span class="token number">153600</span>K<span class="token punctuation">,</span> <span class="token number">16</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000f3800000</span><span class="token punctuation">,</span><span class="token number">0x00000000f50000b8</span><span class="token punctuation">,</span><span class="token number">0x00000000fce00000</span><span class="token punctuation">)</span>
  from space <span class="token number">25600</span>K<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000fe700000</span><span class="token punctuation">,</span><span class="token number">0x00000000fe700000</span><span class="token punctuation">,</span><span class="token number">0x0000000100000000</span><span class="token punctuation">)</span>
  <span class="token keyword">to</span>   <span class="token namespace">space</span> <span class="token number">25600</span>K<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000fce00000</span><span class="token punctuation">,</span><span class="token number">0x00000000fce00000</span><span class="token punctuation">,</span><span class="token number">0x00000000fe700000</span><span class="token punctuation">)</span>
 <span class="token class-name">ParOldGen</span>       total <span class="token number">409600</span>K<span class="token punctuation">,</span> used <span class="token number">0</span>K <span class="token punctuation">[</span><span class="token number">0x00000000da800000</span><span class="token punctuation">,</span> <span class="token number">0x00000000f3800000</span><span class="token punctuation">,</span> <span class="token number">0x00000000f3800000</span><span class="token punctuation">)</span>
  object space <span class="token number">409600</span>K<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000da800000</span><span class="token punctuation">,</span><span class="token number">0x00000000da800000</span><span class="token punctuation">,</span><span class="token number">0x00000000f3800000</span><span class="token punctuation">)</span>
 <span class="token class-name">Metaspace</span>       used <span class="token number">3751</span>K<span class="token punctuation">,</span> capacity <span class="token number">4536</span>K<span class="token punctuation">,</span> committed <span class="token number">4864</span>K<span class="token punctuation">,</span> reserved <span class="token number">1056768</span>K
  <span class="token keyword">class</span> space    used <span class="token number">412</span>K<span class="token punctuation">,</span> capacity <span class="token number">428</span>K<span class="token punctuation">,</span> committed <span class="token number">512</span>K<span class="token punctuation">,</span> reserved <span class="token number">1048576</span>K
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>OOMæµ‹è¯•ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
<span class="token doc-comment comment">/**
 * æµ‹è¯•OOM
 * -Xms200m -Xmx200m
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OOMTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BigDecimal</span><span class="token punctuation">&gt;</span></span> pics <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            pics<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>pics<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å¹´è½»ä»£ä¸è€å¹´ä»£" tabindex="-1"><a class="header-anchor" href="#å¹´è½»ä»£ä¸è€å¹´ä»£" aria-hidden="true">#</a> å¹´è½»ä»£ä¸è€å¹´ä»£</h3><p>å­˜å‚¨åœ¨ JVM ä¸­çš„ Java å¯¹è±¡å¯ä»¥è¢«åˆ’åˆ†ä¸ºä¸¤ç±»ï¼š</p><ul><li><p>ä¸€ç±»æ˜¯ç”Ÿå‘½å‘¨æœŸè¾ƒçŸ­çš„ç¬æ—¶å¯¹è±¡ï¼Œè¿™ç±»å¯¹è±¡çš„åˆ›å»ºå’Œæ¶ˆäº¡éƒ½éå¸¸è¿…é€Ÿã€‚</p></li><li><p>å¦å¤–ä¸€ç±»å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå´éå¸¸é•¿ï¼Œåœ¨æŸäº›æç«¯çš„æƒ…å†µä¸‹è¿˜èƒ½å¤Ÿä¸JVMçš„ç”Ÿå‘½å‘¨æœŸä¿æŒä¸€è‡´ã€‚ï¼ˆå¦‚è¿æ¥æ± ç­‰ï¼‰</p></li></ul><p>Java å †åŒºè¿›ä¸€æ­¥ç»†åˆ†çš„è¯ï¼Œå¯ä»¥åˆ’åˆ†ä¸ºå¹´è½»ä»£ï¼ˆYoungGenï¼‰å’Œè€å¹´ä»£ï¼ˆoldGenï¼‰</p><p>å…¶ä¸­å¹´è½»ä»£åˆå¯ä»¥åˆ’åˆ†ä¸º Eden ç©ºé—´ã€Survivor 0 ç©ºé—´å’Œ Survivor 1 ç©ºé—´ (æœ‰æ—¶ä¹Ÿå«åš from åŒºã€to åŒº)ã€‚</p><p>æ³¨æ„ï¼šæ°¸ä¹…ä»£å’Œå…ƒç©ºé—´åªæ˜¯é€»è¾‘å­˜å‚¨ã€‚åªèƒ½ä¿è¯ä¸€ä¸ª Survivor æœ‰æ•°æ®ï¼Œå¦ä¸€ä¸ª Survivor æœ‰ä¸€ä¸ªæ˜¯ä¸æ”¾æ•°æ®çš„ã€‚</p><figure><img src="/assets/å¹´è½»ä»£ä¸è€å¹´ä»£-c1a0bacc.png" alt="å¹´è½»ä»£ä¸è€å¹´ä»£.png" tabindex="0" loading="lazy"><figcaption>å¹´è½»ä»£ä¸è€å¹´ä»£.png</figcaption></figure><p><strong>ï¼ˆ1ï¼‰è°ƒæ•´æ–°ç”Ÿä»£ä¸è€å¹´ä»£çš„å æ¯”ï¼š</strong></p><p>é…ç½®æ–°ç”Ÿä»£ä¸è€å¹´ä»£åœ¨å †ç»“æ„çš„å æ¯”ã€‚<strong>ã€ä¸€èˆ¬ä¸ä¼šè¿›è¡Œä¿®æ”¹ï¼Œé™¤éç”Ÿå‘½å‘¨æœŸé•¿çš„å¯¹è±¡å æ¯”å¾ˆå¤§ã€‘</strong></p><p>é»˜è®¤ -XX:NewRatio=2ï¼Œè¡¨ç¤ºæ–°ç”Ÿä»£å 1ï¼Œè€å¹´ä»£å 2ï¼Œæ–°ç”Ÿä»£å æ•´ä¸ªå †çš„1/3</p><p>å¯ä»¥ä¿®æ”¹ -XX:NewRatio=4ï¼Œè¡¨ç¤ºæ–°ç”Ÿä»£å 1ï¼Œè€å¹´ä»£å 4ï¼Œæ–°ç”Ÿä»£å æ•´ä¸ªå †çš„1/5ã€‚</p><p>ç¤ºä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è®¾ç½®æ–°ç”Ÿä»£ã€è€å¹´ä»£çš„å æ¯”
 * -XX:NewRation    è®¾ç½®æ–°ç”Ÿä»£ä¸è€å¹´ä»£çš„æ¯”ä¾‹ï¼Œé»˜è®¤æ˜¯2ï¼ˆ1:2ï¼‰
 * -XX:SurvivorRatio    è®¾ç½®æ–°ç”Ÿä»£ä¸­ Eden åŒºä¸ Survivor åŒºçš„æ¯”ä¾‹
 * -XX:-UseAdaptiveSizePolicy   å…³é—­è‡ªé€‚åº”å¾·å°”å†…å­˜åˆ†é…ç­–ç•¥
 * -Xmn300m     è®¾ç½®æ–°ç”Ÿä»£çš„ç©ºé—´çš„å¤§å°ï¼ˆä¸€èˆ¬ä¸è®¾ç½®ï¼‰
 * ä¿®æ”¹å‚æ•°ï¼š-Xms600m -Xmx600m -XX:NewRatio=4
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SurvivorTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;start&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ï¼ˆ2ï¼‰æŸ¥çœ‹æ–°ç”Ÿä»£è€å¹´ä»£çš„å æ¯”ï¼š</strong></p><ul><li>æ–¹å¼ä¸€ï¼šVisual GCæŸ¥çœ‹</li></ul><figure><img src="/assets/æ–°ç”Ÿä»£è€å¹´ä»£é»˜è®¤å æ¯”-725038f9.png" alt="æ–°ç”Ÿä»£è€å¹´ä»£é»˜è®¤å æ¯”.png" tabindex="0" loading="lazy"><figcaption>æ–°ç”Ÿä»£è€å¹´ä»£é»˜è®¤å æ¯”.png</figcaption></figure><ul><li>æ–¹å¼äºŒï¼šjstat -gc pid</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>D:<span class="token punctuation">\</span>Software<span class="token punctuation">\</span>Java<span class="token punctuation">\</span>jdk1.8.0_181<span class="token punctuation">\</span>bin<span class="token operator">&gt;</span>jps
<span class="token number">4980</span> Jps
<span class="token number">10024</span> Launcher
<span class="token number">3112</span> SurvivorTest

D:<span class="token punctuation">\</span>Software<span class="token punctuation">\</span>Java<span class="token punctuation">\</span>jdk1.8.0_181<span class="token punctuation">\</span>bin<span class="token operator">&gt;</span>jstat <span class="token parameter variable">-gc</span> <span class="token number">3112</span>
 S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT     GCT
<span class="token number">25600.0</span> <span class="token number">25600.0</span>  <span class="token number">0.0</span>    <span class="token number">0.0</span>   <span class="token number">153600.0</span> <span class="token number">73728.8</span>   <span class="token number">409600.0</span>     <span class="token number">0.0</span>     <span class="token number">4480.0</span> <span class="token number">775.1</span>  <span class="token number">384.0</span>   <span class="token number">76.4</span>       <span class="token number">0</span>    <span class="token number">0.000</span>   <span class="token number">0</span>      <span class="token number">0.000</span>    <span class="token number">0.000</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ–¹å¼ä¸‰ï¼šjinfo -flag NewRatio pid</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>D:<span class="token punctuation">\</span>Software<span class="token punctuation">\</span>Java<span class="token punctuation">\</span>jdk1.8.0_181<span class="token punctuation">\</span>bin<span class="token operator">&gt;</span>jinfo <span class="token parameter variable">-flag</span> NewRatio <span class="token number">3112</span>
<span class="token parameter variable">-XX:NewRatio</span><span class="token operator">=</span><span class="token number">2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ï¼ˆ3ï¼‰è°ƒæ•´æ–°ç”Ÿä»£ä¸­ Eden å’Œ Survivor çš„å æ¯”</strong></p><ul><li><p>åœ¨HotSpotä¸­ï¼ŒEdenç©ºé—´å’Œå¦å¤–ä¸¤ä¸ªSurvivorç©ºé—´ç¼ºçœæ‰€å çš„æ¯”ä¾‹æ˜¯ <strong>8:1:1</strong></p></li><li><p>å¼€å‘äººå‘˜å¯ä»¥é€šè¿‡é€‰é¡¹ <strong>&quot;-XX:SurvivorRatio&quot;</strong> è°ƒæ•´è¿™ä¸ªç©ºé—´æ¯”ä¾‹ã€‚<strong>æ¯”å¦‚-XX:SurvivorRatio=8</strong></p></li><li><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå‡ ä¹æ‰€æœ‰çš„Javaå¯¹è±¡éƒ½æ˜¯åœ¨EdenåŒºè¢«newå‡ºæ¥çš„ã€‚ç»å¤§éƒ¨åˆ†çš„Javaå¯¹è±¡çš„é”€æ¯éƒ½åœ¨æ–°ç”Ÿä»£è¿›è¡Œäº†ã€‚IBMå…¬å¸çš„ä¸“é—¨ç ”ç©¶è¡¨æ˜ï¼Œæ–°ç”Ÿä»£ä¸­80%çš„å¯¹è±¡éƒ½æ˜¯ &quot;æœç”Ÿå¤•æ­»&quot; çš„ã€‚</p></li><li><p>å¯ä»¥ä½¿ç”¨é€‰é¡¹ &quot;-Xmn&quot; è®¾ç½®æ–°ç”Ÿä»£æœ€å¤§å†…å­˜å¤§å°ï¼Œè¿™ä¸ªå‚æ•°ä¸€èˆ¬ä½¿ç”¨é»˜è®¤å€¼å°±å¯ä»¥ã€‚</p></li><li><p>è¿è¡Œç¨‹åºï¼Œç»“æœä¸æ˜¯ 8:1:1ï¼Œè€Œæ˜¯ 6:1:1</p><p>åŸå› ï¼š<strong>-XX:SurvivorRatio</strong> é»˜è®¤ä¸º8ï¼Œå•ç‹¬ä½¿ç”¨åˆå§‹æ—¶ç”Ÿæ•ˆï¼Œä½†æ˜¯ç”±äº <strong>-XX:+UseAdaptiveSizePolicy</strong> é»˜è®¤å¼€å¯ï¼ŒåæœŸä¼šè‡ªåŠ¨è°ƒèŠ‚SurvivoråŒºçš„å¤§å°ï¼Œå–æ¶ˆè‡ªé€‚åº”ï¼ˆ-XX:-UseAdaptiveSizePolicyï¼‰å³å¯ä½¿å¾— -XX:SurvivorRatio ç”Ÿæ•ˆï¼</p><p><strong>æ³¨æ„ï¼šå¿…é¡»å¼ºåˆ¶æŒ‡å®š -XX:SurvivorRatio=8ï¼Œå¦åˆ™å³ä½¿è®¾ç½® -XX:-UseAdaptiveSizePolicy ä¹Ÿä¸ç”Ÿæ•ˆã€‚</strong></p></li></ul><figure><img src="/assets/Edenä¸Survivorå æ¯”-b7245efb.png" alt="Edenä¸Survivorå æ¯”.png" tabindex="0" loading="lazy"><figcaption>Edenä¸Survivorå æ¯”.png</figcaption></figure><ul><li>ä½¿ç”¨ã€-Xmn300mã€‘è®¾ç½®æ–°ç”Ÿä»£å†…å­˜å¤§å°ï¼šå¦‚æœä½¿ç”¨-Xmn300må’Œ-XX:NewRatio=8,åˆ™ä»¥-Xmn300mä¸ºå‡†</li></ul><p>ï¼ˆ4ï¼‰<strong>å‡ ç‚¹è¯´æ˜</strong></p><p><strong>å…³äºAdaptiveSizePolicy(è‡ªé€‚åº”å¤§å°ç­–ç•¥) çš„è¯´æ˜</strong></p><p>â€‹ JDK 1.8 é»˜è®¤ä½¿ç”¨ UseParallelGC åƒåœ¾å›æ”¶å™¨ï¼Œè¯¥åƒåœ¾å›æ”¶å™¨é»˜è®¤å¯åŠ¨äº† AdaptiveSizePolicyï¼Œä¼šæ ¹æ®GCçš„æƒ…å†µè‡ªåŠ¨è®¡ç®—è®¡ç®— Edenã€From å’Œ To åŒºçš„å¤§å°ï¼›</p><p>å‚æ•°é…ç½®ï¼š</p><p>â€‹ å¼€å¯ï¼š-XX:+UseAdaptiveSizePolicy<br> â€‹ å…³é—­ï¼š-XX:-UseAdaptiveSizePolicy</p><p><strong><mark>æ³¨æ„äº‹é¡¹ï¼š</mark></strong></p><ol><li><p>åœ¨ JDK 1.8 ä¸­ï¼Œå¦‚æœä½¿ç”¨ CMSï¼Œæ— è®º UseAdaptiveSizePolicy å¦‚ä½•è®¾ç½®ï¼Œéƒ½ä¼šå°† UseAdaptiveSizePolicy è®¾ç½®ä¸º falseï¼›ä¸è¿‡ä¸åŒç‰ˆæœ¬çš„JDKå­˜åœ¨å·®å¼‚ï¼›</p></li><li><p>UseAdaptiveSizePolicyä¸è¦å’ŒSurvivorRatioå‚æ•°æ˜¾ç¤ºè®¾ç½®æ­é…ä½¿ç”¨ï¼Œä¸€èµ·ä½¿ç”¨ä¼šå¯¼è‡´å‚æ•°å¤±æ•ˆï¼›</p></li><li><p>ç”±äºAdaptiveSizePolicyä¼šåŠ¨æ€è°ƒæ•´ Edenã€Survivor çš„å¤§å°ï¼Œæœ‰äº›æƒ…å†µå­˜åœ¨Survivor è¢«è‡ªåŠ¨è°ƒä¸ºå¾ˆå°ï¼Œæ¯”å¦‚åå‡ MBç”šè‡³å‡ MBçš„å¯èƒ½ï¼Œè¿™ä¸ªæ—¶å€™YGCå›æ”¶æ‰ EdenåŒºåï¼Œè¿˜å­˜æ´»çš„å¯¹è±¡è¿›å…¥Survivor è£…ä¸ä¸‹ï¼Œå°±ä¼šç›´æ¥æ™‹å‡åˆ°è€å¹´ä»£ï¼Œå¯¼è‡´è€å¹´ä»£å ç”¨ç©ºé—´é€æ¸å¢åŠ ï¼Œä»è€Œè§¦å‘FULL GCï¼Œå¦‚æœä¸€æ¬¡FULL GCçš„è€—æ—¶å¾ˆé•¿ï¼ˆæ¯”å¦‚åˆ°è¾¾å‡ ç™¾æ¯«ç§’ï¼‰ï¼Œé‚£ä¹ˆåœ¨è¦æ±‚é«˜å“åº”çš„ç³»ç»Ÿå°±æ˜¯ä¸å¯å–çš„ã€‚</p></li></ol><h3 id="å›¾åƒå¯¹è±¡çš„åˆ†é…è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#å›¾åƒå¯¹è±¡çš„åˆ†é…è¿‡ç¨‹" aria-hidden="true">#</a> å›¾åƒå¯¹è±¡çš„åˆ†é…è¿‡ç¨‹</h3><h4 id="å¯¹è±¡åˆ†é…è¿‡ç¨‹æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#å¯¹è±¡åˆ†é…è¿‡ç¨‹æ¦‚è¿°" aria-hidden="true">#</a> å¯¹è±¡åˆ†é…è¿‡ç¨‹æ¦‚è¿°</h4><p>â€‹ ä¸ºæ–°å¯¹è±¡åˆ†é…å†…å­˜æ˜¯ä¸€ä»¶éå¸¸ä¸¥è°¨å’Œå¤æ‚çš„ä»»åŠ¡ï¼ŒJVMçš„è®¾è®¡è€…ä»¬ä¸ä»…éœ€è¦è€ƒè™‘å†…å­˜å¦‚ä½•åˆ†é…ã€åœ¨å“ªé‡Œåˆ†é…ç­‰é—®é¢˜ï¼Œå¹¶ä¸”ç”±äºå†…å­˜åˆ†é…ç®—æ³•ä¸å†…å­˜å›æ”¶ç®—æ³•å¯†åˆ‡ç›¸å…³ï¼Œæ‰€ä»¥è¿˜éœ€è¦è€ƒè™‘GCæ‰§è¡Œå®Œå†…å­˜å›æ”¶åæ˜¯å¦ä¼šåœ¨å†…å­˜ç©ºé—´ä¸­äº§ç”Ÿå†…å­˜ç¢ç‰‡ã€‚</p><p><strong>ï¼ˆ1ï¼‰åˆ†é…å›¾ç¤ºï¼š</strong></p><figure><img src="/assets/å›¾è§£å¯¹è±¡åˆ†é…è¿‡ç¨‹01-d9dc5e38.png" alt="å›¾è§£å¯¹è±¡åˆ†é…è¿‡ç¨‹01.png" tabindex="0" loading="lazy"><figcaption>å›¾è§£å¯¹è±¡åˆ†é…è¿‡ç¨‹01.png</figcaption></figure><p>â€‹ ç¬¬ä¸€æ¬¡åˆ›å»ºçš„å¯¹è±¡ä¼šæ”¾åœ¨EdenåŒºï¼Œç­‰ Eden åŒºæ»¡ä¹‹å YGC ï¼ˆYoung GCï¼‰ä¼šå›æ”¶åƒåœ¾å¯¹è±¡ï¼Œå°†éåƒåœ¾å¯¹è±¡æ”¾åœ¨S0åŒºï¼Œæ ‡è®°æ¬¡æ•°ï¼ˆå¹´é¾„ï¼‰ä¸º1ã€‚</p><figure><img src="/assets/å›¾è§£å¯¹è±¡åˆ†é…è¿‡ç¨‹02-0f247ace.png" alt="å›¾è§£å¯¹è±¡åˆ†é…è¿‡ç¨‹02.png" tabindex="0" loading="lazy"><figcaption>å›¾è§£å¯¹è±¡åˆ†é…è¿‡ç¨‹02.png</figcaption></figure><p>â€‹ ç¬¬äºŒæ¬¡EdenåŒºæ»¡ä¹‹åï¼ŒYGCä¼šå°†Edenå’ŒFromåŒºè¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå°†éåƒåœ¾å¯¹è±¡æ”¾åœ¨ToåŒºï¼Œæ ‡è®°æ¬¡æ•°ï¼ˆageï¼‰ä¸º2ã€‚</p><figure><img src="/assets/å›¾è§£å¯¹è±¡åˆ†é…è¿‡ç¨‹03-51611343.png" alt="å›¾è§£å¯¹è±¡åˆ†é…è¿‡ç¨‹03.png" tabindex="0" loading="lazy"><figcaption>å›¾è§£å¯¹è±¡åˆ†é…è¿‡ç¨‹03.png</figcaption></figure><p>â€‹ ä¾æ¬¡åå¤ï¼Œå½“å¯¹è±¡çš„æ ‡è®°æ¬¡æ•°è¾¾åˆ°é˜ˆå€¼ä»¥åï¼Œå°±ä¼šæ”¾å…¥è€å¹´ä»£ã€‚</p><p><strong>ï¼ˆ2ï¼‰æ³¨æ„äº‹é¡¹ï¼š</strong></p><ol><li><p>åªæœ‰Edenæ»¡äº†ä¹‹åæ‰ä¼šè§¦å‘åƒåœ¾å›æ”¶ï¼ŒS0å’ŒS1ä¸ä¼šè§¦å‘GCæœºåˆ¶ã€‚</p></li><li><p>ä¸ä¸€å®šéè¦ç­‰åˆ°é˜ˆå€¼æ‰ä¼šæ”¾åœ¨è€å¹´ä»£ï¼ŒEdenå’ŒSurvivorä¹Ÿå¯ä»¥ä¸è¾¾åˆ°é˜ˆå€¼å°±æ”¾åœ¨è€å¹´ä»£ã€‚</p></li><li><p>å¯¹å¹¸å­˜è€…s0,s1åŒºçš„æ€»ç»“ï¼šå¤åˆ¶ä¹‹åæœ‰äº¤æ¢ï¼Œè°ç©ºè°æ˜¯ to åŒºã€‚</p></li><li><p>å…³äºåƒåœ¾å›æ”¶ï¼šé¢‘ç¹åœ¨æ–°ç”ŸåŒºæ”¶é›†ï¼Œå¾ˆå°‘åœ¨å…»è€åŒºæ”¶é›†ï¼Œå‡ ä¹ä¸åœ¨æ°¸ä¹…åŒº / å…ƒç©ºé—´æ”¶é›†ã€‚</p></li></ol><p><strong>ï¼ˆ3ï¼‰åˆ†é…æ­¥éª¤ï¼š</strong></p><figure><img src="/assets/å›¾è§£å¯¹è±¡åˆ†é…æµç¨‹-b9c82ee6.png" alt="å›¾è§£å¯¹è±¡åˆ†é…æµç¨‹.png" tabindex="0" loading="lazy"><figcaption>å›¾è§£å¯¹è±¡åˆ†é…æµç¨‹.png</figcaption></figure><ul><li><p>newçš„å¯¹è±¡å…ˆæ”¾ä¼Šç”¸å›­ï¼ˆEdenï¼‰åŒºï¼Œæ­¤åŒºæœ‰å¤§å°é™åˆ¶ã€‚</p></li><li><p>å½“ä¼Šç”¸å›­çš„ç©ºé—´å¡«æ»¡æ—¶ï¼Œç¨‹åºåˆéœ€è¦åˆ›å»ºå¯¹è±¡ï¼ŒJVMçš„åƒåœ¾å›æ”¶å™¨å°†å¯¹ä¼Šç”¸å›­åŒºè¿›è¡Œåƒåœ¾å›æ”¶ï¼ˆMinorGCï¼‰ã€‚</p><ul><li><p>å°†ä¼Šç”¸å›­åŒºä¸­çš„ä¸å†è¢«å…¶ä»–å¯¹è±¡æ‰€å¼•ç”¨çš„å¯¹è±¡è¿›è¡Œé”€æ¯ï¼Œç„¶åå°†ä¼Šç”¸å›­ä¸­çš„å‰©ä½™å¯¹è±¡ç§»åŠ¨åˆ°å¹¸å­˜è€…S0åŒºã€‚</p></li><li><p>æœŸé—´ç»å†è§¦å‘å¤šæ¬¡åƒåœ¾å›æ”¶ï¼Œæ­¤æ—¶ä¸Šæ¬¡å¹¸å­˜ä¸‹æ¥çš„æ”¾åˆ°å¹¸å­˜è€…0åŒºçš„ï¼Œå¦‚æœæ²¡æœ‰å›æ”¶ï¼Œå°±ä¼šæ”¾åˆ°å¹¸å­˜è€…1åŒºï¼Œä¾æ¬¡å¾€å¤ã€‚</p></li><li><p>å¦‚æœS0åŒºæ”¾ä¸ä¸‹å¯¹è±¡ï¼Œåˆ™æ–°åŠ å…¥çš„å¯¹è±¡ç›´æ¥æ”¾å…¥è€å¹´ä»£ã€‚å½“S0æˆ–S1ä¸­çš„å¯¹è±¡å­˜æ´»è¶…è¿‡é˜ˆå€¼ï¼ˆé»˜è®¤15æ¬¡ï¼‰æ—¶ï¼Œä¹Ÿä¼šæ™‹å‡ä¸ºè€å¹´ä»£ã€‚</p></li><li><p>å¯ä»¥è®¾ç½®å‚æ•°: -XX : MaxTenuringThreshold=&lt;N&gt;è¿›è¡Œè®¾ç½®ã€‚</p></li></ul></li><li><p>Minor GCå®Œæˆåï¼Œå†åŠ è½½æ–°çš„å¯¹è±¡æ”¾åˆ°ä¼Šç”¸å›­åŒºï¼Œå¦‚æœ Eden æ”¾å¾—ä¸‹ï¼Œåˆ™åˆ†é…å†…å­˜ç©ºé—´ï¼Œæ”¾ä¸ä¸‹å°±ä¼šæ”¾å…¥è€å¹´ä»£iï¼Œå¦‚æœè€å¹´ä»£ä¹Ÿæ”¾ä¸ä¸‹ï¼Œæ¥ä¸‹æ¥å°±ä¼šè¿›è¡ŒFull GCï¼ŒFull GC å®Œæˆåï¼Œè€å¹´ä»£ä¾æ—§æ”¾ä¸ä¸‹ï¼Œå°±ä¼š OOMã€‚</p></li></ul><p>ç¨‹åºç¤ºä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æ¼”ç¤ºå†…å­˜åˆ†é…è¿‡ç¨‹
 * -Xms600m  -Xmx600m
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HeapInstanceTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span>  <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// listä¸€ç›´æœªè¢«å›æ”¶</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HeapInstanceTest</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HeapInstanceTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span><span class="token punctuation">{</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä½¿ç”¨Visual GCæ¼”ç¤ºå†…å­˜åˆ†é…è¿‡ç¨‹ï¼š</strong></p><figure><img src="/assets/ç¨‹åºæ¼”ç¤ºå†…å­˜åˆ†é…è¿‡ç¨‹-58d08df9.png" alt="ç¨‹åºæ¼”ç¤ºå†…å­˜åˆ†é…è¿‡ç¨‹.png" tabindex="0" loading="lazy"><figcaption>ç¨‹åºæ¼”ç¤ºå†…å­˜åˆ†é…è¿‡ç¨‹.png</figcaption></figure><p><strong>ä½¿ç”¨å†…å­˜åˆ†æå·¥å…· jprofileræŸ¥çœ‹å†…å­˜åˆ†é…æƒ…å†µï¼š</strong></p><p>å®‰è£…ï¼šä¸‹è½½ jprofilerç¨‹åºï¼Œå®‰è£…å®Œæˆåï¼Œå†åœ¨ideaæ’ä»¶ä¸­å®‰è£…ï¼Œé€‰æ‹©å®‰è£…ä½ç½®å³å¯ã€‚</p><p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p><figure><img src="/assets/å†…å­˜åˆ†æå·¥å…·jprofilerä½¿ç”¨ç¤ºä¾‹-edcf9121.png" alt="å†…å­˜åˆ†æå·¥å…·jprofilerä½¿ç”¨ç¤ºä¾‹.png" tabindex="0" loading="lazy"><figcaption>å†…å­˜åˆ†æå·¥å…·jprofilerä½¿ç”¨ç¤ºä¾‹.png</figcaption></figure><p><strong>å¸¸ç”¨è°ƒä¼˜å·¥å…·</strong></p><p><strong>è°ƒä¼˜ï¼šå‡å°‘GC</strong></p><ul><li>JDKå‘½ä»¤è¡Œ</li><li>Eclipse:Memory Analyzer Tool</li><li>Jconsole</li><li>Visua1VM]</li><li>Jprofiler</li><li>Java Flight Recorder</li><li>GCViewer</li><li>GC Easy</li><li>Jprofilerçš„ä½¿ç”¨ï¼šä¸‹è½½Jprofilerï¼Œå®‰è£…jprofileræ’ä»¶</li></ul><h3 id="minor-gcã€major-gcã€full-gc" tabindex="-1"><a class="header-anchor" href="#minor-gcã€major-gcã€full-gc" aria-hidden="true">#</a> Minor GCã€Major GCã€Full GC</h3><h4 id="éƒ¨åˆ†æ”¶é›†å’Œæ•´å †æ”¶é›†" tabindex="-1"><a class="header-anchor" href="#éƒ¨åˆ†æ”¶é›†å’Œæ•´å †æ”¶é›†" aria-hidden="true">#</a> éƒ¨åˆ†æ”¶é›†å’Œæ•´å †æ”¶é›†</h4><p>â€‹ JVMåœ¨è¿›è¡ŒGCæ—¶ï¼Œå¹¶éæ¯æ¬¡éƒ½å¯¹ä¸Šé¢ä¸‰ä¸ªå†…å­˜(æ–°ç”Ÿä»£ã€è€å¹´ä»£ï¼›æ–¹æ³•åŒº)åŒºåŸŸä¸€èµ·å›æ”¶çš„ï¼Œå¤§éƒ¨åˆ†æ—¶å€™å›æ”¶çš„éƒ½æ˜¯æŒ‡æ–°ç”Ÿä»£ã€‚é’ˆå¯¹HotSpot VMçš„å®ç°ï¼Œå®ƒé‡Œé¢çš„GCæŒ‰ç…§å›æ”¶åŒºåŸŸåˆåˆ†ä¸ºä¸¤å¤§ç§ç±»å‹ï¼šä¸€ç§æ˜¯éƒ¨åˆ†æ”¶é›†(Partial GC)ï¼Œä¸€ç§æ˜¯æ•´å †æ”¶é›†(Full GC)ã€‚</p><ul><li><p>éƒ¨åˆ†æ”¶é›†ï¼šä¸æ˜¯å®Œæ•´æ”¶é›†æ•´ä¸ªJavaå †çš„åƒåœ¾æ”¶é›†ã€‚å…¶ä¸­åˆåˆ†ä¸ºï¼š</p><ul><li><p>æ–°ç”Ÿä»£æ”¶é›†(Minor GC / Young GC) ï¼šåªæ˜¯æ–°ç”Ÿä»£(Eden\S0,S1) çš„åƒåœ¾æ”¶é›†ã€‚</p></li><li><p>è€å¹´ä»£æ”¶é›†(Major GC / 0ld GC) ï¼šåªæ˜¯è€å¹´ä»£çš„åƒåœ¾æ”¶é›†ã€‚</p><p>â€‹ ç›®å‰ï¼Œåªæœ‰CMS GCä¼šæœ‰å•ç‹¬æ”¶é›†è€å¹´ä»£çš„è¡Œä¸ºã€‚</p><p>â€‹ æ³¨æ„ï¼Œå¾ˆå¤šæ—¶å€™ Major GC ä¼šå’Œ Full GC æ··æ·†ä½¿ç”¨ï¼Œéœ€è¦å…·ä½“åˆ†è¾¨æ˜¯è€å¹´ä»£å›æ”¶è¿˜æ˜¯æ•´å †å›æ”¶ã€‚</p></li><li><p>æ··åˆæ”¶é›†(Mixed GC)ï¼šæ”¶é›†æ•´ä¸ªæ–°ç”Ÿä»£ä»¥åŠéƒ¨åˆ†è€å¹´ä»£çš„åƒåœ¾æ”¶é›†ã€‚</p><p>ç›®å‰ï¼Œåªæœ‰G1 GCä¼šæœ‰è¿™ç§è¡Œä¸º</p></li></ul></li><li><p>æ•´å †æ”¶é›†(Full GC)ï¼šæ”¶é›†æ•´ä¸ªjavaå †å’Œæ–¹æ³•åŒºçš„åƒåœ¾æ”¶é›†ã€‚</p></li></ul><p><strong><mark>è°ƒä¼˜ï¼šå‡å°‘GCæ¬¡æ•°ï¼ŒGCé¢‘ç¹ä¼šé˜»æ–­ç”¨æˆ·çº¿ç¨‹çš„æ‰§è¡Œã€‚</mark></strong></p><h4 id="å¹´è½»ä»£gc-minor-gc-è§¦å‘æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#å¹´è½»ä»£gc-minor-gc-è§¦å‘æœºåˆ¶" aria-hidden="true">#</a> å¹´è½»ä»£GC(Minor GC) è§¦å‘æœºåˆ¶</h4><ol><li><p>å½“å¹´è½»ä»£ç©ºé—´ä¸è¶³æ—¶ï¼Œå°±ä¼šè§¦å‘ Minor GCï¼Œè¿™é‡Œçš„å¹´è½»ä»£æ»¡æŒ‡çš„æ˜¯ Eden ä»£æ»¡ï¼ŒSurvivor æ»¡ä¸ä¼šå¼•å‘ GCã€‚(æ¯æ¬¡ Minor GC ä¼šæ¸…ç†å¹´è½»ä»£çš„å†…å­˜ã€‚)</p></li><li><p>å› ä¸º Java å¯¹è±¡å¤§å¤šéƒ½å…·å¤‡æœç”Ÿå¤•ç­çš„ç‰¹æ€§ï¼Œæ‰€ä»¥ Minor GC éå¸¸é¢‘ç¹ï¼Œä¸€èˆ¬å›æ”¶é€Ÿåº¦ä¹Ÿæ¯”è¾ƒå¿«ã€‚è¿™ä¸€å®šä¹‰æ—¢æ¸…æ™°åˆæ˜“äºç†è§£ã€‚</p></li><li><p>Minor GC ä¼šå¼•å‘ STWï¼Œ æš‚åœå…¶å®ƒç”¨æˆ·çš„çº¿ç¨‹ï¼Œç­‰åƒåœ¾å›æ”¶ç»“æŸï¼Œç”¨æˆ·çº¿ç¨‹æ‰æ¢å¤è¿è¡Œã€‚</p></li></ol><h4 id="è€å¹´ä»£gc-major-gc-fu11-gc-è§¦å‘æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#è€å¹´ä»£gc-major-gc-fu11-gc-è§¦å‘æœºåˆ¶" aria-hidden="true">#</a> è€å¹´ä»£GC (Major GC/Fu11 GC) è§¦å‘æœºåˆ¶</h4><ol><li><p>æŒ‡å‘ç”Ÿåœ¨è€å¹´ä»£çš„GCï¼Œå¯¹è±¡ä»è€å¹´ä»£æ¶ˆå¤±æ—¶ï¼Œæˆ‘ä»¬è¯´ &quot;Major GC&quot; æˆ– &quot;Full GC&quot; å‘ç”Ÿäº†ã€‚</p></li><li><p>å‡ºç°äº† Major GCï¼Œ ç»å¸¸ä¼šä¼´éšè‡³å°‘ä¸€æ¬¡çš„ Minor GC (ä½†éç»å¯¹çš„ï¼Œåœ¨Parallel Scavengeæ”¶é›†å™¨çš„æ”¶é›†ç­–ç•¥é‡Œå°±æœ‰ç›´æ¥è¿›è¡ŒMajor GCçš„ç­–ç•¥é€‰æ‹©è¿‡ç¨‹)ã€‚</p></li><li><p>ä¹Ÿå°±æ˜¯åœ¨è€å¹´ä»£ç©ºé—´ä¸è¶³æ—¶ï¼Œä¼šå…ˆå°è¯•è§¦å‘ Minor GCã€‚å¦‚æœä¹‹åç©ºé—´è¿˜ä¸è¶³ï¼Œåˆ™è§¦å‘ Major GCã€‚</p></li><li><p>Major GC çš„é€Ÿåº¦ä¸€èˆ¬ä¼šæ¯” Minor GC æ…¢10å€ä»¥ä¸Šï¼ŒSTW çš„æ—¶é—´æ›´é•¿ã€‚</p></li><li><p>å¦‚æœ Major GC åï¼Œå†…å­˜è¿˜ä¸è¶³ï¼Œå°±æŠ¥ OOM äº†ã€‚</p></li></ol><h4 id="full-gcè§¦å‘æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#full-gcè§¦å‘æœºåˆ¶" aria-hidden="true">#</a> Full GCè§¦å‘æœºåˆ¶</h4><p>è§¦å‘Full GCæ‰§è¡Œçš„æƒ…å†µæœ‰å¦‚ä¸‹äº”ç§ï¼š</p><p>(1) è°ƒç”¨ System. gc() æ—¶ï¼Œç³»ç»Ÿå»ºè®®æ‰§è¡Œ Full GCï¼Œä½†æ˜¯ä¸å¿…ç„¶æ‰§è¡Œã€‚</p><p>(2) è€å¹´ä»£ç©ºé—´ä¸è¶³</p><p>(3) æ–¹æ³•åŒºç©ºé—´ä¸è¶³</p><p>(4) é€šè¿‡ Minor GC åè¿›å…¥è€å¹´ä»£çš„å¹³å‡å¤§å°å¤§äºè€å¹´ä»£çš„å¯ç”¨å†…å­˜ã€‚</p><p>(5) ç”± Eden åŒºã€Survivors pacee (From Space) åŒºå‘ Survivor space1 (ToSpace) åŒºå¤åˆ¶æ—¶ï¼Œå¯¹è±¡å¤§å°å¤§äº To Spaceå¯ç”¨å†…å­˜ï¼Œåˆ™æŠŠè¯¥å¯¹è±¡è½¬å­˜åˆ°è€å¹´ä»£ï¼Œä¸”è€å¹´ä»£çš„å¯ç”¨å†…å­˜å°äºè¯¥å¯¹è±¡å¤§å°ã€‚</p><p>è¯´æ˜ï¼šfull gc æ˜¯å¼€å‘æˆ–è°ƒä¼˜ä¸­å°½é‡è¦é¿å…çš„ã€‚è¿™æ ·æš‚æ—¶æ—¶é—´ä¼šçŸ­ä¸€äº›ã€‚</p><h3 id="å¯¹è±¡åˆ†é…è¿‡ç¨‹-tlab" tabindex="-1"><a class="header-anchor" href="#å¯¹è±¡åˆ†é…è¿‡ç¨‹-tlab" aria-hidden="true">#</a> å¯¹è±¡åˆ†é…è¿‡ç¨‹ï¼šTLAB</h3><p><strong>TLABï¼ˆThread Local Allocation Bufferï¼‰</strong></p><p>ä¸ºä»€ä¹ˆä¼šæœ‰ TLABï¼Ÿ</p><ul><li>å †åŒºæ˜¯çº¿ç¨‹å…±äº«åŒºåŸŸï¼Œä»»ä½•çº¿ç¨‹éƒ½å¯ä»¥è®¿é—®åˆ°å †åŒºä¸­çš„å…±äº«æ•°æ®</li><li>ç”±äºå¯¹è±¡å®ä¾‹çš„åˆ›å»ºåœ¨JVMä¸­éå¸¸é¢‘ç¹ï¼Œå› æ­¤åœ¨å¹¶å‘ç¯å¢ƒä¸‹ä»å †åŒºä¸­åˆ’åˆ†å†…å­˜ç©ºé—´æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„</li><li>ä¸ºé¿å…å¤šä¸ªçº¿ç¨‹æ“ä½œåŒä¸€åœ°å€ï¼Œéœ€è¦ä½¿ç”¨åŠ é”ç­‰æœºåˆ¶ï¼Œè¿›è€Œå½±å“åˆ†é…é€Ÿåº¦</li></ul><p>jRocket æ²¡æœ‰æ°¸ä¹…ä»£</p><h2 id="åƒåœ¾å›æ”¶æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#åƒåœ¾å›æ”¶æ¦‚è¿°" aria-hidden="true">#</a> åƒåœ¾å›æ”¶æ¦‚è¿°</h2><h3 id="ä»€ä¹ˆæ˜¯åƒåœ¾" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯åƒåœ¾" aria-hidden="true">#</a> ä»€ä¹ˆæ˜¯åƒåœ¾</h3><p>Javaç›¸æ¯”äºC++ï¼Œå¢åŠ äº†å†…å­˜åŠ¨æ€åˆ†é…ä»¥åŠåƒåœ¾å›æ”¶æœºåˆ¶ã€‚</p><p>åƒåœ¾æ”¶é›†ï¼Œä¸æ˜¯Javaè¯­è¨€çš„ä¼´ç”Ÿäº§ç‰©ã€‚æ—©åœ¨1960å¹´ï¼Œç¬¬ä¸€é—¨å¼€å§‹ä½¿ç”¨å†…å­˜åŠ¨æ€åˆ†é…å’Œåƒåœ¾æ”¶é›†æŠ€æœ¯çš„Lispè¯­è¨€è¯ç”Ÿã€‚<br> å…³äºåƒåœ¾æ”¶é›†æœ‰ä¸‰ä¸ªç»å…¸é—®é¢˜ï¼š</p><ul><li>å“ªäº›å†…å­˜éœ€è¦å›æ”¶?</li><li>ä»€ä¹ˆæ—¶å€™å›æ”¶?</li><li>å¦‚ä½•å›æ”¶ï¼Ÿ</li></ul><p>åƒåœ¾æ”¶é›†æœºåˆ¶æ˜¯ Java çš„æ‹›ç‰Œèƒ½åŠ›ï¼Œæå¤§åœ°æé«˜äº†å¼€å‘æ•ˆç‡ã€‚å¦‚ä»Šï¼Œåƒåœ¾æ”¶é›†å‡ ä¹æˆä¸ºç°ä»£è¯­è¨€çš„æ ‡é…ï¼Œå³ä½¿ç»è¿‡å¦‚æ­¤é•¿æ—¶é—´çš„å‘å±•ï¼ŒJavaçš„åƒåœ¾æ”¶é›†æœºåˆ¶ä»ç„¶åœ¨ä¸æ–­çš„æ¼”è¿›ä¸­ï¼Œä¸åŒå¤§å°çš„è®¾å¤‡ã€ä¸åŒç‰¹å¾çš„åº”ç”¨åœºæ™¯ï¼Œå¯¹åƒåœ¾æ”¶é›†æå‡ºäº†æ–°çš„æŒ‘æˆ˜ã€‚</p><p>ä»€ä¹ˆæ˜¯åƒåœ¾ï¼ˆGarbageï¼‰ï¼Ÿ</p><blockquote><p>åƒåœ¾æ˜¯æŒ‡åœ¨è¿è¡Œç¨‹åºä¸­æ²¡æœ‰ä»»ä½•æŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯éœ€è¦è¢«å›æ”¶çš„åƒåœ¾ã€‚<br> å¤–æ–‡:An object is considered garbage when it can no longer be reached from any pointer in the runningprogram.<br> å¦‚æœä¸åŠæ—¶å¯¹å†…å­˜ä¸­çš„åƒåœ¾è¿›è¡Œæ¸…ç†ï¼Œé‚£ä¹ˆï¼Œè¿™äº›åƒåœ¾å¯¹è±¡æ‰€å çš„å†…å­˜ç©ºé—´ä¼šä¸€ç›´ä¿ç•™åˆ°åº”ç”¨ç¨‹åºç»“æŸï¼Œè¢«ä¿ç•™çš„ç©ºé—´æ— æ³•è¢«å…¶ä»–å¯¹è±¡ä½¿ç”¨ã€‚ç”šè‡³å¯èƒ½å¯¼è‡´å†…å­˜æº¢å‡ºã€‚</p></blockquote><h3 id="ä¸ºä»€ä¹ˆéœ€è¦gc" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦gc" aria-hidden="true">#</a> ä¸ºä»€ä¹ˆéœ€è¦GC</h3><ul><li>å¯¹äºé«˜çº§è¯­è¨€æ¥è¯´ï¼Œä¸€ä¸ªåŸºæœ¬è®¤çŸ¥æ˜¯å¦‚æœä¸è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œ<mark>å†…å­˜è¿Ÿæ—©éƒ½ä¼šè¢«æ¶ˆè€—å®Œã€‚</mark></li><li>é™¤äº†é‡Šæ”¾æ²¡ç”¨çš„å¯¹è±¡ï¼Œåƒåœ¾å›æ”¶ä¹Ÿå¯ä»¥æ¸…é™¤å†…å­˜é‡Œçš„è®°å½•ç¢ç‰‡ã€‚ç¢ç‰‡æ•´ç†å°†æ‰€å ç”¨çš„å †å†…å­˜ç§»åˆ°å †çš„ä¸€ç«¯ï¼Œä»¥ä¾¿ <mark>JVM å°†æ•´ç†å‡ºçš„å†…å­˜åˆ†é…ç»™æ–°çš„å¯¹è±¡ã€‚</mark></li><li>éšç€åº”ç”¨ç¨‹åºæ‰€åº”ä»˜çš„ä¸šåŠ¡è¶Šæ¥è¶Šåºå¤§ã€å¤æ‚ï¼Œç”¨æˆ·è¶Šæ¥è¶Šå¤šï¼Œ==æ²¡æœ‰ GC å°±ä¸èƒ½ä¿è¯åº”ç”¨ç¨‹åºçš„æ­£å¸¸è¿›è¡Œã€‚==è€Œç»å¸¸é€ æˆSTW çš„ GC åˆè·Ÿä¸ä¸Šå®é™…çš„éœ€æ±‚ï¼Œæ‰€ä»¥æ‰ä¼šä¸æ–­åœ°å°è¯•å¯¹ GC è¿›è¡Œä¼˜åŒ–ã€‚</li></ul><h3 id="æ—©æœŸåƒåœ¾å›æ”¶" tabindex="-1"><a class="header-anchor" href="#æ—©æœŸåƒåœ¾å›æ”¶" aria-hidden="true">#</a> æ—©æœŸåƒåœ¾å›æ”¶</h3><ul><li>åœ¨æ—©æœŸçš„C/C++æ—¶ä»£ï¼Œåƒåœ¾å›æ”¶åŸºæœ¬ä¸Šæ˜¯æ‰‹å·¥è¿›è¡Œçš„ã€‚å¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨ new å…³é”®å­—è¿›è¡Œå†…å­˜ç”³è¯·ï¼Œå¹¶ä½¿ç”¨ delete å…³é”®å­—è¿›è¡Œå†…å­˜é‡Šæ”¾ã€‚æ¯”å¦‚ä»¥ä¸‹ä»£ç ï¼š</li></ul><div class="language-C++ line-numbers-mode" data-ext="C++"><pre class="language-C++"><code>MibBridge *pBridge = new cmBaseGroupBridge ();
//å¦‚æœæ³¨å†Œå¤±è´¥ï¼Œä½¿ç”¨Deleteé‡Šæ”¾è¯¥å¯¹è±¡æ‰€å å†…å­˜åŒºåŸŸ
if(pBridge-&gt;Register (kDestroy) != NO_ ERROR)
delete pBridge;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™ç§æ–¹å¼å¯ä»¥çµæ´»æ§åˆ¶å†…å­˜é‡Šæ”¾çš„æ—¶é—´ï¼Œä½†æ˜¯ä¼šç»™å¼€å‘äººå‘˜å¸¦æ¥é¢‘ç¹ç”³è¯·å’Œé‡Šæ”¾å†…å­˜çš„ç®¡ç†è´Ÿæ‹…ã€‚å€˜è‹¥æœ‰ä¸€å¤„å†…å­˜åŒºé—´ç”±äºç¨‹åºå‘˜ç¼–ç çš„é—®é¢˜å¿˜è®°è¢«å›æ”¶ï¼Œé‚£ä¹ˆå°±ä¼šäº§ç”Ÿ<mark>å†…å­˜æ³„æ¼</mark>ï¼Œåƒåœ¾å¯¹è±¡æ°¸è¿œæ— æ³•è¢«æ¸…é™¤ï¼Œéšç€ç³»ç»Ÿè¿è¡Œæ—¶é—´çš„ä¸æ–­å¢é•¿ï¼Œåƒåœ¾å¯¹è±¡æ‰€è€—å†…å­˜å¯èƒ½æŒç»­ä¸Šå‡ï¼Œç›´åˆ°å‡ºç°å†…å­˜æº¢å‡ºå¹¶é€ æˆåº”ç”¨ç¨‹åºå´©æºƒã€‚</li></ul><p>åœ¨æœ‰äº†åƒåœ¾å›æ”¶æœºåˆ¶åï¼Œä¸Šè¿°ä»£ç å—ææœ‰å¯èƒ½å˜æˆè¿™æ ·ï¼š</p><div class="language-C++ line-numbers-mode" data-ext="C++"><pre class="language-C++"><code>MibBridge *pBridge = new cmBaseGroupBridge ();
pBridge-&gt;Register (kDestroy);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ç°åœ¨ï¼Œé™¤äº†Javaä»¥å¤–ï¼ŒC#ã€Pythonã€Rubyç­‰è¯­è¨€éƒ½ä½¿ç”¨äº†è‡ªåŠ¨åƒåœ¾å›æ”¶çš„æ€æƒ³ï¼Œä¹Ÿæ˜¯æœªæ¥å‘å±•è¶‹åŠ¿ã€‚å¯ä»¥è¯´ï¼Œè¿™ç§è‡ªåŠ¨åŒ–çš„å†…å­˜åˆ†é…å’Œåƒåœ¾å›æ”¶çš„æ–¹å¼å·±ç»æˆä¸ºç°ä»£å¼€å‘è¯­è¨€å¿…å¤‡çš„æ ‡å‡†ã€‚</li></ul><h3 id="java-è‡ªåŠ¨å†…å­˜ç®¡ç†ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#java-è‡ªåŠ¨å†…å­˜ç®¡ç†ä»‹ç»" aria-hidden="true">#</a> Java è‡ªåŠ¨å†…å­˜ç®¡ç†ä»‹ç»</h3><p>ä¼˜ç‚¹ï¼š</p><ul><li>è‡ªåŠ¨å†…å­˜ç®¡ç†ï¼Œæ— éœ€å¼€å‘äººå‘˜æ‰‹åŠ¨å‚ä¸å†…å­˜çš„åˆ†é…ä¸å›æ”¶ï¼Œè¿™æ ·é™ä½å†…å­˜æ³„æ¼å’Œå†…å­˜æº¢å‡ºçš„é£é™©ã€‚</li><li>æ²¡æœ‰åƒåœ¾å›æ”¶å™¨ï¼Œjavaä¹Ÿä¼šå’Œcppä¸€æ ·ï¼Œå„ç§æ‚¬å‚æŒ‡é’ˆï¼Œé‡æŒ‡é’ˆï¼Œæ³„éœ²é—®é¢˜ã€‚</li><li>è‡ªåŠ¨å†…å­˜ç®¡ç†æœºåˆ¶ï¼Œå°†ç¨‹åºå‘˜ä»ç¹é‡çš„å†…å­˜ç®¡ç†ä¸­é‡Šæ”¾å‡ºæ¥ï¼Œå¯ä»¥æ›´ä¸“å¿ƒåœ°ä¸“æ³¨äºä¸šåŠ¡å¼€å‘</li><li>oracleå®˜ç½‘å…³äºåƒåœ¾å›æ”¶çš„ä»‹ç»ï¼š<a href="https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/toc.html" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/toc.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>å¯¹äºJavaå¼€å‘äººå‘˜è€Œè¨€ï¼Œè‡ªåŠ¨å†…å­˜ç®¡ç†å°±åƒæ˜¯ä¸€ä¸ªé»‘åŒ£å­ï¼Œå¦‚æœè¿‡åº¦ä¾èµ–äºâ€œè‡ªåŠ¨â€ï¼Œé‚£ä¹ˆè¿™å°†ä¼šæ˜¯ä¸€åœºç¾éš¾ï¼Œæœ€ä¸¥é‡çš„å°±ä¼šå¼±åŒ–Javaå¼€å‘äººå‘˜åœ¨ç¨‹åºå‡ºç°å†…å­˜æº¢å‡ºæ—¶å®šä½é—®é¢˜å’Œè§£å†³é—®é¢˜çš„èƒ½åŠ›ã€‚</li><li>æ­¤æ—¶ï¼Œäº†è§£ JVM çš„è‡ªåŠ¨å†…å­˜åˆ†é…å’Œå†…å­˜å›æ”¶åŸç†å°±æ˜¾å¾—éå¸¸é‡è¦ï¼Œåªæœ‰åœ¨çœŸæ­£äº†è§£ JVM æ˜¯å¦‚ä½•ç®¡ç†å†…å­˜åï¼Œæˆ‘ä»¬æ‰èƒ½å¤Ÿåœ¨é‡è§ outofMemoryErroræ—¶ï¼Œå¿«é€Ÿåœ°æ ¹æ®é”™è¯¯å¼‚å¸¸æ—¥å¿—å®šä½é—®é¢˜å’Œè§£å†³é—®é¢˜ã€‚</li><li>å½“éœ€è¦æ’æŸ¥å„ç§å†…å­˜æº¢å‡ºã€å†…å­˜æ³„æ¼é—®é¢˜æ—¶ï¼Œå½“åƒåœ¾æ”¶é›†æˆä¸ºç³»ç»Ÿè¾¾åˆ°æ›´é«˜å¹¶å‘é‡çš„ç“¶é¢ˆæ—¶ï¼Œæˆ‘ä»¬å°±å¿…é¡»å¯¹è¿™äº›â€œè‡ªåŠ¨åŒ–â€çš„æŠ€æœ¯å®æ–½å¿…è¦çš„ç›‘æ§å’Œè°ƒèŠ‚ã€‚</li></ul><h2 id="åƒåœ¾å›æ”¶ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#åƒåœ¾å›æ”¶ç®—æ³•" aria-hidden="true">#</a> åƒåœ¾å›æ”¶ç®—æ³•</h2><h3 id="æ ‡è®°é˜¶æ®µ-å¼•ç”¨è®¡æ•°ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#æ ‡è®°é˜¶æ®µ-å¼•ç”¨è®¡æ•°ç®—æ³•" aria-hidden="true">#</a> æ ‡è®°é˜¶æ®µï¼šå¼•ç”¨è®¡æ•°ç®—æ³•</h3><h4 id="å¯¹è±¡å­˜æ´»åˆ¤æ–­" tabindex="-1"><a class="header-anchor" href="#å¯¹è±¡å­˜æ´»åˆ¤æ–­" aria-hidden="true">#</a> å¯¹è±¡å­˜æ´»åˆ¤æ–­</h4><p>åœ¨å †é‡Œå­˜æ”¾ç€å‡ ä¹æ‰€æœ‰çš„ Java å¯¹è±¡å®ä¾‹ï¼Œåœ¨ GC æ‰§è¡Œåƒåœ¾å›æ”¶ä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦åŒºåˆ†å‡ºå†…å­˜ä¸­å“ªäº›æ˜¯å­˜æ´»å¯¹è±¡ï¼Œå“ªäº›æ˜¯å·²ç»æ­»äº¡çš„å¯¹è±¡ã€‚åªæœ‰è¢«æ ‡è®°ä¸ºå·±ç»æ­»äº¡çš„å¯¹è±¡ï¼ŒGC æ‰ä¼šåœ¨æ‰§è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œé‡Šæ”¾æ‰å…¶æ‰€å ç”¨çš„å†…å­˜ç©ºé—´ï¼Œå› æ­¤è¿™ä¸ªè¿‡ç¨‹æˆ‘ä»¬å¯ä»¥ç§°ä¸ºåƒåœ¾æ ‡è®°é˜¶æ®µã€‚<br> é‚£ä¹ˆåœ¨ JVM ä¸­ç©¶ç«Ÿæ˜¯å¦‚ä½•æ ‡è®°ä¸€ä¸ªæ­»äº¡å¯¹è±¡å‘¢ï¼Ÿ<mark>ç®€å•æ¥è¯´ï¼Œå½“ä¸€ä¸ªå¯¹è±¡å·²ç»ä¸å†è¢«ä»»ä½•çš„å­˜æ´»å¯¹è±¡ç»§ç»­å¼•ç”¨æ—¶ï¼Œå°±å¯ä»¥å®£åˆ¤ä¸ºå·²ç»æ­»äº¡ã€‚</mark><br> åˆ¤æ–­å¯¹è±¡å­˜æ´»ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ï¼š<strong>å¼•ç”¨è®¡æ•°ç®—æ³•å’Œå¯è¾¾æ€§åˆ†æç®—æ³•ã€‚</strong></p><h4 id="å¼•ç”¨è®¡æ•°ç®—æ³•çš„åŸç†ä¸ä¼˜ç¼ºç‚¹" tabindex="-1"><a class="header-anchor" href="#å¼•ç”¨è®¡æ•°ç®—æ³•çš„åŸç†ä¸ä¼˜ç¼ºç‚¹" aria-hidden="true">#</a> å¼•ç”¨è®¡æ•°ç®—æ³•çš„åŸç†ä¸ä¼˜ç¼ºç‚¹</h4><p>å¼•ç”¨è®¡æ•°ç®—æ³•ï¼ˆReference Countingï¼‰æ¯”è¾ƒç®€å•ï¼Œå¯¹æ¯ä¸ªå¯¹è±¡ä¿å­˜ä¸€ä¸ªæ•´å‹çš„å¼•ç”¨è®¡æ•°å™¨å±æ€§ã€‚ç”¨äºè®°å½•å¯¹è±¡è¢«å¼•ç”¨çš„æƒ…å†µã€‚<br> å¯¹äºä¸€ä¸ªå¯¹è±¡ Aï¼Œåªè¦æœ‰ä»»ä½•ä¸€ä¸ªå¯¹è±¡å¼•ç”¨äº† Aï¼Œåˆ™ A çš„å¼•ç”¨è®¡æ•°å™¨å°±åŠ  1ï¼›å½“å¼•ç”¨å¤±æ•ˆæ—¶ï¼Œå¼•ç”¨è®¡æ•°å™¨å°±å‡ 1ã€‚åªè¦å¯¹è±¡ A çš„å¼•ç”¨è®¡æ•°å™¨çš„å€¼ä¸º 0ï¼Œå³è¡¨ç¤ºå¯¹è±¡ A ä¸å¯èƒ½å†è¢«ä½¿ç”¨ï¼Œå¯è¿›è¡Œå›æ”¶ã€‚<br> ä¼˜ç‚¹ï¼šå®ç°ç®€å•ï¼Œåƒåœ¾å¯¹è±¡ä¾¿äºè¾¨è¯†ï¼›åˆ¤å®šæ•ˆç‡é«˜ï¼Œå›æ”¶æ²¡æœ‰å»¶è¿Ÿæ€§ã€‚<br> ç¼ºç‚¹ï¼š</p><ul><li><p>å®ƒéœ€è¦å•ç‹¬çš„å­—æ®µå­˜å‚¨è®¡æ•°å™¨ï¼Œè¿™æ ·çš„åšæ³•å¢åŠ äº†å­˜å‚¨ç©ºé—´çš„å¼€é”€ã€‚</p></li><li><p>æ¯æ¬¡èµ‹å€¼éƒ½éœ€è¦æ›´æ–°è®¡æ•°å™¨ï¼Œä¼´éšç€åŠ æ³•å’Œå‡æ³•æ“ä½œï¼Œè¿™å¢åŠ äº†æ—¶é—´å¼€é”€ã€‚</p></li><li><p>å¼•ç”¨è®¡æ•°å™¨æœ‰ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå³æ— æ³•å¤„ç†å¾ªç¯å¼•ç”¨çš„æƒ…å†µã€‚è¿™æ˜¯ä¸€æ¡è‡´å‘½ç¼ºé™·ï¼Œå¯¼è‡´åœ¨Javaçš„åƒåœ¾å›æ”¶å™¨ä¸­æ²¡æœ‰ä½¿ç”¨è¿™ç±»ç®—æ³•ã€‚</p><figure><img src="/assets/å¼•ç”¨è®¡æ•°ç®—æ³•-å¾ªç¯å¼•ç”¨é—®é¢˜-2b3dae32.png" alt="å¼•ç”¨è®¡æ•°ç®—æ³•-å¾ªç¯å¼•ç”¨é—®é¢˜.png" tabindex="0" loading="lazy"><figcaption>å¼•ç”¨è®¡æ•°ç®—æ³•-å¾ªç¯å¼•ç”¨é—®é¢˜.png</figcaption></figure></li></ul><p>Java æ²¡æœ‰ä½¿ç”¨å¼•ç”¨è®¡æ•°ç®—æ³•ç¤ºä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
<span class="token doc-comment comment">/**
 * Javaæ²¡æœ‰ä½¿ç”¨å¼•ç”¨è®¡æ•°æ³•çš„éªŒè¯ï¼š
 * ä½¿ç”¨ -XX:+PrintGCDetails
 *
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RefCountGC</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bigSize <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">5</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token class-name">Object</span> reference <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RefCountGC</span> refCountGC01 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RefCountGC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RefCountGC</span> refCountGC02 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RefCountGC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        refCountGC01<span class="token punctuation">.</span>reference <span class="token operator">=</span> refCountGC02<span class="token punctuation">;</span>
        refCountGC02<span class="token punctuation">.</span>reference <span class="token operator">=</span> refCountGC01<span class="token punctuation">;</span>

        refCountGC01 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

        refCountGC02 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token comment">// æ˜¾å¼æ‰§è¡Œåƒåœ¾å›æ”¶è¡Œä¸º</span>
<span class="token comment">//        System.gc();</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ åœ¨ä½¿ç”¨ System.gc(); å’Œä¸ä½¿ç”¨çš„ä¸¤ç§æƒ…å†µä¸‹ï¼Œå†…å­˜å ç”¨çš„ç©ºé—´ä¸åŒï¼Œå› æ­¤æ²¡æœ‰ä½¿ç”¨å¼•ç”¨è®¡æ•°ï¼Œå¦‚æœä½¿ç”¨äº†å¼•ç”¨è®¡æ•°ï¼Œåˆ™å†…å­˜ä¸ä¼šè¢«å›æ”¶ï¼Œå› ä¸º refCountGC01 å’Œ refCountGC02 çš„ reference ç›¸äº’å¼•ç”¨ã€‚</p><p>æ€»ç»“ï¼š</p><blockquote><p>å¼•ç”¨è®¡æ•°ç®—æ³•ï¼Œæ˜¯å¾ˆå¤šè¯­è¨€çš„èµ„æºå›æ”¶é€‰æ‹©ï¼Œä¾‹å¦‚Pythonï¼Œå®ƒæ›´æ˜¯åŒæ—¶æ”¯æŒå¼•ç”¨è®¡æ•°å’Œåƒåœ¾æ”¶é›†æœºåˆ¶ã€‚<br> å…·ä½“å“ªç§æœ€ä¼˜æ˜¯è¦çœ‹åœºæ™¯çš„ï¼Œä¸šç•Œæœ‰å¤§è§„æ¨¡å®è·µä¸­ä»…ä¿ç•™å¼•ç”¨è®¡æ•°æœºåˆ¶ï¼Œä»¥æé«˜ååé‡çš„å°è¯•ã€‚<br> Javaå¹¶æ²¡æœ‰é€‰æ‹©å¼•ç”¨è®¡æ•°ï¼Œæ˜¯å› ä¸ºå…¶å­˜åœ¨ä¸€ä¸ªåŸºæœ¬çš„éš¾é¢˜ï¼Œä¹Ÿå°±æ˜¯å¾ˆéš¾å¤„ç†å¾ªç¯å¼•ç”¨å…³ç³»ã€‚<br> Pythonå¦‚ä½•è§£å†³å¾ªç¯å¼•ç”¨?</p><ol><li><p>æ‰‹åŠ¨è§£é™¤ï¼Œåœ¨åˆé€‚çš„æ—¶æœºï¼Œè§£é™¤å¼•ç”¨å…³ç³»ã€‚</p></li><li><p>ä½¿ç”¨å¼±å¼•ç”¨weakrefï¼Œ weakrefæ˜¯Pythonæä¾›çš„æ ‡å‡†åº“ï¼Œæ—¨åœ¨è§£å†³å¾ªç¯å¼•ç”¨ã€‚</p></li></ol></blockquote><h3 id="æ ‡è®°é˜¶æ®µ-å¯è¾¾æ€§åˆ†æç®—æ³•" tabindex="-1"><a class="header-anchor" href="#æ ‡è®°é˜¶æ®µ-å¯è¾¾æ€§åˆ†æç®—æ³•" aria-hidden="true">#</a> æ ‡è®°é˜¶æ®µï¼šå¯è¾¾æ€§åˆ†æç®—æ³•</h3><p>å¯è¾¾æ€§åˆ†æç®—æ³•ä¹Ÿç§°ä¸º æ ¹æœç´¢ç®—æ³•ã€å¯è¿½è¸ªæ€§ç®—æ³•ã€‚</p><p>ç›¸å¯¹äºå¼•ç”¨è®¡æ•°ç®—æ³•è€Œè¨€ï¼Œå¯è¾¾æ€§åˆ†æç®—æ³•ä¸ä»…åŒæ ·å…·å¤‡å®ç°ç®€å•å’Œæ‰§è¡Œé«˜æ•ˆç­‰ç‰¹ç‚¹ï¼Œæ›´é‡è¦çš„æ˜¯è¯¥ç®—æ³•å¯ä»¥æœ‰æ•ˆåœ°è§£å†³åœ¨å¼•ç”¨è®¡æ•°ç®—æ³•ä¸­å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼çš„å‘ç”Ÿã€‚<br> ç›¸è¾ƒäºå¼•ç”¨è®¡æ•°ç®—æ³•ï¼Œè¿™é‡Œçš„å¯è¾¾æ€§åˆ†æå°±æ˜¯Javaã€C#é€‰æ‹©çš„ã€‚è¿™ç§ç±»å‹çš„åƒåœ¾æ”¶é›†é€šå¸¸ä¹Ÿå«ä½œè¿½è¸ªæ€§åƒåœ¾æ”¶é›†ï¼ˆTracing Garbage Collection) ã€‚</p><h4 id="gc-rosts" tabindex="-1"><a class="header-anchor" href="#gc-rosts" aria-hidden="true">#</a> GC ROSTS</h4><p>æ‰€è°“&quot;GC Roots&quot;æ ¹é›†åˆå°±æ˜¯ä¸€ç»„å¿…é¡»æ´»è·ƒçš„å¼•ç”¨ã€‚<br> åŸºæœ¬æ€è·¯:<br> å¯è¾¾æ€§åˆ†æç®—æ³•æ˜¯ä»¥æ ¹å¯¹è±¡é›†åˆ(GC Roots)ä¸ºèµ·å§‹ç‚¹ï¼ŒæŒ‰ç…§ä»ä¸Šè‡³ä¸‹<br> çš„æ–¹å¼æœç´¢è¢«æ ¹å¯¹è±¡é›†åˆæ‰€è¿æ¥çš„ç›®æ ‡å¯¹è±¡æ˜¯å¦å¯è¾¾ã€‚</p><p>ä½¿ç”¨å¯è¾¾æ€§åˆ†æç®—æ³•åï¼Œå†…å­˜ä¸­çš„å­˜æ´»å¯¹è±¡éƒ½ä¼šè¢«æ ¹å¯¹è±¡é›†åˆç›´æ¥æˆ–é—´<br> æ¥è¿æ¥ç€ï¼Œæœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºå¼•ç”¨é“¾(Reference Chain)<br> å¦‚æœç›®æ ‡å¯¹è±¡æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿ï¼Œåˆ™æ˜¯ä¸å¯è¾¾çš„ï¼Œå°±æ„å‘³ç€è¯¥å¯¹è±¡å·±ç»æ­»äº¡ï¼Œå¯ä»¥æ ‡è®°ä¸ºåƒåœ¾å¯¹è±¡ã€‚<br> åœ¨å¯è¾¾æ€§åˆ†æç®—æ³•ä¸­ï¼Œåªæœ‰èƒ½å¤Ÿè¢«æ ¹å¯¹è±¡é›†åˆç›´æ¥æˆ–è€…é—´æ¥è¿æ¥çš„å¯¹è±¡æ‰æ˜¯å­˜æ´»å¯¹è±¡ã€‚</p><p>åœ¨Javaè¯­è¨€ä¸­ï¼ŒG RootsåŒ…æ‹¬ä»¥ä¸‹å‡ ç±»å…ƒç´ :Â·è™šæ‹Ÿæœºæ ˆä¸­å¼•ç”¨çš„å¯¹è±¡</p><blockquote><p>æ¯”å¦‚:å„ä¸ªçº¿ç¨‹è¢«è°ƒç”¨çš„æ–¹æ³•ä¸­ä½¿ç”¨åˆ°çš„å‚æ•°ã€å±€éƒ¨å˜é‡ç­‰ã€‚æœ¬åœ°æ–¹æ³•æ ˆå†…JNI(é€šå¸¸è¯´çš„æœ¬åœ°æ–¹æ³•)å¼•ç”¨çš„å¯¹è±¡<br> Â·æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡<br> æ¯”å¦‚: Javaç±»çš„å¼•ç”¨ç±»å‹é™æ€å˜é‡.æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡<br> æ¯”å¦‚:å­—ç¬¦ä¸²å¸¸é‡æ± (Sstring Tableï¼‰é‡Œçš„å¼•ç”¨æ‰€æœ‰è¢«åŒæ­¥é”synchronizedæŒæœ‰çš„å¯¹è±¡<br> Javaè™šæ‹Ÿæœºå†…éƒ¨çš„å¼•ç”¨ã€‚<br> åŸºæœ¬æ•°æ®ç±»å‹å¯¹åº”çš„Classå¯¹è±¡ï¼Œä¸€äº›å¸¸é©»çš„å¼‚å¸¸å¯¹è±¡ï¼ˆå¦‚:<br> NullPointerExceptionã€OutOfMemoryErrorï¼‰ï¼Œç³»ç»Ÿç±»åŠ è½½å™¨ã€‚<br> Â·åæ˜ iavaè™šæ‹Ÿæœºå†…éƒ¨æƒ…å†µçš„JMXBeanã€JVMTIä¸­æ³¨å†Œçš„å›è°ƒã€æœ¬åœ°ä»£ç ç¼“å­˜ç­‰ã€‚</p></blockquote><p>é™¤äº†è¿™äº›å›ºå®šçš„GC Rootsé›†åˆä»¥å¤–ï¼Œæ ¹æ®ç”¨æˆ·æ‰€é€‰ç”¨çš„åƒåœ¾æ”¶é›†å™¨ä»¥åŠå½“å‰å›æ”¶çš„å†…å­˜åŒºåŸŸä¸åŒï¼Œè¿˜å¯ä»¥æœ‰å…¶ä»–å¯¹è±¡â€œä¸´æ—¶æ€§â€åœ°åŠ å…¥ï¼Œå…±åŒæ„æˆå®Œæ•´GC Rootsé›†åˆã€‚æ¯”å¦‚ï¼šåˆ†ä»£æ”¶é›†å’Œå±€éƒ¨å›æ”¶(Partial GCï¼‰ã€‚</p><blockquote><p>å¦‚æœåªé’ˆå¯¹Javaå †ä¸­çš„æŸä¸€å—åŒºåŸŸè¿›è¡Œåƒåœ¾å›æ”¶ï¼ˆæ¯”å¦‚:å…¸å‹çš„åªé’ˆ<br> å¯¹æ–°ç”Ÿä»£ï¼‰ï¼Œå¿…é¡»è€ƒè™‘åˆ°å†…å­˜åŒºåŸŸæ˜¯è™šæ‹Ÿæœºè‡ªå·±çš„å®ç°ç»†èŠ‚ï¼Œæ›´ä¸æ˜¯å­¤ç«‹å°é—­çš„ï¼Œè¿™ä¸ªåŒºåŸŸçš„å¯¹è±¡å®Œå…¨æœ‰å¯èƒ½è¢«å…¶ä»–åŒºåŸŸçš„å¯¹è±¡æ‰€å¼•ç”¨ï¼Œè¿™æ—¶å€™å°±éœ€è¦ä¸€å¹¶å°†å…³è”çš„åŒºåŸŸå¯¹è±¡ä¹ŸåŠ å…¥GC Rootsé›†åˆä¸­å»è€ƒè™‘ï¼Œæ‰èƒ½ä¿è¯å¯è¾¾æ€§åˆ†æçš„å‡†ç¡®æ€§ã€‚<br> .å°æŠ€å·§ï¼š<br> ç”±äºRooté‡‡ç”¨æ ˆæ–¹å¼å­˜æ”¾å˜é‡å’ŒæŒ‡é’ˆï¼Œæ‰€ä»¥å¦‚æœä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒä¿å­˜äº†å †å†…å­˜é‡Œé¢çš„å¯¹è±¡ï¼Œä½†æ˜¯è‡ªå·±åˆä¸å­˜æ”¾åœ¨å †å†…å­˜é‡Œé¢ï¼Œé‚£å®ƒå°±æ˜¯ä¸€ä¸ªRoot ã€‚</p></blockquote><p>å¦‚æœè¦ä½¿åºœå¯è¾¾æ€§åˆ†æç®—æ³•æ¥åˆ¤æ–­å†…å­˜æ˜¯å¦å¯å›æ”¶ï¼Œé‚£ä¹ˆåˆ†æå·¥ä½œå¿…é¡»åœ¨ä¸€ä¸ªèƒ½ä¿éšœä¸€è‡´æ€§çš„å¿«ç…§ä¸­è¿›è¡Œã€‚è¿™ç‚¹ä¸æ»¡è¶³çš„è¯åˆ†æç»“æœçš„å‡†ç¡®æ€§å°±æ— æ³•ä¿è¯ã€‚<br> è¿™ç‚¹ä¹Ÿæ˜¯å¯¼è‡´Gcè¿›è¡Œæ—¶å¿…é¡» &quot;Stop The world&quot; çš„ä¸€ä¸ªé‡è¦åŸå› ã€‚&gt;å³ä½¿æ˜¯å·ç§°ï¼ˆå‡ ä¹ï¼‰ä¸ä¼šå‘ç”Ÿåœé¡¿çš„CMs æ”¶é›†å™¨ä¸­ï¼Œæšä¸¾æ ¹èŠ‚ç‚¹æ—¶ä¹Ÿæ˜¯å¿…é¡»è¦åœé¡¿çš„ã€‚</p><h3 id="å¯¹è±¡çš„-finalization-æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#å¯¹è±¡çš„-finalization-æœºåˆ¶" aria-hidden="true">#</a> å¯¹è±¡çš„ finalization æœºåˆ¶</h3><ul><li>Javaè¯­è¨€æä¾›äº†å¯¹è±¡ç»ˆæ­¢ï¼ˆfinalizationï¼‰æœºåˆ¶æ¥å…è®¸å¼€å‘äººå‘˜æä¾›å¯¹è±¡è¢«é”€æ¯ä¹‹å‰çš„è‡ªå®šä¹‰å¤„ç†é€»è¾‘ã€‚</li><li>å½“åƒåœ¾å›æ”¶å™¨å‘ç°æ²¡æœ‰å¼•ç”¨æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œå³ï¼šåƒåœ¾å›æ”¶æ­¤å¯¹è±¡ä¹‹å‰ï¼Œæ€»ä¼šå…ˆè°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„ finalize() æ–¹æ³•ã€‚</li><li>finalize () æ–¹æ³•å…è®¸åœ¨å­ç±»ä¸­è¢«é‡å†™ï¼Œç”¨äºåœ¨å¯¹è±¡è¢«å›æ”¶æ—¶è¿›è¡Œèµ„æºé‡Šæ”¾ã€‚<mark>é€šå¸¸åœ¨è¿™ä¸ªæ–¹æ³•ä¸­è¿›è¡Œä¸€äº›èµ„æºé‡Šæ”¾å’Œæ¸…ç†çš„å·¥ä½œï¼Œæ¯”å¦‚å…³é—­æ–‡ä»¶ã€å¥—æ¥å­—å’Œæ•°æ®åº“è¿æ¥ç­‰ã€‚</mark></li></ul><p><strong>æ³¨æ„äº‹é¡¹ï¼š</strong></p><ol><li>æ°¸è¿œä¸è¦ä¸»åŠ¨è°ƒç”¨æŸä¸ªå¯¹è±¡çš„finalize()æ–¹æ³•ï¼Œåº”è¯¥äº¤ç»™åƒåœ¾å›æ”¶æœºåˆ¶è°ƒç”¨ã€‚ç†ç”±åŒ…æ‹¬ä¸‹é¢ä¸‰ç‚¹ï¼š <ul><li>åœ¨finalize ()æ—¶å¯èƒ½ä¼šå¯¼è‡´å¯¹è±¡å¤æ´»ã€‚</li><li>finalize ()æ–¹æ³•çš„æ‰§è¡Œæ—¶é—´æ˜¯æ²¡æœ‰ä¿éšœçš„ï¼Œå®ƒå®Œå…¨ç”±Gcçº¿ç¨‹å†³å®šï¼Œæç«¯æƒ…å†µä¸‹ï¼Œè‹¥ä¸å‘ç”ŸGCï¼Œåˆ™ finalize () æ–¹æ³•å°†æ²¡æœ‰æ‰§è¡Œæœºä¼šã€‚</li><li>ä¸€ä¸ªç³Ÿç³•çš„ finalize () ä¼šä¸¥é‡å½±å“ GC çš„æ€§èƒ½ã€‚</li></ul></li><li>ä»åŠŸèƒ½ä¸Šæ¥è¯´ï¼Œfinalize ()æ–¹æ³•ä¸ C++ ä¸­çš„ææ„å‡½æ•°æ¯”è¾ƒç›¸ä¼¼ï¼Œä½†æ˜¯ Javaé‡‡ç”¨çš„æ˜¯åŸºäºåƒåœ¾å›æ”¶å™¨çš„è‡ªåŠ¨å†…å­˜ç®¡ç†æœºåˆ¶ï¼Œæ‰€ä»¥ finalize ()æ–¹æ³•åœ¨æœ¬è´¨ä¸Šä¸åŒäº C++ä¸­çš„ææ„å‡½æ•°ã€‚</li><li>ç”±äºfinalize ()æ–¹æ³•çš„å­˜åœ¨ï¼Œè™šæ‹Ÿæœºä¸­çš„å¯¹è±¡ä¸€èˆ¬å¤„äºä¸‰ç§å¯èƒ½çš„çŠ¶æ€ã€‚</li></ol><p>ä¸‰ç§çŠ¶æ€ï¼š</p><p>å¦‚æœä»æ‰€æœ‰çš„æ ¹èŠ‚ç‚¹éƒ½æ— æ³•è®¿é—®åˆ°æŸä¸ªå¯¹è±¡ï¼Œè¯´æ˜å¯¹è±¡å·±ç»ä¸å†ä½¿ç”¨äº†ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ­¤å¯¹è±¡éœ€è¦è¢«å›æ”¶ã€‚ä½†äº‹å®ä¸Šï¼Œä¹Ÿå¹¶éæ˜¯â€œéæ­»ä¸å¯â€çš„ï¼Œè¿™æ—¶å€™å®ƒä»¬æš‚æ—¶å¤„äºâ€œç¼“åˆ‘â€é˜¶æ®µã€‚ä¸€ä¸ªæ— æ³•è§¦åŠçš„å¯¹è±¡æœ‰å¯èƒ½åœ¨æŸä¸€ä¸ªæ¡ä»¶ä¸‹â€œå¤æ´»â€è‡ªå·±ï¼Œå¦‚æœè¿™æ ·ï¼Œé‚£ä¹ˆå¯¹å®ƒçš„å›æ”¶å°±æ˜¯ä¸åˆç†çš„ï¼Œä¸ºæ­¤ï¼Œå®šä¹‰è™šæ‹Ÿæœºä¸­çš„å¯¹è±¡å¯èƒ½çš„ä¸‰ç§çŠ¶æ€å¦‚ä¸‹:</p><ul><li><p>å¯è§¦åŠçš„ï¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œå¯ä»¥åˆ°è¾¾è¿™ä¸ªå¯¹è±¡ã€‚</p></li><li><p>å¯å¤æ´»çš„ï¼šå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«é‡Šæ”¾ï¼Œä½†æ˜¯å¯¹è±¡æœ‰å¯èƒ½åœ¨ finalize() ä¸­å¤æ´»ã€‚</p></li><li><p>ä¸å¯è§¦åŠçš„ï¼šå¯¹è±¡çš„finalize () è¢«è°ƒç”¨ï¼Œå¹¶ä¸”æ²¡æœ‰å¤æ´»ï¼Œé‚£ä¹ˆå°±ä¼šè¿›å…¥ä¸å¯è§¦åŠçŠ¶æ€ã€‚ä¸å¯è§¦åŠçš„å¯¹è±¡ä¸å¯èƒ½è¢«å¤æ´»ï¼Œå› ä¸º finalize() åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ã€‚</p><p>ä»¥ä¸Š3ç§çŠ¶æ€ä¸­ï¼Œæ˜¯ç”±äºfinalize ()æ–¹æ³•çš„å­˜åœ¨ï¼Œè¿›è¡Œçš„åŒºåˆ†ã€‚åªæœ‰åœ¨å¯¹è±¡ä¸å¯è§¦åŠæ—¶æ‰å¯ä»¥è¢«å›æ”¶ã€‚</p></li></ul><p>å…·ä½“è¿‡ç¨‹ï¼š</p><p>åˆ¤å®šä¸€ä¸ªå¯¹è±¡objAæ˜¯å¦å¯å›æ”¶ï¼Œè‡³å°‘è¦ç»å†ä¸¤æ¬¡æ ‡è®°è¿‡ç¨‹:ï¼Œ<br> 1.å¦‚æœå¯¹è±¡objAåˆ°GC Rootsæ²¡æœ‰å¼•ç”¨é“¾ï¼Œåˆ™è¿›è¡Œç¬¬Tæ¬¡æ ‡è®°ã€‚<br> 2.è¿›è¡Œç­›é€‰ï¼Œåˆ¤æ–­æ­¤å¯¹è±¡æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•<br> â‘ å¦‚æœå¯¹è±¡objAæ²¡æœ‰é‡ å†™finalize()æ–¹æ³•ï¼Œæˆ–è€…finalize ()æ–¹æ³•å·²ç»è¢«è™šæ‹Ÿæœºè°ƒç”¨è¿‡ï¼Œ<br> åˆ™è™šæ‹Ÿæœºè§†ä¸ºâ€œæ²¡æœ‰å¿…è¦æ‰§è¡Œâ€ï¼Œobj Aè¢«åˆ¤å®šä¸ºä¸å¯è§¦åŠçš„ã€‚<br> â‘¡å¦‚æœå¯¹è±¡objAé‡å†™äº† finalize()æ–¹æ³•ï¼Œä¸”è¿˜æœªæ‰§è¡Œè¿‡ï¼Œé‚£ä¹ˆobjAä¼šè¢«æ’å…¥åˆ°F- Queue<br> é˜Ÿåˆ—ä¸­ï¼Œç”±ä¸€ä¸ªè™šæ‹Ÿæœºè‡ªåŠ¨åˆ›å»ºçš„ã€ä½ä¼˜å…ˆçº§çš„F inalizerçº¿ç¨‹è§¦å‘å…¶finalize ()æ–¹<br> æ³•æ‰§è¡Œã€‚<br> â‘¢finalize() æ–¹æ³•æ˜¯å¯¹è±¡é€ƒè„±æ­»äº¡çš„æœ€åæœºä¼šï¼Œç¨åGcä¼šå¯¹F-Queueé˜Ÿåˆ—ä¸­çš„å¯¹è±¡è¿›è¡Œ<br> ç¬¬äºŒæ¬¡æ ‡è®°ã€‚å¦‚æœobjAåœ¨finalize()æ–¹æ³•ä¸­ä¸å¼•ç”¨é“¾ä¸Šçš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡å»ºç«‹äº†è”ç³»ï¼Œ<br> é‚£ä¹ˆåœ¨ç¬¬äºŒæ¬¡æ ‡è®°æ—¶ï¼ŒobjAä¼šè¢«ç§»å‡ºâ€œå³å°†å›æ”¶â€é›†åˆã€‚ä¹‹åï¼Œå¯¹è±¡ä¼šå†æ¬¡å‡ºç°æ²¡æœ‰å¼•<br> ç”¨å­˜åœ¨çš„æƒ…å†µã€‚åœ¨è¿™ä¸ªæƒ…å†µä¸‹ï¼Œfinalizeæ–¹æ³•ä¸ä¼šè¢«å†æ¬¡è°ƒç”¨ï¼Œå¯¹è±¡ä¼šç›´æ¥å˜æˆä¸å¯è§¦<br> åŠçš„çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªå¯¹è±¡çš„finalizeæ–¹æ³•åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ã€‚</p><h3 id="mat-ä¸-jprofiler-çš„-gc-rosts-æº¯æº" tabindex="-1"><a class="header-anchor" href="#mat-ä¸-jprofiler-çš„-gc-rosts-æº¯æº" aria-hidden="true">#</a> MAT ä¸ jprofiler çš„ GC ROSTS æº¯æº</h3><h3 id="æ¸…é™¤é˜¶æ®µ-æ ‡è®°-æ¸…é™¤ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#æ¸…é™¤é˜¶æ®µ-æ ‡è®°-æ¸…é™¤ç®—æ³•" aria-hidden="true">#</a> æ¸…é™¤é˜¶æ®µï¼šæ ‡è®°-æ¸…é™¤ç®—æ³•</h3><h3 id="æ¸…é™¤é˜¶æ®µ-å¤åˆ¶ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#æ¸…é™¤é˜¶æ®µ-å¤åˆ¶ç®—æ³•" aria-hidden="true">#</a> æ¸…é™¤é˜¶æ®µï¼šå¤åˆ¶ç®—æ³•</h3><h3 id="æ¸…é™¤é˜¶æ®µ-æ ‡è®°-å‹ç¼©ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#æ¸…é™¤é˜¶æ®µ-æ ‡è®°-å‹ç¼©ç®—æ³•" aria-hidden="true">#</a> æ¸…é™¤é˜¶æ®µï¼šæ ‡è®°-å‹ç¼©ç®—æ³•</h3><h3 id="å°ç»“" tabindex="-1"><a class="header-anchor" href="#å°ç»“" aria-hidden="true">#</a> å°ç»“</h3><h3 id="åˆ†ä»£æ”¶é›†ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#åˆ†ä»£æ”¶é›†ç®—æ³•" aria-hidden="true">#</a> åˆ†ä»£æ”¶é›†ç®—æ³•</h3><h3 id="å¢é‡æ”¶é›†ç®—æ³•ã€åˆ†åŒºç®—æ³•" tabindex="-1"><a class="header-anchor" href="#å¢é‡æ”¶é›†ç®—æ³•ã€åˆ†åŒºç®—æ³•" aria-hidden="true">#</a> å¢é‡æ”¶é›†ç®—æ³•ã€åˆ†åŒºç®—æ³•</h3><h2 id="åƒåœ¾å›æ”¶æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#åƒåœ¾å›æ”¶æ¦‚å¿µ" aria-hidden="true">#</a> åƒåœ¾å›æ”¶æ¦‚å¿µ</h2><h2 id="åƒåœ¾å›æ”¶å™¨" tabindex="-1"><a class="header-anchor" href="#åƒåœ¾å›æ”¶å™¨" aria-hidden="true">#</a> åƒåœ¾å›æ”¶å™¨</h2></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/src/Java/JVM.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page on GitHub" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><!----><!----></div></footer><nav class="vp-page-nav"><a class="vp-link nav-link prev" href="/Java/Netty.html"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->Netty</div></a><a class="vp-link nav-link next" href="/Java/JavaWeb.html"><div class="hint">Next<span class="arrow end"></span></div><div class="link">JavaWeb<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><!----><div class="vp-copyright">Copyright Â© 2023 MineTing</div></footer></div><!--]--><!--]--></div>
    <script type="module" src="/assets/app-ae2ce5af.js" defer></script>
  </body>
</html>
